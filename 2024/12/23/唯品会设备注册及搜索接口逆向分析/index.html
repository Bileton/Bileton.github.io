<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/wxlog.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/wxlog.jpg">
  <link rel="mask-icon" href="/images/wxlog.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="App信息包名：com.achievo.vipshop  设备注册抓包找到有关设备注册的接口  测试一下 123456789101112131415161718192021222324252627282930313233import requestsheaders &#x3D; &#123;    &quot;User-Agent&quot;:&quot;okhttp&#x2F;4.9.1&quot;,    &amp;qu">
<meta property="og:type" content="article">
<meta property="og:title" content="唯品会设备注册及搜索接口逆向分析">
<meta property="og:url" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="白乐天">
<meta property="og:description" content="App信息包名：com.achievo.vipshop  设备注册抓包找到有关设备注册的接口  测试一下 123456789101112131415161718192021222324252627282930313233import requestsheaders &#x3D; &#123;    &quot;User-Agent&quot;:&quot;okhttp&#x2F;4.9.1&quot;,    &amp;qu">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/appdata.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/device_reg.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/device_token.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/of.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/l.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/a.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getMid.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/vipmidmanager.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/19.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/image-20241217095807281.png">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/Snipaste_2024-12-17_10-06-59.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getapisign.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/apisign.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getMapParamsSign.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getSignHash.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/gs.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/instance.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/exports.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/functions_gs.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/tttt.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/22.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/23.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/20.jpg">
<meta property="og:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/21.jpg">
<meta property="article:published_time" content="2024-12-22T16:00:00.000Z">
<meta property="article:modified_time" content="2025-01-06T07:19:31.260Z">
<meta property="article:author" content="Bileton">
<meta property="article:tag" content="唯品会">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/appdata.jpg">

<link rel="canonical" href="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>唯品会设备注册及搜索接口逆向分析 | 白乐天</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">白乐天</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">道阻且长，行则将至。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">66</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">29</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">72</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          唯品会设备注册及搜索接口逆向分析
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-23 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-23T00:00:00+08:00">2024-12-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-06 15:19:31" itemprop="dateModified" datetime="2025-01-06T15:19:31+08:00">2025-01-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>46k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>42 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.achievo.vipshop</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/appdata.jpg"></p>
<h1 id="设备注册"><a href="#设备注册" class="headerlink" title="设备注册"></a>设备注册</h1><p>抓包找到有关设备注册的接口</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/device_reg.jpg" alt="device_reg"></p>
<p>测试一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;okhttp/4.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;authorization&quot;</span>:<span class="string">&quot;OAuth api_sign=fee2a0810c0b9637b6aa0f64b2d91f172dc4e397&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>:<span class="string">&quot;achievo_ad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>:<span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_token&quot;</span>:<span class="string">&quot;b3aad8e2-2840-39a5-8b51-e5b1c5b16bad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>:<span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manufacturer&quot;</span>:<span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device&quot;</span>:<span class="string">&quot;Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os_version&quot;</span>:<span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel&quot;</span>:<span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipruid&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regPlat&quot;</span>:<span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regid&quot;</span>:<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>:<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>:<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mp.appvipshop.com/apns/device_reg&quot;</span></span><br><span class="line">response = requests.get(url,headers=headers,params=parameters)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="number">200</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;ok&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;注册成功&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>参数中<code>device_token</code>是变动的，对其进行逆向</p>
<p>反编译app搜索<code>device_token</code></p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/device_token.jpg" alt="device_token"></p>
<h2 id="of"><a href="#of" class="headerlink" title="of"></a>of</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/of.jpg" alt="device_token"></p>
<h2 id="l"><a href="#l" class="headerlink" title="l"></a>l</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/l.jpg" alt="device_token"></p>
<h2 id="a"><a href="#a" class="headerlink" title="a"></a>a</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/a.jpg" alt="device_token"></p>
<h2 id="getMid"><a href="#getMid" class="headerlink" title="getMid"></a>getMid</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getMid.jpg" alt="device_token"></p>
<p>MidProvider是一个接口，Injector是静态内部类，MidProvider接口定义两个方法<code>String getMid()</code>和<code>String getMidOnly()</code></p>
<h2 id="找MidProvider接口的实现类"><a href="#找MidProvider接口的实现类" class="headerlink" title="找MidProvider接口的实现类"></a>找MidProvider接口的实现类</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/vipmidmanager.jpg" alt="device_token"></p>
<h2 id="VipMidManager"><a href="#VipMidManager" class="headerlink" title="VipMidManager"></a>VipMidManager</h2><p>在vipMidManager类里面找getMid方法，发现jadx并不能反编译这个函数，使用jeb反编译。</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/19.jpg" alt="device_token"></p>
<p>这个方法的解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getMid()方法根据一些条件生成或获取一个 MID，应该是设备唯一标识符。</span><br><span class="line">stringBuilder0用于构建字符串</span><br><span class="line">application0是当前应用的 Application 实例</span><br><span class="line">s为从 SharedPreferences（应用的配置文件）中获取键为 &quot;VIPS_MID&quot; 的值，假设这个值表示设备的唯一标识符。</span><br><span class="line">判断s是否有效，如果无效，设置 stringBuilder0 为 null，创建一个新的 StringBuilder对象，构造日志信息。</span><br><span class="line">调用 DeviceUuidFactory.getDeviceUuid(application0) 获取设备的唯一标识符（UUID）</span><br><span class="line">将 s 设置为 UUID 的字符串形式，并记录日志信息 | create by androidId。</span><br><span class="line">生成新的 MID：</span><br><span class="line">生成一个新的随机 UUID 并将其赋值给 s ， 同时更新日志，记录生成方式为 | create by uuid。</span><br></pre></td></tr></table></figure>

<h2 id="生成uuid"><a href="#生成uuid" class="headerlink" title="生成uuid"></a>生成uuid</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">random_uuid = uuid.uuid4()</span><br><span class="line"><span class="built_in">print</span>(random_uuid)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br><span class="line">85acb30b-3b28-<span class="number">4975</span>-b8cd-2bb53f08b472</span><br></pre></td></tr></table></figure>

<h2 id="设备注册逆向"><a href="#设备注册逆向" class="headerlink" title="设备注册逆向"></a>设备注册逆向</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">device_token = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;okhttp/4.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;authorization&quot;</span>:<span class="string">&quot;OAuth api_sign=fee2a0810c0b9637b6aa0f64b2d91f172dc4e397&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>:<span class="string">&quot;achievo_ad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>:<span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_token&quot;</span>:device_token,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>:<span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manufacturer&quot;</span>:<span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device&quot;</span>:<span class="string">&quot;Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os_version&quot;</span>:<span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel&quot;</span>:<span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipruid&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regPlat&quot;</span>:<span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regid&quot;</span>:<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>:<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>:<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mp.appvipshop.com/apns/device_reg&quot;</span></span><br><span class="line">response = requests.get(url,headers=headers,params=parameters)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="number">200</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;ok&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;注册成功&quot;</span>&#125;</span><br></pre></td></tr></table></figure>



<h1 id="参数api-sign"><a href="#参数api-sign" class="headerlink" title="参数api_sign"></a>参数api_sign</h1><p>分析数据包，找到Authorization参数的api_sign</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/image-20241217095807281.png" alt="image-20241217095807281"></p>
<h1 id="jadx反编译"><a href="#jadx反编译" class="headerlink" title="jadx反编译"></a>jadx反编译</h1><p>文本搜索api_sign</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/Snipaste_2024-12-17_10-06-59.jpg" alt="Snipaste_2024-12-17_10-06-59"></p>
<p>追踪函数</p>
<h2 id="getApiSign"><a href="#getApiSign" class="headerlink" title="getApiSign"></a>getApiSign</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getapisign.jpg" alt="getapisign"></p>
<p>分析，<code>getApiSign</code> 函数用于为网络请求生成包含 API 签名的授权头。</p>
<p>猜测<code>VCSPCommonsConfig.getIAppInfo().getUserTokenSecret()</code> 的作用是从应用程序的配置中获取当前用户的令牌密钥，该密钥通常用于生成 API 签名或进行身份验证。</p>
<h2 id="apisign"><a href="#apisign" class="headerlink" title="apisign"></a>apisign</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/apisign.jpg" alt="apisign"></p>
<p>调用 <code>VCSPSecurityConfig.getMapParamsSign(context, treeMap, str, false)</code> 方法生成签名</p>
<h3 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">VCSPSecurityBasicService</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.security.api.VCSPSecurityBasicService&quot;</span>);</span><br><span class="line">        <span class="title class_">VCSPSecurityBasicService</span>[<span class="string">&quot;apiSign&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">context, treeMap, str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`VCSPSecurityBasicService.apiSign is called!`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;context:&quot;</span>,context);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;treeMap:&quot;</span>,treeMap);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str:&quot;</span>,str);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;apiSign&quot;</span>](context, treeMap, str);                                  </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`VCSPSecurityBasicService.apiSign result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_function</span>()</span><br></pre></td></tr></table></figure>

<h3 id="hook结果"><a href="#hook结果" class="headerlink" title="hook结果"></a>hook结果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VCSPSecurityBasicService.apiSign is called!</span><br><span class="line">context: com.achievo.vipshop.common.VipApplicationLike@41bfc24</span><br><span class="line">treeMap: &#123;activity=null, activity_endtime=null, activity_id=7660011, activity_param=&#123;&quot;page_info&quot;:&#123;&quot;source_from&quot;:&#123;&quot;ffp&quot;:&quot;-99&quot;,&quot;s&quot;:&quot;9&quot;,&quot;fp&quot;:&#123;&quot;ot&quot;:&quot;23&quot;,&quot;chi&quot;:&quot;1024&quot;,&quot;f&quot;:&quot;1&quot;,&quot;tsf&quot;:&quot;0&quot;,&quot;pi&quot;:&quot;20180930001&quot;,&quot;page&quot;:&quot;page_channel&quot;,&quot;cn&quot;:&quot;推荐&quot;&#125;,&quot;tp&quot;:&#123;&quot;pi&quot;:&quot;裤子男款&quot;,&quot;page&quot;:&quot;page_te_commodity_search&quot;&#125;,&quot;sp&quot;:&#123;&quot;ot&quot;:&quot;s93&quot;,&quot;of&quot;:&quot;sf1&quot;,&quot;oi&quot;:&quot;裤子男款&quot;,&quot;page&quot;:&quot;page_te_globle_classify_search&quot;&#125;&#125;,&quot;page_id&quot;:&quot;page_commodity_detail_1734423751094&quot;,&quot;page_propety&quot;:&#123;&quot;sale_id&quot;:&quot;1711235467&quot;,&quot;detailStatus&quot;:&quot;0&quot;,&quot;goods_rank&quot;:&quot;1&quot;,&quot;banStatus&quot;:&quot;-99&quot;,&quot;mr&quot;:&quot;-6017890654677737204&quot;,&quot;scene_entry_id&quot;:&quot;-99&quot;,&quot;refer_page_id&quot;:&quot;page_te_commodity_search_1734423543145&quot;,&quot;goods_id&quot;:&quot;6921055391784126923&quot;,&quot;isPreSale&quot;:&quot;0&quot;,&quot;store&quot;:&quot;0&quot;,&quot;type&quot;:&quot;-99&quot;,&quot;direct_buy&quot;:&quot;-99&quot;,&quot;brand_id&quot;:&quot;1711235467&quot;,&quot;has_color&quot;:&quot;1&quot;,&quot;isBgToFront&quot;:&quot;0&quot;,&quot;buy_mode_scene&quot;:&quot;-99&quot;,&quot;module_name&quot;:&quot;com.achievo.vipshop.productdetail&quot;,&quot;with_image&quot;:&quot;0&quot;,&quot;sr&quot;:&quot;-6017890015095286044&quot;,&quot;is_back_page&quot;:&quot;0&quot;&#125;,&quot;page&quot;:&quot;page_commodity_detail&quot;&#125;,&quot;biz_data&quot;:&#123;&quot;sequence&quot;:&quot;-99&quot;,&quot;target_type&quot;:&quot;1&quot;,&quot;target_id&quot;:&quot;9e8b047b52d0&quot;&#125;&#125;, activity_propety=null, activity_starttime=1734423752401, app_name=shop_android, app_version=9.39.4, channel=1, deeplink_cps=, face_flag=0_1, fdc_area_id=104101113, local_time=1734423856870, location=104101, mid=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad, other_cps=, page_id=page_commodity_detail_1734423751094, repeat=0, service=mobile.activityinfo.logger, session_id=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734423526867, skey=6692c461c3810ab150c9a980d0c275ec, status=, status_descrit=null, user_class=A1, user_group=20460_【23年新客首页】安卓-5.23-[快应用-独立首页]-[顶部导航-测试-18], user_label=3105,310505, userid=null, vipruid=null, warehouse=VIP_HZ&#125;</span><br><span class="line">str: null</span><br><span class="line">VCSPSecurityBasicService.apiSign result=2ba1c5746ce498722dc8eb444f7170ef7319f848</span><br></pre></td></tr></table></figure>



<h2 id="getMapParamsSign"><a href="#getMapParamsSign" class="headerlink" title="getMapParamsSign"></a>getMapParamsSign</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getMapParamsSign.jpg" alt="getMapParamsSign"></p>
<p><code>getMapParamsSign</code> 函数用于生成 API 请求的签名</p>
<p>调用 <code>getSignHash(context, treeMap, str2, z10)</code> 方法，生成签名并返回。</p>
<h2 id="getSignHash"><a href="#getSignHash" class="headerlink" title="getSignHash"></a>getSignHash</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getSignHash.jpg" alt="getSignHash"></p>
<p>调用 <code>gs(context.getApplicationContext(), map, str, z10)</code> 来生成签名哈希值。</p>
<h2 id="gs"><a href="#gs" class="headerlink" title="gs"></a>gs</h2><p>这里jadx不能正常反编译gs函数，使用jeb进行反编译</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/gs.jpg" alt="gs"></p>
<p>调用 <code>VCSPSecurityConfig.initInstance()</code> 方法进行初始化。</p>
<p>通过反射获取 <code>clazz</code> 对应的类中名为 <code>&quot;gs&quot;</code> 的方法，该方法接受 <code>Context</code>、<code>Map</code>、<code>String</code> 和 <code>boolean</code> 类型的参数。</p>
<p>使用反射调用获取到的 <code>gsMethod</code> 方法，传入参数 <code>context0</code>、<code>map0</code>、<code>s</code> 和 <code>z</code>，并将结果转换为 <code>String</code> 类型返回。</p>
<h2 id="initInstance"><a href="#initInstance" class="headerlink" title="initInstance"></a>initInstance</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/instance.jpg"></p>
<p>初始化 <code>VCSPSecurityConfig</code> 类的静态成员 <code>clazz</code> 和 <code>object</code>。</p>
<p><strong><code>clazz = KeyInfo.class</code></strong></p>
<h2 id="KeyInfo-gs"><a href="#KeyInfo-gs" class="headerlink" title="KeyInfo.gs"></a>KeyInfo.gs</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">gs</span><span class="params">(Context context, Map&lt;String, String&gt; map, String str, <span class="type">boolean</span> z10)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> gsNav(context, map, str, z10);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable th2) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;KI gs: &quot;</span> + th2.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable unused) &#123;</span><br><span class="line">        SoLoader.load(context, LibName);</span><br><span class="line">        <span class="keyword">return</span> gsNav(context, map, str, z10);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用 <code>gsNav(context, map, str, z10)</code> 来生成签名。</p>
<h2 id="gsNav"><a href="#gsNav" class="headerlink" title="gsNav"></a>gsNav</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">gsNav</span><span class="params">(Context context, Map&lt;String, String&gt; map, String str, <span class="type">boolean</span> z10)</span>;</span><br></pre></td></tr></table></figure>

<p>这是一个native方法</p>
<h2 id="so"><a href="#so" class="headerlink" title="so"></a>so</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;keyinfo&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(Throwable throwable0) &#123;</span><br><span class="line">        throwable0.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="hook-gsNav"><a href="#hook-gsNav" class="headerlink" title="hook gsNav"></a>hook gsNav</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">printMap</span>(<span class="params">param_map</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HashMap</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.TreeMap&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> arg_map = <span class="title class_">Java</span>.<span class="title function_">cast</span>(param_map,<span class="title class_">HashMap</span>);</span><br><span class="line">    <span class="keyword">return</span> arg_map.<span class="title function_">toString</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_gsNav</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="title class_">KeyInfo</span>[<span class="string">&quot;gsNav&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">context, map, str, z10</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked gsNav----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.gsNav is called: context=<span class="subst">$&#123;context&#125;</span>, map=<span class="subst">$&#123;map&#125;</span>, str=<span class="subst">$&#123;str&#125;</span>, z10=<span class="subst">$&#123;z10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;gsNav map:&quot;</span>,<span class="title function_">printMap</span>(map))</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;gsNav&quot;</span>](context, map, str, z10);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.gsNav result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_gsNav</span>()</span><br></pre></td></tr></table></figure>

<p><strong>结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">----hooked gsNav----</span><br><span class="line">KeyInfo.gsNav is called: context=com.achievo.vipshop.common.VipApplicationLike@478a323, map=[object Object], str=null, z10=false</span><br><span class="line">gsNav map: &#123;activity=lightart_click, activity_endtime=null, activity_propety=&#123;&quot;obj_data&quot;:&quot;sub_sn=1&amp;id=2085883&amp;code=10052420&amp;slotId=4&amp;source=pcmp&amp;slot_type=84&quot;,&quot;hole_type&quot;:&quot;pcmp&quot;,&quot;obj_id&quot;:&quot;336&quot;,&quot;unique_id&quot;:&quot;10052420:7:2085883&quot;,&quot;content_id&quot;:&quot;mst_100056642&quot;,&quot;content_sn&quot;:&quot;1&quot;,&quot;mr&quot;:&quot;-6009657029902736963&quot;,&quot;hole_id&quot;:&quot;2085883&quot;,&quot;operation_code&quot;:&quot;10052420&quot;,&quot;biz_data&quot;:&quot;tt=url&amp;ti=mst_100056642&quot;,&quot;obj_location&quot;:&quot;3:&quot;,&quot;content_type&quot;:&quot;mst&quot;,&quot;ext_data&quot;:&quot;code=10052420&amp;layout_id=52921&amp;slotType=84&amp;slotAbtestId=4218&amp;goodsId=6920749529361397578&amp;floorId=2085883&amp;slotPoolId=53109357&amp;m_name=AA%E7%89%88C%E4%BD%8D&amp;material=108&amp;brandSn=10000542&amp;product_id=6920749529361397578&amp;recommendImageId=f70c02f25aa57695679&amp;menu_code=20180930001&amp;slotId=4&amp;nodeId=1&quot;,&quot;obj_type&quot;:&quot;5&quot;,&quot;page&quot;:&quot;page_channel&quot;,&quot;cache_data&quot;:&quot;0&quot;&#125;, activity_starttime=1734846844455, app_name=shop_android, app_version=9.39.4, channel=1, deeplink_cps=, face_flag=0_1, fdc_area_id=104101113, local_time=1734846955236, location=104101, mid=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad, other_cps=, page_id=page_channel_1734846541245, repeat=0, service=mobile.activityinfo.logger, session_id=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734845336928, skey=6692c461c3810ab150c9a980d0c275ec, status=, status_descrit=null, user_class=A1, user_group=20460_【23年新客首页】安卓-5.23-[快应用-独立首页]-[顶部导航-测试-18], user_label=3105,310505, userid=null, vipruid=null, warehouse=VIP_HZ&#125;</span><br><span class="line">KeyInfo.gsNav result=0aff60c1b478fdafc0ea9700cdd80d1ae4c46f7d</span><br><span class="line">----hooked over!----</span><br></pre></td></tr></table></figure>





<h1 id="分析so"><a href="#分析so" class="headerlink" title="分析so"></a>分析so</h1><p>导出函数中找gsNav</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/exports.jpg"></p>
<h2 id="Java-com-vip-vcsp-KeyInfo-gsNav"><a href="#Java-com-vip-vcsp-KeyInfo-gsNav" class="headerlink" title="Java_com_vip_vcsp_KeyInfo_gsNav"></a>Java_com_vip_vcsp_KeyInfo_gsNav</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Java_com_vip_vcsp_KeyInfo_gsNav</span><span class="params">(</span></span><br><span class="line"><span class="params">        __int64 a1,</span></span><br><span class="line"><span class="params">        __int64 a2,</span></span><br><span class="line"><span class="params">        __int64 a3,</span></span><br><span class="line"><span class="params">        __int64 a4,</span></span><br><span class="line"><span class="params">        __int64 a5,</span></span><br><span class="line"><span class="params">        <span class="type">unsigned</span> <span class="type">int</span> a6)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v11; <span class="comment">// x20</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)Utils_ima(a1, a2, a3) )</span><br><span class="line">    v11 = Functions_gs(a1, a2, a4, a5, a6);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v11 = <span class="number">0LL</span>;</span><br><span class="line">  Utils_checkJniException(a1);</span><br><span class="line">  <span class="keyword">return</span> v11;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Functions-gs"><a href="#Functions-gs" class="headerlink" title="Functions_gs"></a>Functions_gs</h2><p>关键代码</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/functions_gs.jpg"></p>
<h2 id="getByteHash"><a href="#getByteHash" class="headerlink" title="getByteHash"></a>getByteHash</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">getByteHash</span><span class="params">(JNIEnv *a1, jobject a2, __int64 a3, <span class="type">unsigned</span> <span class="type">int</span> a4, <span class="type">char</span> *a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 i; <span class="comment">// x20</span></span><br><span class="line">  _OWORD v10[<span class="number">4</span>]; <span class="comment">// [xsp+0h] [xbp-E0h] BYREF</span></span><br><span class="line">  _BYTE v11[<span class="number">104</span>]; <span class="comment">// [xsp+40h] [xbp-A0h] BYREF</span></span><br><span class="line">  __int64 v12; <span class="comment">// [xsp+A8h] [xbp-38h]</span></span><br><span class="line"></span><br><span class="line">  v12 = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="number">3</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>)) + <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !a3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  SHA1Reset(v11);</span><br><span class="line">  SHA1Input(v11, a3, a4);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)SHA1Result(v11) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i != <span class="number">20</span>; i += <span class="number">4LL</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">memset</span>(v10, <span class="number">0</span>, <span class="keyword">sizeof</span>(v10));</span><br><span class="line">      sub_F2328(v10);</span><br><span class="line">      <span class="built_in">strcat</span>(a5, (<span class="type">const</span> <span class="type">char</span> *)v10);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里看出这是SHA1算法</p>
<h2 id="hook-getByteHash"><a href="#hook-getByteHash" class="headerlink" title="hook getByteHash"></a>hook getByteHash</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libkeyinfo.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> functionaddr = soAddr.<span class="title function_">add</span>(<span class="number">0xF2260</span>)</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionaddr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">2</span>],&#123;length : args[<span class="number">3</span>].<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">4</span>]));</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,<span class="title function_">hexdump</span>(ret))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_native</span>()</span><br></pre></td></tr></table></figure>

<h3 id="示例一个hook结果"><a href="#示例一个hook结果" class="headerlink" title="示例一个hook结果"></a>示例一个hook结果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">arg2              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">71fb5bdf50  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">71fb5bdf60  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">71fb5bdf70  65 66 66 63 38 31 33 35 31 39 36 61 63 30 35 64  effc8135196ac05d</span><br><span class="line">71fb5bdf80  63 64 36 39 64 35 36 39 32 66 32 31 37 34 33 33  cd69d5692f217433</span><br><span class="line">71fb5bdf90  30 39 62 31 38 62 36 63                          09b18b6c</span><br><span class="line">arg3 0x48</span><br><span class="line">arg4              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">71fb5be050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be0a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">71fb5be050  36 61 38 35 66 30 38 65 35 37 66 37 30 38 35 38  6a85f08e57f70858</span><br><span class="line">71fb5be060  33 35 37 32 35 33 61 37 32 34 34 62 33 32 63 65  357253a7244b32ce</span><br><span class="line">71fb5be070  62 36 33 39 62 62 66 39 00 00 00 00 00 00 00 00  b639bbf9........</span><br><span class="line">71fb5be080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br></pre></td></tr></table></figure>

<p>如下验证了这是一个标准的SHA1算法</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/tttt.jpg" alt="tttt"></p>
<h3 id="升级一下脚本继续hook"><a href="#升级一下脚本继续hook" class="headerlink" title="升级一下脚本继续hook"></a>升级一下脚本继续hook</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libkeyinfo.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> functionaddr = soAddr.<span class="title function_">add</span>(<span class="number">0xF2260</span>)  </span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionaddr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked getByteHash----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">2</span>],&#123;length : args[<span class="number">3</span>].<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3:&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">4</span>]));</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg2</span> = args[<span class="number">2</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg3</span> = args[<span class="number">3</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg4</span> = args[<span class="number">4</span>];</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg2:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg2</span>,&#123;length : <span class="variable language_">this</span>.<span class="property">arg3</span>.<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg3:&quot;</span>,<span class="variable language_">this</span>.<span class="property">arg3</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg4:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg4</span>));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,<span class="title function_">hexdump</span>(ret));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_native</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">724c411400  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">724c411410  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">724c411420  61 63 74 69 76 69 74 79 3d 61 63 74 69 76 65 5f  activity=active_</span><br><span class="line">724c411430  74 65 5f 64 79 6e 61 6d 69 63 5f 72 65 73 26 61  te_dynamic_res&amp;a</span><br><span class="line">724c411440  63 74 69 76 69 74 79 5f 65 6e 64 74 69 6d 65 3d  ctivity_endtime=</span><br><span class="line">724c411450  6e 75 6c 6c 26 61 63 74 69 76 69 74 79 5f 70 72  null&amp;activity_pr</span><br><span class="line">724c411460  6f 70 65 74 79 3d 7b 22 61 63 74 69 76 69 74 79  opety=&#123;&quot;activity</span><br><span class="line">724c411470  5f 6e 61 6d 65 22 3a 22 22 2c 22 64 65 70 65 6e  _name&quot;:&quot;&quot;,&quot;depen</span><br><span class="line">724c411480  64 5f 73 74 61 74 75 73 22 3a 2d 31 2c 22 6d 6f  d_status&quot;:-1,&quot;mo</span><br><span class="line">724c411490  64 75 6c 65 22 3a 22 73 6d 61 72 74 52 6f 75 74  dule&quot;:&quot;smartRout</span><br><span class="line">724c4114a0  65 22 2c 22 6d 61 74 63 68 22 3a 31 2c 22 69 73  e&quot;,&quot;match&quot;:1,&quot;is</span><br><span class="line">724c4114b0  5f 64 65 62 75 67 22 3a 22 30 22 2c 22 61 70 6b  _debug&quot;:&quot;0&quot;,&quot;apk</span><br><span class="line">724c4114c0  5f 74 79 70 65 22 3a 22 31 22 2c 22 73 63 65 6e  _type&quot;:&quot;1&quot;,&quot;scen</span><br><span class="line">724c4114d0  65 22 3a 22 61 70 69 22 2c 22 69 73 5f 6d 61 69  e&quot;:&quot;api&quot;,&quot;is_mai</span><br><span class="line">724c4114e0  6e 5f 70 72 6f 63 65 73 73 22 3a 31 2c 22 66 61  n_process&quot;:1,&quot;fa</span><br><span class="line">724c4114f0  69 6c 5f 62 61 63 6b 22 3a 30 2c 22 65 76 65 6e  il_back&quot;:0,&quot;even</span><br><span class="line">724c411500  74 5f 69 64 22 3a 30 2c 22 68 61 73 5f 6d 6f 64  t_id&quot;:0,&quot;has_mod</span><br><span class="line">724c411510  75 6c 65 22 3a 30 2c 22 72 65 6d 6f 76 65 5f 73  ule&quot;:0,&quot;remove_s</span><br><span class="line">724c411520  6f 22 3a 22 30 22 2c 22 61 63 74 69 6f 6e 22 3a  o&quot;:&quot;0&quot;,&quot;action&quot;:</span><br><span class="line">724c411530  22 72 65 73 5f 73 63 65 6e 65 22 2c 22 73 74 61  &quot;res_scene&quot;,&quot;sta</span><br><span class="line">724c411540  74 75 73 22 3a 30 7d 26 61 63 74 69 76 69 74 79  tus&quot;:0&#125;&amp;activity</span><br><span class="line">724c411550  5f 73 74 61 72 74 74 69 6d 65 3d 31 37 33 34 38  _starttime=17348</span><br><span class="line">724c411560  34 37 33 37 31 36 36 38 26 61 70 70 5f 6e 61 6d  47371668&amp;app_nam</span><br><span class="line">724c411570  65 3d 73 68 6f 70 5f 61 6e 64 72 6f 69 64 26 61  e=shop_android&amp;a</span><br><span class="line">724c411580  70 70 5f 76 65 72 73 69 6f 6e 3d 39 2e 33 39 2e  pp_version=9.39.</span><br><span class="line">724c411590  34 26 63 68 61 6e 6e 65 6c 3d 31 26 64 65 65 70  4&amp;channel=1&amp;deep</span><br><span class="line">724c4115a0  6c 69 6e 6b 5f 63 70 73 3d 26 66 61 63 65 5f 66  link_cps=&amp;face_f</span><br><span class="line">724c4115b0  6c 61 67 3d 30 5f 31 26 66 64 63 5f 61 72 65 61  lag=0_1&amp;fdc_area</span><br><span class="line">724c4115c0  5f 69 64 3d 31 30 34 31 30 31 31 31 33 26 6c 6f  _id=104101113&amp;lo</span><br><span class="line">724c4115d0  63 61 6c 5f 74 69 6d 65 3d 31 37 33 34 38 34 37  cal_time=1734847</span><br><span class="line">724c4115e0  33 37 31 36 36 38 26 6c 6f 63 61 74 69 6f 6e 3d  371668&amp;location=</span><br><span class="line">724c4115f0  31 30 34 31 30 31 26 6d 69 64 3d 62 33 61 61 64  104101&amp;mid=b3aad</span><br><span class="line">724c411600  38 65 32 2d 32 38 34 30 2d 33 39 61 35 2d 38 62  8e2-2840-39a5-8b</span><br><span class="line">724c411610  35 31 2d 65 35 62 31 63 35 62 31 36 62 61 64 26  51-e5b1c5b16bad&amp;</span><br><span class="line">724c411620  6f 74 68 65 72 5f 63 70 73 3d 26 70 61 67 65 5f  other_cps=&amp;page_</span><br><span class="line">724c411630  69 64 3d 70 61 67 65 5f 74 65 5f 6c 6f 64 69 6e  id=page_te_lodin</span><br><span class="line">724c411640  67 5f 61 63 74 69 76 69 74 79 5f 31 37 33 34 38  g_activity_17348</span><br><span class="line">724c411650  34 37 33 37 31 34 30 31 26 72 65 70 65 61 74 3d  47371401&amp;repeat=</span><br><span class="line">724c411660  30 26 73 65 72 76 69 63 65 3d 6d 6f 62 69 6c 65  0&amp;service=mobile</span><br><span class="line">724c411670  2e 61 63 74 69 76 69 74 79 69 6e 66 6f 2e 6c 6f  .activityinfo.lo</span><br><span class="line">724c411680  67 67 65 72 26 73 65 73 73 69 6f 6e 5f 69 64 3d  gger&amp;session_id=</span><br><span class="line">724c411690  62 33 61 61 64 38 65 32 2d 32 38 34 30 2d 33 39  b3aad8e2-2840-39</span><br><span class="line">724c4116a0  61 35 2d 38 62 35 31 2d 65 35 62 31 63 35 62 31  a5-8b51-e5b1c5b1</span><br><span class="line">724c4116b0  36 62 61 64 5f 73 68 6f 70 5f 61 6e 64 72 6f 69  6bad_shop_androi</span><br><span class="line">724c4116c0  64 5f 31 37 33 34 38 34 37 33 37 31 33 33 35 26  d_1734847371335&amp;</span><br><span class="line">724c4116d0  73 6b 65 79 3d 36 36 39 32 63 34 36 31 63 33 38  skey=6692c461c38</span><br><span class="line">724c4116e0  31 30 61 62 31 35 30 63 39 61 39 38 30 64 30 63  10ab150c9a980d0c</span><br><span class="line">724c4116f0  32 37 35 65 63 26 73 74 61 74 75 73 3d 26 73 74  275ec&amp;status=&amp;st</span><br><span class="line">724c411700  61 74 75 73 5f 64 65 73 63 72 69 74 3d 6e 75 6c  atus_descrit=nul</span><br><span class="line">724c411710  6c 26 75 73 65 72 5f 63 6c 61 73 73 3d 41 31 26  l&amp;user_class=A1&amp;</span><br><span class="line">724c411720  75 73 65 72 5f 67 72 6f 75 70 3d 32 30 34 36 30  user_group=20460</span><br><span class="line">724c411730  5f e3 80 90 32 33 e5 b9 b4 e6 96 b0 e5 ae a2 e9  _...23..........</span><br><span class="line">724c411740  a6 96 e9 a1 b5 e3 80 91 e5 ae 89 e5 8d 93 2d 35  ..............-5</span><br><span class="line">724c411750  2e 32 33 2d 5b e5 bf ab e5 ba 94 e7 94 a8 2d e7  .23-[.........-.</span><br><span class="line">724c411760  8b ac e7 ab 8b e9 a6 96 e9 a1 b5 5d 2d 5b e9 a1  ...........]-[..</span><br><span class="line">724c411770  b6 e9 83 a8 e5 af bc e8 88 aa 2d e6 b5 8b e8 af  ..........-.....</span><br><span class="line">724c411780  95 2d 31 38 5d 26 75 73 65 72 5f 6c 61 62 65 6c  .-18]&amp;user_label</span><br><span class="line">724c411790  3d 33 31 30 35 2c 33 31 30 35 30 35 26 75 73 65  =3105,310505&amp;use</span><br><span class="line">724c4117a0  72 69 64 3d 6e 75 6c 6c 26 76 69 70 72 75 69 64  rid=null&amp;vipruid</span><br><span class="line">724c4117b0  3d 6e 75 6c 6c 26 77 61 72 65 68 6f 75 73 65 3d  =null&amp;warehouse=</span><br><span class="line">724c4117c0  56 49 50 5f 48 5a                                VIP_HZ</span><br><span class="line">arg3: 0x3c6</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40b0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">724c411400  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">724c411410  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">724c411420  61 63 74 69 76 69 74 79 3d 61 63 74 69 76 65 5f  activity=active_</span><br><span class="line">724c411430  74 65 5f 64 79 6e 61 6d 69 63 5f 72 65 73 26 61  te_dynamic_res&amp;a</span><br><span class="line">724c411440  63 74 69 76 69 74 79 5f 65 6e 64 74 69 6d 65 3d  ctivity_endtime=</span><br><span class="line">724c411450  6e 75 6c 6c 26 61 63 74 69 76 69 74 79 5f 70 72  null&amp;activity_pr</span><br><span class="line">724c411460  6f 70 65 74 79 3d 7b 22 61 63 74 69 76 69 74 79  opety=&#123;&quot;activity</span><br><span class="line">724c411470  5f 6e 61 6d 65 22 3a 22 22 2c 22 64 65 70 65 6e  _name&quot;:&quot;&quot;,&quot;depen</span><br><span class="line">724c411480  64 5f 73 74 61 74 75 73 22 3a 2d 31 2c 22 6d 6f  d_status&quot;:-1,&quot;mo</span><br><span class="line">724c411490  64 75 6c 65 22 3a 22 73 6d 61 72 74 52 6f 75 74  dule&quot;:&quot;smartRout</span><br><span class="line">724c4114a0  65 22 2c 22 6d 61 74 63 68 22 3a 31 2c 22 69 73  e&quot;,&quot;match&quot;:1,&quot;is</span><br><span class="line">724c4114b0  5f 64 65 62 75 67 22 3a 22 30 22 2c 22 61 70 6b  _debug&quot;:&quot;0&quot;,&quot;apk</span><br><span class="line">724c4114c0  5f 74 79 70 65 22 3a 22 31 22 2c 22 73 63 65 6e  _type&quot;:&quot;1&quot;,&quot;scen</span><br><span class="line">724c4114d0  65 22 3a 22 61 70 69 22 2c 22 69 73 5f 6d 61 69  e&quot;:&quot;api&quot;,&quot;is_mai</span><br><span class="line">724c4114e0  6e 5f 70 72 6f 63 65 73 73 22 3a 31 2c 22 66 61  n_process&quot;:1,&quot;fa</span><br><span class="line">724c4114f0  69 6c 5f 62 61 63 6b 22 3a 30 2c 22 65 76 65 6e  il_back&quot;:0,&quot;even</span><br><span class="line">724c411500  74 5f 69 64 22 3a 30 2c 22 68 61 73 5f 6d 6f 64  t_id&quot;:0,&quot;has_mod</span><br><span class="line">724c411510  75 6c 65 22 3a 30 2c 22 72 65 6d 6f 76 65 5f 73  ule&quot;:0,&quot;remove_s</span><br><span class="line">724c411520  6f 22 3a 22 30 22 2c 22 61 63 74 69 6f 6e 22 3a  o&quot;:&quot;0&quot;,&quot;action&quot;:</span><br><span class="line">724c411530  22 72 65 73 5f 73 63 65 6e 65 22 2c 22 73 74 61  &quot;res_scene&quot;,&quot;sta</span><br><span class="line">724c411540  74 75 73 22 3a 30 7d 26 61 63 74 69 76 69 74 79  tus&quot;:0&#125;&amp;activity</span><br><span class="line">724c411550  5f 73 74 61 72 74 74 69 6d 65 3d 31 37 33 34 38  _starttime=17348</span><br><span class="line">724c411560  34 37 33 37 31 36 36 38 26 61 70 70 5f 6e 61 6d  47371668&amp;app_nam</span><br><span class="line">724c411570  65 3d 73 68 6f 70 5f 61 6e 64 72 6f 69 64 26 61  e=shop_android&amp;a</span><br><span class="line">724c411580  70 70 5f 76 65 72 73 69 6f 6e 3d 39 2e 33 39 2e  pp_version=9.39.</span><br><span class="line">724c411590  34 26 63 68 61 6e 6e 65 6c 3d 31 26 64 65 65 70  4&amp;channel=1&amp;deep</span><br><span class="line">724c4115a0  6c 69 6e 6b 5f 63 70 73 3d 26 66 61 63 65 5f 66  link_cps=&amp;face_f</span><br><span class="line">724c4115b0  6c 61 67 3d 30 5f 31 26 66 64 63 5f 61 72 65 61  lag=0_1&amp;fdc_area</span><br><span class="line">724c4115c0  5f 69 64 3d 31 30 34 31 30 31 31 31 33 26 6c 6f  _id=104101113&amp;lo</span><br><span class="line">724c4115d0  63 61 6c 5f 74 69 6d 65 3d 31 37 33 34 38 34 37  cal_time=1734847</span><br><span class="line">724c4115e0  33 37 31 36 36 38 26 6c 6f 63 61 74 69 6f 6e 3d  371668&amp;location=</span><br><span class="line">724c4115f0  31 30 34 31 30 31 26 6d 69 64 3d 62 33 61 61 64  104101&amp;mid=b3aad</span><br><span class="line">724c411600  38 65 32 2d 32 38 34 30 2d 33 39 61 35 2d 38 62  8e2-2840-39a5-8b</span><br><span class="line">724c411610  35 31 2d 65 35 62 31 63 35 62 31 36 62 61 64 26  51-e5b1c5b16bad&amp;</span><br><span class="line">724c411620  6f 74 68 65 72 5f 63 70 73 3d 26 70 61 67 65 5f  other_cps=&amp;page_</span><br><span class="line">724c411630  69 64 3d 70 61 67 65 5f 74 65 5f 6c 6f 64 69 6e  id=page_te_lodin</span><br><span class="line">724c411640  67 5f 61 63 74 69 76 69 74 79 5f 31 37 33 34 38  g_activity_17348</span><br><span class="line">724c411650  34 37 33 37 31 34 30 31 26 72 65 70 65 61 74 3d  47371401&amp;repeat=</span><br><span class="line">724c411660  30 26 73 65 72 76 69 63 65 3d 6d 6f 62 69 6c 65  0&amp;service=mobile</span><br><span class="line">724c411670  2e 61 63 74 69 76 69 74 79 69 6e 66 6f 2e 6c 6f  .activityinfo.lo</span><br><span class="line">724c411680  67 67 65 72 26 73 65 73 73 69 6f 6e 5f 69 64 3d  gger&amp;session_id=</span><br><span class="line">724c411690  62 33 61 61 64 38 65 32 2d 32 38 34 30 2d 33 39  b3aad8e2-2840-39</span><br><span class="line">724c4116a0  61 35 2d 38 62 35 31 2d 65 35 62 31 63 35 62 31  a5-8b51-e5b1c5b1</span><br><span class="line">724c4116b0  36 62 61 64 5f 73 68 6f 70 5f 61 6e 64 72 6f 69  6bad_shop_androi</span><br><span class="line">724c4116c0  64 5f 31 37 33 34 38 34 37 33 37 31 33 33 35 26  d_1734847371335&amp;</span><br><span class="line">724c4116d0  73 6b 65 79 3d 36 36 39 32 63 34 36 31 63 33 38  skey=6692c461c38</span><br><span class="line">724c4116e0  31 30 61 62 31 35 30 63 39 61 39 38 30 64 30 63  10ab150c9a980d0c</span><br><span class="line">724c4116f0  32 37 35 65 63 26 73 74 61 74 75 73 3d 26 73 74  275ec&amp;status=&amp;st</span><br><span class="line">724c411700  61 74 75 73 5f 64 65 73 63 72 69 74 3d 6e 75 6c  atus_descrit=nul</span><br><span class="line">724c411710  6c 26 75 73 65 72 5f 63 6c 61 73 73 3d 41 31 26  l&amp;user_class=A1&amp;</span><br><span class="line">724c411720  75 73 65 72 5f 67 72 6f 75 70 3d 32 30 34 36 30  user_group=20460</span><br><span class="line">724c411730  5f e3 80 90 32 33 e5 b9 b4 e6 96 b0 e5 ae a2 e9  _...23..........</span><br><span class="line">724c411740  a6 96 e9 a1 b5 e3 80 91 e5 ae 89 e5 8d 93 2d 35  ..............-5</span><br><span class="line">724c411750  2e 32 33 2d 5b e5 bf ab e5 ba 94 e7 94 a8 2d e7  .23-[.........-.</span><br><span class="line">724c411760  8b ac e7 ab 8b e9 a6 96 e9 a1 b5 5d 2d 5b e9 a1  ...........]-[..</span><br><span class="line">724c411770  b6 e9 83 a8 e5 af bc e8 88 aa 2d e6 b5 8b e8 af  ..........-.....</span><br><span class="line">724c411780  95 2d 31 38 5d 26 75 73 65 72 5f 6c 61 62 65 6c  .-18]&amp;user_label</span><br><span class="line">724c411790  3d 33 31 30 35 2c 33 31 30 35 30 35 26 75 73 65  =3105,310505&amp;use</span><br><span class="line">724c4117a0  72 69 64 3d 6e 75 6c 6c 26 76 69 70 72 75 69 64  rid=null&amp;vipruid</span><br><span class="line">724c4117b0  3d 6e 75 6c 6c 26 77 61 72 65 68 6f 75 73 65 3d  =null&amp;warehouse=</span><br><span class="line">724c4117c0  56 49 50 5f 48 5a                                VIP_HZ</span><br><span class="line">ret_arg3: 0x3c6</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e4060  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e4070  64 66 36 66 62 65 36 31 00 00 00 00 00 00 00 00  df6fbe61........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e4060  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e4070  64 66 36 66 62 65 36 31 00 00 00 00 00 00 00 00  df6fbe61........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e3f50  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">72342e3f60  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">72342e3f70  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e3f80  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e3f90  64 66 36 66 62 65 36 31                          df6fbe61</span><br><span class="line">arg3: 0x48</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e3f50  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">72342e3f60  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">72342e3f70  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e3f80  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e3f90  64 66 36 66 62 65 36 31                          df6fbe61</span><br><span class="line">ret_arg3: 0x48</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 33 37 66 32 64 66 62 33 34 64 38 38 34 36 63  237f2dfb34d8846c</span><br><span class="line">72342e4060  61 37 66 31 31 30 37 31 35 38 33 66 62 33 61 66  a7f11071583fb3af</span><br><span class="line">72342e4070  35 66 39 38 62 39 66 65 00 00 00 00 00 00 00 00  5f98b9fe........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 33 37 66 32 64 66 62 33 34 64 38 38 34 36 63  237f2dfb34d8846c</span><br><span class="line">72342e4060  61 37 66 31 31 30 37 31 35 38 33 66 62 33 61 66  a7f11071583fb3af</span><br><span class="line">72342e4070  35 66 39 38 62 39 66 65 00 00 00 00 00 00 00 00  5f98b9fe........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br></pre></td></tr></table></figure>

<h3 id="主动调用gsNav方法，来观察getByteHash的输出结果"><a href="#主动调用gsNav方法，来观察getByteHash的输出结果" class="headerlink" title="主动调用gsNav方法，来观察getByteHash的输出结果"></a>主动调用gsNav方法，来观察getByteHash的输出结果</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">call_gsNav</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----call gsNav----&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> currentApplication = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>();</span><br><span class="line">        <span class="keyword">var</span> context = currentApplication.<span class="title function_">getApplicationContext</span>();</span><br><span class="line">        <span class="keyword">var</span> map = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.TreeMap&quot;</span>).$new();</span><br><span class="line">        map.<span class="title function_">put</span>(<span class="string">&quot;api_key&quot;</span>,<span class="string">&quot;bileton&quot;</span>)</span><br><span class="line">        map.<span class="title function_">put</span>(<span class="string">&quot;app_name&quot;</span>,<span class="string">&quot;shop_android&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> string = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">var</span> boolean = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> result = <span class="title class_">KeyInfo</span>.<span class="title function_">gsNav</span>(context,map,string,boolean)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;call gsNav result:&quot;</span>,result)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----call gsNav over----&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libkeyinfo.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> functionaddr = soAddr.<span class="title function_">add</span>(<span class="number">0xF2260</span>)  </span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionaddr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked getByteHash----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">2</span>],&#123;length : args[<span class="number">3</span>].<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3:&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">4</span>]));</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg2</span> = args[<span class="number">2</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg3</span> = args[<span class="number">3</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg4</span> = args[<span class="number">4</span>];</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg2:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg2</span>,&#123;length : <span class="variable language_">this</span>.<span class="property">arg3</span>.<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg3:&quot;</span>,<span class="variable language_">this</span>.<span class="property">arg3</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg4:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg4</span>));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,<span class="title function_">hexdump</span>(ret));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">hook_native</span>();</span><br><span class="line">    <span class="title function_">call_gsNav</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">----call gsNav----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d0246f580  30 82 02 5f 30 82 01 c8 a0 03 02 01 02 02 04 4e  0.._0..........N</span><br><span class="line">7d0246f590  77 18 86 30 0d 06 09 2a 86 48 86 f7 0d 01 01 05  w..0...*.H......</span><br><span class="line">7d0246f5a0  05 00 30 73 31 0b 30 09 06 03 55 04 06 13 02 63  ..0s1.0...U....c</span><br><span class="line">7d0246f5b0  6e 31 12 30 10 06 03 55 04 08 13 09 67 75 61 6e  n1.0...U....guan</span><br><span class="line">7d0246f5c0  67 64 6f 6e 67 31 12 30 10 06 03 55 04 07 13 09  gdong1.0...U....</span><br><span class="line">7d0246f5d0  67 75 61 6e 67 7a 68 6f 75 31 10 30 0e 06 03 55  guangzhou1.0...U</span><br><span class="line">7d0246f5e0  04 0a 13 07 76 69 70 73 68 6f 70 31 18 30 16 06  ....vipshop1.0..</span><br><span class="line">7d0246f5f0  03 55 04 0b 13 0f 77 77 77 2e 76 69 70 73 68 6f  .U....www.vipsho</span><br><span class="line">7d0246f600  70 2e 63 6f 6d 31 10 30 0e 06 03 55 04 03 13 07  p.com1.0...U....</span><br><span class="line">7d0246f610  76 69 70 73 68 6f 70 30 20 17 0d 31 31 30 39 31  vipshop0 ..11091</span><br><span class="line">7d0246f620  39 31 30 32 35 31 30 5a 18 0f 32 32 38 35 30 37  9102510Z..228507</span><br><span class="line">7d0246f630  30 34 31 30 32 35 31 30 5a 30 73 31 0b 30 09 06  04102510Z0s1.0..</span><br><span class="line">7d0246f640  03 55 04 06 13 02 63 6e 31 12 30 10 06 03 55 04  .U....cn1.0...U.</span><br><span class="line">7d0246f650  08 13 09 67 75 61 6e 67 64 6f 6e 67 31 12 30 10  ...guangdong1.0.</span><br><span class="line">7d0246f660  06 03 55 04 07 13 09 67 75 61 6e 67 7a 68 6f 75  ..U....guangzhou</span><br><span class="line">7d0246f670  31 10 30 0e 06 03 55 04 0a 13 07 76 69 70 73 68  1.0...U....vipsh</span><br><span class="line">7d0246f680  6f 70 31 18 30 16 06 03 55 04 0b 13 0f 77 77 77  op1.0...U....www</span><br><span class="line">7d0246f690  2e 76 69 70 73 68 6f 70 2e 63 6f 6d 31 10 30 0e  .vipshop.com1.0.</span><br><span class="line">7d0246f6a0  06 03 55 04 03 13 07 76 69 70 73 68 6f 70 30 81  ..U....vipshop0.</span><br><span class="line">7d0246f6b0  9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00  .0...*.H........</span><br><span class="line">7d0246f6c0  03 81 8d 00 30 81 89 02 81 81 00 93 34 83 f8 c0  ....0.......4...</span><br><span class="line">7d0246f6d0  1a 56 74 4a a3 a0 54 73 95 ca c4 22 ea 07 ae a0  .VtJ..Ts...&quot;....</span><br><span class="line">7d0246f6e0  3f 38 45 90 c1 fc bb eb d3 0c 71 39 5e a8 b6 bd  ?8E.......q9^...</span><br><span class="line">7d0246f6f0  1a 1b 04 84 47 49 0e 4b af 36 5a 4b 49 72 6f 35  ....GI.K.6ZKIro5</span><br><span class="line">7d0246f700  4e 57 96 35 f5 40 7e 63 86 57 49 2f 6c af 66 5c  NW.5.@~c.WI/l.f\</span><br><span class="line">7d0246f710  27 18 11 8c cc ba d9 2f 1f fc ab 62 3c c7 ca 9e  &#x27;....../...b&lt;...</span><br><span class="line">7d0246f720  a8 ca 9a d5 8c 47 ab 21 05 ba 7c 7c 6d 6f fe 46  .....G.!..||mo.F</span><br><span class="line">7d0246f730  6d 7e 94 06 bb f0 28 cb 9b b5 43 3a 74 cb 85 47  m~....(...C:t..G</span><br><span class="line">7d0246f740  d1 b6 de de f8 84 56 a1 67 9d 3d 02 03 01 00 01  ......V.g.=.....</span><br><span class="line">7d0246f750  30 0d 06 09 2a 86 48 86 f7 0d 01 01 05 05 00 03  0...*.H.........</span><br><span class="line">7d0246f760  81 81 00 17 fd cc f7 dd 2f 1a 42 80 92 89 a2 15  ......../.B.....</span><br><span class="line">7d0246f770  9b 64 aa 5a b0 57 91 35 88 18 37 74 3b ca 21 18  .d.Z.W.5..7t;.!.</span><br><span class="line">7d0246f780  0b f3 30 50 75 4b b8 a8 44 90 02 c6 07 5e b6 d7  ..0PuK..D....^..</span><br><span class="line">7d0246f790  1a 65 80 06 a6 b6 00 94 c1 69 f0 77 fb 06 3b 93  .e.......i.w..;.</span><br><span class="line">7d0246f7a0  91 64 d1 64 e6 70 4a ae a1 14 c1 fa ed b4 eb fc  .d.d.pJ.........</span><br><span class="line">7d0246f7b0  25 db ca 96 21 a5 58 d2 8b 87 1c 72 7f ff b6 0e  %...!.X....r....</span><br><span class="line">7d0246f7c0  c7 40 e8 64 01 53 e8 e9 4d a9 da 7b 09 9e 30 82  .@.d.S..M..&#123;..0.</span><br><span class="line">7d0246f7d0  c3 77 e4 6d 2d 4e 9c 4a 25 8a b2 54 99 d1 da 85  .w.m-N.J%..T....</span><br><span class="line">7d0246f7e0  5b 14 ca                                         [..</span><br><span class="line">arg3: 0x263</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea9c80  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9c90  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9ca0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cb0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cc0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cd0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line"></span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d0246f580  30 82 02 5f 30 82 01 c8 a0 03 02 01 02 02 04 4e  0.._0..........N</span><br><span class="line">7d0246f590  77 18 86 30 0d 06 09 2a 86 48 86 f7 0d 01 01 05  w..0...*.H......</span><br><span class="line">7d0246f5a0  05 00 30 73 31 0b 30 09 06 03 55 04 06 13 02 63  ..0s1.0...U....c</span><br><span class="line">7d0246f5b0  6e 31 12 30 10 06 03 55 04 08 13 09 67 75 61 6e  n1.0...U....guan</span><br><span class="line">7d0246f5c0  67 64 6f 6e 67 31 12 30 10 06 03 55 04 07 13 09  gdong1.0...U....</span><br><span class="line">7d0246f5d0  67 75 61 6e 67 7a 68 6f 75 31 10 30 0e 06 03 55  guangzhou1.0...U</span><br><span class="line">7d0246f5e0  04 0a 13 07 76 69 70 73 68 6f 70 31 18 30 16 06  ....vipshop1.0..</span><br><span class="line">7d0246f5f0  03 55 04 0b 13 0f 77 77 77 2e 76 69 70 73 68 6f  .U....www.vipsho</span><br><span class="line">7d0246f600  70 2e 63 6f 6d 31 10 30 0e 06 03 55 04 03 13 07  p.com1.0...U....</span><br><span class="line">7d0246f610  76 69 70 73 68 6f 70 30 20 17 0d 31 31 30 39 31  vipshop0 ..11091</span><br><span class="line">7d0246f620  39 31 30 32 35 31 30 5a 18 0f 32 32 38 35 30 37  9102510Z..228507</span><br><span class="line">7d0246f630  30 34 31 30 32 35 31 30 5a 30 73 31 0b 30 09 06  04102510Z0s1.0..</span><br><span class="line">7d0246f640  03 55 04 06 13 02 63 6e 31 12 30 10 06 03 55 04  .U....cn1.0...U.</span><br><span class="line">7d0246f650  08 13 09 67 75 61 6e 67 64 6f 6e 67 31 12 30 10  ...guangdong1.0.</span><br><span class="line">7d0246f660  06 03 55 04 07 13 09 67 75 61 6e 67 7a 68 6f 75  ..U....guangzhou</span><br><span class="line">7d0246f670  31 10 30 0e 06 03 55 04 0a 13 07 76 69 70 73 68  1.0...U....vipsh</span><br><span class="line">7d0246f680  6f 70 31 18 30 16 06 03 55 04 0b 13 0f 77 77 77  op1.0...U....www</span><br><span class="line">7d0246f690  2e 76 69 70 73 68 6f 70 2e 63 6f 6d 31 10 30 0e  .vipshop.com1.0.</span><br><span class="line">7d0246f6a0  06 03 55 04 03 13 07 76 69 70 73 68 6f 70 30 81  ..U....vipshop0.</span><br><span class="line">7d0246f6b0  9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00  .0...*.H........</span><br><span class="line">7d0246f6c0  03 81 8d 00 30 81 89 02 81 81 00 93 34 83 f8 c0  ....0.......4...</span><br><span class="line">7d0246f6d0  1a 56 74 4a a3 a0 54 73 95 ca c4 22 ea 07 ae a0  .VtJ..Ts...&quot;....</span><br><span class="line">7d0246f6e0  3f 38 45 90 c1 fc bb eb d3 0c 71 39 5e a8 b6 bd  ?8E.......q9^...</span><br><span class="line">7d0246f6f0  1a 1b 04 84 47 49 0e 4b af 36 5a 4b 49 72 6f 35  ....GI.K.6ZKIro5</span><br><span class="line">7d0246f700  4e 57 96 35 f5 40 7e 63 86 57 49 2f 6c af 66 5c  NW.5.@~c.WI/l.f\</span><br><span class="line">7d0246f710  27 18 11 8c cc ba d9 2f 1f fc ab 62 3c c7 ca 9e  &#x27;....../...b&lt;...</span><br><span class="line">7d0246f720  a8 ca 9a d5 8c 47 ab 21 05 ba 7c 7c 6d 6f fe 46  .....G.!..||mo.F</span><br><span class="line">7d0246f730  6d 7e 94 06 bb f0 28 cb 9b b5 43 3a 74 cb 85 47  m~....(...C:t..G</span><br><span class="line">7d0246f740  d1 b6 de de f8 84 56 a1 67 9d 3d 02 03 01 00 01  ......V.g.=.....</span><br><span class="line">7d0246f750  30 0d 06 09 2a 86 48 86 f7 0d 01 01 05 05 00 03  0...*.H.........</span><br><span class="line">7d0246f760  81 81 00 17 fd cc f7 dd 2f 1a 42 80 92 89 a2 15  ......../.B.....</span><br><span class="line">7d0246f770  9b 64 aa 5a b0 57 91 35 88 18 37 74 3b ca 21 18  .d.Z.W.5..7t;.!.</span><br><span class="line">7d0246f780  0b f3 30 50 75 4b b8 a8 44 90 02 c6 07 5e b6 d7  ..0PuK..D....^..</span><br><span class="line">7d0246f790  1a 65 80 06 a6 b6 00 94 c1 69 f0 77 fb 06 3b 93  .e.......i.w..;.</span><br><span class="line">7d0246f7a0  91 64 d1 64 e6 70 4a ae a1 14 c1 fa ed b4 eb fc  .d.d.pJ.........</span><br><span class="line">7d0246f7b0  25 db ca 96 21 a5 58 d2 8b 87 1c 72 7f ff b6 0e  %...!.X....r....</span><br><span class="line">7d0246f7c0  c7 40 e8 64 01 53 e8 e9 4d a9 da 7b 09 9e 30 82  .@.d.S..M..&#123;..0.</span><br><span class="line">7d0246f7d0  c3 77 e4 6d 2d 4e 9c 4a 25 8a b2 54 99 d1 da 85  .w.m-N.J%..T....</span><br><span class="line">7d0246f7e0  5b 14 ca                                         [..</span><br><span class="line">ret_arg3: 0x263</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea9c80  31 65 64 35 36 32 65 31 65 39 30 62 32 33 61 65  1ed562e1e90b23ae</span><br><span class="line">7cd7ea9c90  33 66 39 61 34 30 66 38 62 32 61 36 35 33 38 32  3f9a40f8b2a65382</span><br><span class="line">7cd7ea9ca0  62 39 35 61 34 37 35 32 00 00 00 00 00 00 00 00  b95a4752........</span><br><span class="line">7cd7ea9cb0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cc0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cd0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea9c80  31 65 64 35 36 32 65 31 65 39 30 62 32 33 61 65  1ed562e1e90b23ae</span><br><span class="line">7cd7ea9c90  33 66 39 61 34 30 66 38 62 32 61 36 35 33 38 32  3f9a40f8b2a65382</span><br><span class="line">7cd7ea9ca0  62 39 35 61 34 37 35 32 00 00 00 00 00 00 00 00  b95a4752........</span><br><span class="line">7cd7ea9cb0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cc0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cd0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9ce0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d02424b30  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7d02424b40  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7d02424b50  61 70 69 5f 6b 65 79 3d 62 69 6c 65 74 6f 6e 26  api_key=bileton&amp;</span><br><span class="line">7d02424b60  61 70 70 5f 6e 61 6d 65 3d 73 68 6f 70 5f 61 6e  app_name=shop_an</span><br><span class="line">7d02424b70  64 72 6f 69 64                                   droid</span><br><span class="line">arg3: 0x45</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a10  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d02424b30  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7d02424b40  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7d02424b50  61 70 69 5f 6b 65 79 3d 62 69 6c 65 74 6f 6e 26  api_key=bileton&amp;</span><br><span class="line">7d02424b60  61 70 70 5f 6e 61 6d 65 3d 73 68 6f 70 5f 61 6e  app_name=shop_an</span><br><span class="line">7d02424b70  64 72 6f 69 64                                   droid</span><br><span class="line">ret_arg3: 0x45</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9a00  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9a10  35 37 39 31 32 30 62 64 00 00 00 00 00 00 00 00  579120bd........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9a00  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9a10  35 37 39 31 32 30 62 64 00 00 00 00 00 00 00 00  579120bd........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea98f0  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7cd7ea9900  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7cd7ea9910  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9920  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9930  35 37 39 31 32 30 62 64                          579120bd</span><br><span class="line">arg3: 0x48</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a10  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea98f0  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7cd7ea9900  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7cd7ea9910  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9920  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9930  35 37 39 31 32 30 62 64                          579120bd</span><br><span class="line">ret_arg3: 0x48</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  63 39 31 34 63 39 64 64 32 62 38 36 32 61 37 34  c914c9dd2b862a74</span><br><span class="line">7cd7ea9a00  63 35 65 39 31 61 63 31 65 36 62 37 39 33 32 38  c5e91ac1e6b79328</span><br><span class="line">7cd7ea9a10  36 62 33 63 31 61 63 32 00 00 00 00 00 00 00 00  6b3c1ac2........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a50  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  63 39 31 34 63 39 64 64 32 62 38 36 32 61 37 34  c914c9dd2b862a74</span><br><span class="line">7cd7ea9a00  63 35 65 39 31 61 63 31 65 36 62 37 39 33 32 38  c5e91ac1e6b79328</span><br><span class="line">7cd7ea9a10  36 62 33 63 31 61 63 32 00 00 00 00 00 00 00 00  6b3c1ac2........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a50  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a60  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">call gsNav result: c914c9dd2b862a74c5e91ac1e6b793286b3c1ac2</span><br><span class="line">----call gsNav over----</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现当主动调用gsNav函数的时候，主动调用了三次getByteHash方法，而第一次调用getByteHash方法时的入参和返回值都没有找到相关的信息，在IDA里查看getByteHash交叉引用，发现</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/22.jpg"></p>
<p>发现在其他函数里也调用了getByteHash函数，溯源一下，最后找到是在<code>Utils_ima</code>方法里调用的，并不影响<code>Function_gs</code>函数调用的<code>getByteHash</code>。</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/23.jpg"></p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>从Functions_gs函数里可以看出来，getByteHash函数被调用了两次，这个函数是标准SHA1算法，那么要分析的话就要拿连续的两个hook结果，从hook结果来看，getByteHash传入的第三个参数是map，但是它的开头加盐了，<code>aee4c425dbb2288b80c71347cc37d04b</code>，这个盐的值是固定的</p>
<p>如下是我对Functions_gs函数变量重命名后的关键代码</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/20.jpg"></p>
<p>SaltMap是加盐后的Map的值，经过第一次SHA1签名之后，得到ByteHash，然后在ByteHash前面加盐，再一次进行SHA1签名，得到最终的<code>api_sign</code></p>
<h2 id="验证一下"><a href="#验证一下" class="headerlink" title="验证一下"></a>验证一下</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"> </span><br><span class="line">mapdata = <span class="string">&#x27;activity=active_te_dynamic_res&amp;activity_endtime=null&amp;activity_propety=&#123;&quot;activity_name&quot;:&quot;&quot;,&quot;depend_status&quot;:-1,&quot;module&quot;:&quot;smartRoute&quot;,&quot;match&quot;:1,&quot;is_debug&quot;:&quot;0&quot;,&quot;apk_type&quot;:&quot;1&quot;,&quot;scene&quot;:&quot;api&quot;,&quot;is_main_process&quot;:1,&quot;fail_back&quot;:0,&quot;event_id&quot;:0,&quot;has_module&quot;:0,&quot;remove_so&quot;:&quot;0&quot;,&quot;action&quot;:&quot;res_scene&quot;,&quot;status&quot;:0&#125;&amp;activity_starttime=1734847371668&amp;app_name=shop_android&amp;app_version=9.39.4&amp;channel=1&amp;deeplink_cps=&amp;face_flag=0_1&amp;fdc_area_id=104101113&amp;local_time=1734847371668&amp;location=104101&amp;mid=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad&amp;other_cps=&amp;page_id=page_te_loding_activity_1734847371401&amp;repeat=0&amp;service=mobile.activityinfo.logger&amp;session_id=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734847371335&amp;skey=6692c461c3810ab150c9a980d0c275ec&amp;status=&amp;status_descrit=null&amp;user_class=A1&amp;user_group=20460_【23年新客首页】安卓-5.23-[快应用-独立首页]-[顶部导航-测试-18]&amp;user_label=3105,310505&amp;userid=null&amp;vipruid=null&amp;warehouse=VIP_HZ&#x27;</span></span><br><span class="line"></span><br><span class="line">Salt = <span class="string">&quot;aee4c425dbb2288b80c71347cc37d04b&quot;</span></span><br><span class="line">SaltMap = Salt+mapdata</span><br><span class="line">cipher1 = hashlib.sha1()</span><br><span class="line">cipher1.update(SaltMap.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">ByteHash = cipher1.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(ByteHash)</span><br><span class="line">SecondEnc = Salt+ByteHash</span><br><span class="line">cipher2 = hashlib.sha1()</span><br><span class="line">cipher2.update(SecondEnc.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">api_sign = cipher2.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(api_sign)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">21c4c11c50637d4316ecc1bbf7e6a4abdf6fbe61</span><br><span class="line">237f2dfb34d8846ca7f11071583fb3af5f98b9fe</span><br></pre></td></tr></table></figure>

<p>还原完成</p>
<h1 id="设备注册接口复现"><a href="#设备注册接口复现" class="headerlink" title="设备注册接口复现"></a>设备注册接口复现</h1><p>这次我们可以用自己生成的api_sign来进行设备注册</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">def <span class="title function_">sha1</span>(data):</span><br><span class="line">    cipher = hashlib.<span class="title function_">sha1</span>()</span><br><span class="line">    cipher.<span class="title function_">update</span>(data)</span><br><span class="line">    <span class="keyword">return</span> cipher.<span class="title function_">hexdigest</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">device_token = <span class="title function_">str</span>(uuid.<span class="title function_">uuid4</span>())</span><br><span class="line"></span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>:<span class="string">&quot;achievo_ad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>:<span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_token&quot;</span>:device_token,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>:<span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manufacturer&quot;</span>:<span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device&quot;</span>:<span class="string">&quot;Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os_version&quot;</span>:<span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel&quot;</span>:<span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipruid&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regPlat&quot;</span>:<span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regid&quot;</span>:<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>:<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>:<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mp.appvipshop.com/apns/device_reg&quot;</span></span><br><span class="line"></span><br><span class="line">mapdata = <span class="string">&quot;&amp;&quot;</span>.<span class="title function_">join</span>([key+<span class="string">&quot;=&quot;</span>+value <span class="keyword">for</span> key,value <span class="keyword">in</span> parameters.<span class="title function_">items</span>()])</span><br><span class="line">salt = <span class="string">&quot;aee4c425dbb2288b80c71347cc37d04b&quot;</span></span><br><span class="line">onesha1 = <span class="title function_">sha1</span>((salt+mapdata).<span class="title function_">encode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">apisign = <span class="title function_">sha1</span>((salt+onesha1).<span class="title function_">encode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;okhttp/4.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;authorization&quot;</span>:<span class="string">&quot;OAuth api_sign=&quot;</span>+apisign,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.<span class="title function_">get</span>(url,headers=headers,params=parameters)</span><br><span class="line"><span class="title function_">print</span>(response.<span class="property">status_code</span>)</span><br><span class="line"><span class="title function_">print</span>(response.<span class="property">text</span>)</span><br></pre></td></tr></table></figure>

<h1 id="搜索接口逆向"><a href="#搜索接口逆向" class="headerlink" title="搜索接口逆向"></a>搜索接口逆向</h1><h2 id="搜索接口抓包"><a href="#搜索接口抓包" class="headerlink" title="搜索接口抓包"></a>搜索接口抓包</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/21.jpg"></p>
<h2 id="逆向还原"><a href="#逆向还原" class="headerlink" title="逆向还原"></a>逆向还原</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha1</span>(<span class="params">data</span>):</span><br><span class="line">    cipher = hashlib.sha1()</span><br><span class="line">    cipher.update(data)</span><br><span class="line">    <span class="keyword">return</span> cipher.hexdigest()</span><br><span class="line"></span><br><span class="line">keyword = <span class="built_in">input</span>(<span class="string">&quot;input keyword:&quot;</span>)</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mapi.appvipshop.com/vips-mobile/rest/shopping/search/product/list/v1&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;api_key&quot;</span>: <span class="string">&quot;23e7f28019e8407b98b84cd05b5aef2c&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>: <span class="string">&quot;shop_android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>: <span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;bigSaleTagIds&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;brandIds&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;brandStoreSns&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;categoryId&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channelId&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel_flag&quot;</span>: <span class="string">&quot;0_1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;clickFrom&quot;</span>: <span class="string">&quot;userword&quot;</span>,</span><br><span class="line">    <span class="string">&quot;client&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;client_type&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;couponIds&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;darkmode&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;deeplink_cps&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_model&quot;</span>: <span class="string">&quot;Google Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;did&quot;</span>: <span class="string">&quot;0.0.7dd2447b686b5292535eeee5df76af4e.e30722&quot;</span>,</span><br><span class="line">    <span class="string">&quot;elder&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;evgid&quot;</span>: <span class="string">&quot;MEPeuS28WvKWWBaORXRayvPD91hpo6rtPhqtYlf9h/sqV/qXMrLitm9X/TxB0xIU0R0HnbOuRkt494w2LedGeuzIt0jR6xdfSfROjGrf92s=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;extParams&quot;</span>: <span class="string">&#x27;&#123;&quot;priceVer&quot;:&quot;2&quot;,&quot;video_playable&quot;:&quot;1&quot;,&quot;mclabel&quot;:&quot;1&quot;,&quot;cmpStyle&quot;:&quot;1&quot;,&quot;statusVer&quot;:&quot;2&quot;,&quot;ic2label&quot;:&quot;1&quot;,&quot;video&quot;:&quot;2&quot;,&quot;uiVer&quot;:&quot;2&quot;,&quot;preheatTipsVer&quot;:&quot;4&quot;,&quot;floatwin&quot;:&quot;1&quot;,&quot;superHot&quot;:&quot;1&quot;,&quot;exclusivePrice&quot;:&quot;1&quot;,&quot;router&quot;:&quot;1&quot;,&quot;coupons&quot;:&quot;4&quot;,&quot;needVideoExplain&quot;:&quot;1&quot;,&quot;rank&quot;:&quot;2&quot;,&quot;needVideoGive&quot;:&quot;1&quot;,&quot;attr&quot;:&quot;2&quot;,&quot;bigBrand&quot;:&quot;2&quot;,&quot;couponVer&quot;:&quot;v2&quot;,&quot;videoExplainUrl&quot;:&quot;1&quot;,&quot;live&quot;:&quot;1&quot;,&quot;sellpoint&quot;:&quot;1&quot;,&quot;reco&quot;:&quot;1&quot;,&quot;vreimg&quot;:&quot;1&quot;,&quot;search_tag&quot;:&quot;2&quot;,&quot;tpl&quot;:&quot;1&quot;,&quot;ads&quot;:&quot;2&quot;,&quot;stdSizeVids&quot;:&quot;&quot;,&quot;labelVer&quot;:&quot;2&quot;,&quot;preheatView&quot;:&quot;1&quot;&#125;&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;fdc_area_id&quot;</span>: <span class="string">&quot;104101113&quot;</span>,</span><br><span class="line">    <span class="string">&quot;functions&quot;</span>: <span class="string">&quot;RTRecomm,flagshipInfo,couponBarV2,lowPriceTabs,discountTabs,feedbackV2,otdAds,zoneCode,slotOp,survey,outfit,aiRealtime,floaterParams,tabGroupV2,bsAndSeason,parallelCall&quot;</span>,</span><br><span class="line">    <span class="string">&quot;harmony_app&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;harmony_os&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;height&quot;</span>: <span class="string">&quot;2028&quot;</span>,</span><br><span class="line">    <span class="string">&quot;isMultiTab&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;is_default_area&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;keyword&quot;</span>: keyword,</span><br><span class="line">    <span class="string">&quot;lastPageProperty&quot;</span>: <span class="string">&quot;&#123;\&quot;isBgToFront\&quot;:\&quot;0\&quot;,\&quot;scene_entry_id\&quot;:\&quot;-99\&quot;,\&quot;refer_page_id\&quot;:\&quot;page_channel_1734917260119\&quot;,\&quot;text\&quot;:\&quot;女童加绒裤子\&quot;,\&quot;module_name\&quot;:\&quot;com.achievo.vipshop.search\&quot;,\&quot;type\&quot;:\&quot;-99\&quot;,\&quot;is_back_page\&quot;:\&quot;0\&quot;&#125;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;maker&quot;</span>: <span class="string">&quot;GOOGLE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mars_cid&quot;</span>: <span class="string">&quot;b3aad8e2-2840-39a5-8b51-e5b1c5b16bad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mobile_channel&quot;</span>: <span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mobile_platform&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;net&quot;</span>: <span class="string">&quot;WIFI&quot;</span>,</span><br><span class="line">    <span class="string">&quot;operator&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os&quot;</span>: <span class="string">&quot;Android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;osv&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;otddid&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;other_cps&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;page_id&quot;</span>: <span class="string">&quot;page_te_globle_classify_search_1734917270854&quot;</span>,</span><br><span class="line">    <span class="string">&quot;phone_brand&quot;</span>: <span class="string">&quot;google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;phone_model&quot;</span>: <span class="string">&quot;pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;priceMax&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;priceMin&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;props&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;province_id&quot;</span>: <span class="string">&quot;104101&quot;</span>,</span><br><span class="line">    <span class="string">&quot;referer&quot;</span>: <span class="string">&quot;com.achievo.vipshop.search.activity.TabSearchProductListActivity&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>: <span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sd_tuijian&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;service_provider&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;session_id&quot;</span>: <span class="string">&quot;b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734917371208&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>: <span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sort&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source&quot;</span>: <span class="string">&quot;app&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source_app&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;standby_id&quot;</span>: <span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sys_version&quot;</span>: <span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tabFields&quot;</span>: <span class="string">&quot;gender,tabs,priceTabs,discountTabs,tabGroupV2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;timestamp&quot;</span>: <span class="string">&quot;1734917303&quot;</span>,</span><br><span class="line">    <span class="string">&quot;union_mark&quot;</span>: <span class="string">&quot;blank&amp;_&amp;blank&amp;_&amp;yro8nr0d:::&amp;_&amp;blank&amp;_&amp;blank&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipService&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>: <span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;width&quot;</span>: <span class="string">&quot;1080&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mapdata = <span class="string">&quot;&amp;&quot;</span>.join([key+<span class="string">&quot;=&quot;</span>+value <span class="keyword">for</span> key,value <span class="keyword">in</span> data.items()])</span><br><span class="line">salt = <span class="string">&quot;aee4c425dbb2288b80c71347cc37d04b&quot;</span></span><br><span class="line">onesha1 = sha1((salt+mapdata).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">apisign = sha1((salt+onesha1).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&quot;authorization&quot;</span>: <span class="string">&quot;OAuth api_sign=&quot;</span>+apisign,</span><br><span class="line">  <span class="string">&quot;x-vip-host&quot;</span>: <span class="string">&quot;mapi.appvipshop.com&quot;</span>,</span><br><span class="line">  <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">  <span class="string">&quot;content-length&quot;</span>: <span class="string">&quot;2886&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accept-encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span>,</span><br><span class="line">  <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;okhttp/4.9.1&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url=url,data=data,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%94%AF%E5%93%81%E4%BC%9A/" rel="tag"><svg t="1732789072752" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4858" width="15" height="15"><path d="M229.443715 343.118259l565.172804 0 0 410.010794c0 37.525595-30.237317 67.762912-67.040108 67.762912l-46.319715 0 0 139.742183c0 35.116247-28.249605 63.365852-63.305618 63.365852-35.116247 0-63.546553-28.309839-63.546553-63.365852l0-139.742183-84.809049 0 0 139.742183c0 35.056013-28.430306 63.365852-63.546553 63.365852-34.393443 0-62.763515-28.309839-62.763515-63.365852l-0.542103-139.742183-45.596911 0c-37.465361 0-67.702678-30.177084-67.702678-67.762912l0-410.010794zM141.984383 331.432921c-35.056013 0-63.426086 28.370073-63.426086 62.763515l0 264.787344c0 35.116247 28.370073 63.365852 63.426086 63.365852s62.763515-28.309839 62.763515-63.365852l0-264.787344c0-34.393443-28.189371-62.763515-62.763515-62.763515zM796.42353 320.952257l-569.449397 0c0-97.879762 58.547156-182.869512 145.343917-227.141282l-43.7899-80.59269c-2.469582-4.336826-1.264908-9.878327 3.071919-12.347908 4.276593-1.867245 9.878327-0.662571 12.347908 3.734489l44.271769 81.255261c37.646062-16.684735 79.508484-25.900491 123.780253-25.900491s86.134191 9.215756 123.780253 25.840257l44.271769-81.255261c2.469582-4.336826 8.071316-5.5415 12.347908-3.734489 4.336826 2.469582 5.5415 8.011082 3.071919 12.347908l-43.7899 80.59269c86.254658 44.332003 144.74158 129.321753 144.74158 227.201515zM406.048922 194.160319c0-12.950245-10.42043-24.033246-23.912779-24.033246-13.010479 0-23.430909 11.083001-23.430909 24.033246 0 12.890012 10.42043 23.973012 23.430909 23.973012 13.492349 0.060234 23.912779-11.022767 23.912779-23.973012zM665.294766 194.160319c0-12.950245-10.42043-24.033246-23.430909-24.033246-13.552582 0-23.912779 11.083001-23.912779 24.033246 0 12.890012 10.42043 23.973012 23.912779 23.973012 13.010479 0.060234 23.430909-11.022767 23.430909-23.973012zM882.015617 331.432921c-34.51391 0-62.763515 27.707502-62.763515 62.763515l0 264.787344c0 35.116247 28.249605 63.365852 62.763515 63.365852 35.056013 0 63.426086-28.309839 63.426086-63.365852l0-264.787344c-0.060234-35.056013-28.370073-62.763515-63.426086-62.763515z" fill="#000000" p-id="4859"></path></svg> 唯品会</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2024/12/22/Flask/" rel="prev" title="Flask">
      <i class="fa fa-chevron-left"></i> Flask
    </a></div>
      <div class="post-nav-item">
    <a href="/2024/12/23/HTML/" rel="next" title="HTML">
      HTML <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#App%E4%BF%A1%E6%81%AF"><span class="nav-number">1.</span> <span class="nav-text">App信息</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C"><span class="nav-number">2.</span> <span class="nav-text">设备注册</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#of"><span class="nav-number">2.1.</span> <span class="nav-text">of</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#l"><span class="nav-number">2.2.</span> <span class="nav-text">l</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#a"><span class="nav-number">2.3.</span> <span class="nav-text">a</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#getMid"><span class="nav-number">2.4.</span> <span class="nav-text">getMid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%BEMidProvider%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9E%E7%8E%B0%E7%B1%BB"><span class="nav-number">2.5.</span> <span class="nav-text">找MidProvider接口的实现类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VipMidManager"><span class="nav-number">2.6.</span> <span class="nav-text">VipMidManager</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90uuid"><span class="nav-number">2.7.</span> <span class="nav-text">生成uuid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E9%80%86%E5%90%91"><span class="nav-number">2.8.</span> <span class="nav-text">设备注册逆向</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8F%82%E6%95%B0api-sign"><span class="nav-number">3.</span> <span class="nav-text">参数api_sign</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#jadx%E5%8F%8D%E7%BC%96%E8%AF%91"><span class="nav-number">4.</span> <span class="nav-text">jadx反编译</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#getApiSign"><span class="nav-number">4.1.</span> <span class="nav-text">getApiSign</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#apisign"><span class="nav-number">4.2.</span> <span class="nav-text">apisign</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#hook"><span class="nav-number">4.2.1.</span> <span class="nav-text">hook</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hook%E7%BB%93%E6%9E%9C"><span class="nav-number">4.2.2.</span> <span class="nav-text">hook结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#getMapParamsSign"><span class="nav-number">4.3.</span> <span class="nav-text">getMapParamsSign</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#getSignHash"><span class="nav-number">4.4.</span> <span class="nav-text">getSignHash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gs"><span class="nav-number">4.5.</span> <span class="nav-text">gs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#initInstance"><span class="nav-number">4.6.</span> <span class="nav-text">initInstance</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KeyInfo-gs"><span class="nav-number">4.7.</span> <span class="nav-text">KeyInfo.gs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gsNav"><span class="nav-number">4.8.</span> <span class="nav-text">gsNav</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#so"><span class="nav-number">4.9.</span> <span class="nav-text">so</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hook-gsNav"><span class="nav-number">4.10.</span> <span class="nav-text">hook gsNav</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%86%E6%9E%90so"><span class="nav-number">5.</span> <span class="nav-text">分析so</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Java-com-vip-vcsp-KeyInfo-gsNav"><span class="nav-number">5.1.</span> <span class="nav-text">Java_com_vip_vcsp_KeyInfo_gsNav</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Functions-gs"><span class="nav-number">5.2.</span> <span class="nav-text">Functions_gs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#getByteHash"><span class="nav-number">5.3.</span> <span class="nav-text">getByteHash</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#hook-getByteHash"><span class="nav-number">5.4.</span> <span class="nav-text">hook getByteHash</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%B8%80%E4%B8%AAhook%E7%BB%93%E6%9E%9C"><span class="nav-number">5.4.1.</span> <span class="nav-text">示例一个hook结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%87%E7%BA%A7%E4%B8%80%E4%B8%8B%E8%84%9A%E6%9C%AC%E7%BB%A7%E7%BB%ADhook"><span class="nav-number">5.4.2.</span> <span class="nav-text">升级一下脚本继续hook</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%BB%E5%8A%A8%E8%B0%83%E7%94%A8gsNav%E6%96%B9%E6%B3%95%EF%BC%8C%E6%9D%A5%E8%A7%82%E5%AF%9FgetByteHash%E7%9A%84%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C"><span class="nav-number">5.4.3.</span> <span class="nav-text">主动调用gsNav方法，来观察getByteHash的输出结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA"><span class="nav-number">5.4.4.</span> <span class="nav-text">输出</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E6%9E%90"><span class="nav-number">5.5.</span> <span class="nav-text">分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81%E4%B8%80%E4%B8%8B"><span class="nav-number">5.6.</span> <span class="nav-text">验证一下</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E6%8E%A5%E5%8F%A3%E5%A4%8D%E7%8E%B0"><span class="nav-number">6.</span> <span class="nav-text">设备注册接口复现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91"><span class="nav-number">7.</span> <span class="nav-text">搜索接口逆向</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E6%8A%93%E5%8C%85"><span class="nav-number">7.1.</span> <span class="nav-text">搜索接口抓包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%86%E5%90%91%E8%BF%98%E5%8E%9F"><span class="nav-number">7.2.</span> <span class="nav-text">逆向还原</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bileton"
      src="/images/android.svg">
  <p class="site-author-name" itemprop="name">Bileton</p>
  <div class="site-description" itemprop="description">路漫漫其修远夕！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">72</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bileton</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">522k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">7:55</span>
</div>


<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("01/01/2024 00:00:00"); //修改为你的网站开始运行的时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
