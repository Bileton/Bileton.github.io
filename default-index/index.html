<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/wxlog.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/wxlog.jpg">
  <link rel="mask-icon" href="/images/wxlog.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="路漫漫其修远夕！">
<meta property="og:type" content="website">
<meta property="og:title" content="白乐天">
<meta property="og:url" content="http://example.com/default-index/index.html">
<meta property="og:site_name" content="白乐天">
<meta property="og:description" content="路漫漫其修远夕！">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Bileton">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/default-index/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>白乐天</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">白乐天</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">道阻且长，行则将至。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">96</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">36</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">104</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/" class="post-title-link" itemprop="url">考研数学</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-04-08 00:26:35" itemprop="dateCreated datePublished" datetime="2025-04-08T00:26:35+08:00">2025-04-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-04-17 16:13:38" itemprop="dateModified" datetime="2025-04-17T16:13:38+08:00">2025-04-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%80%83%E7%A0%94/" itemprop="url" rel="index"><span itemprop="name">考研</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础？"><a href="#基础？" class="headerlink" title="基础？"></a>基础？</h1><h2 id="幂函数"><a href="#幂函数" class="headerlink" title="幂函数"></a>幂函数</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/47.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/48.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/49.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/50.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/51.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/52.jpg"></p>
<p><strong>幂函数转根号</strong></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/77.jpg"></p>
<h2 id="指数函数"><a href="#指数函数" class="headerlink" title="指数函数"></a>指数函数</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/53.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/54.jpg"></p>
<h2 id="对数函数"><a href="#对数函数" class="headerlink" title="对数函数"></a>对数函数</h2><p> <img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/57.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/58.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/59.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/60.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/61.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/62.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/63.jpg"></p>
<h3 id="图像"><a href="#图像" class="headerlink" title="图像"></a>图像</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/55.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/56.jpg"></p>
<h2 id="三角函数"><a href="#三角函数" class="headerlink" title="三角函数"></a>三角函数</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/64.jpg"></p>
<h3 id="三角函数特殊角值"><a href="#三角函数特殊角值" class="headerlink" title="三角函数特殊角值"></a>三角函数特殊角值</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/41.jpg"></p>
<h3 id="三角函数图像及性质"><a href="#三角函数图像及性质" class="headerlink" title="三角函数图像及性质"></a>三角函数图像及性质</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/42.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/65.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/66.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/67.jpg"></p>
<h3 id="反三角函数图像及性质"><a href="#反三角函数图像及性质" class="headerlink" title="反三角函数图像及性质"></a>反三角函数图像及性质</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/43.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/44.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/45.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/46.jpg"></p>
<h2 id="预备知识"><a href="#预备知识" class="headerlink" title="预备知识"></a>预备知识</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/68.jpg"></p>
<h3 id="奇变偶不变，符号看象限"><a href="#奇变偶不变，符号看象限" class="headerlink" title="奇变偶不变，符号看象限"></a>奇变偶不变，符号看象限</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/74.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/69.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/70.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/71.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/72.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/73.jpg"></p>
<h3 id="三角公式"><a href="#三角公式" class="headerlink" title="三角公式"></a>三角公式</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/75.jpg"></p>
<h3 id="判断函数奇偶性"><a href="#判断函数奇偶性" class="headerlink" title="判断函数奇偶性"></a>判断函数奇偶性</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/76.jpg"></p>
<h1 id="高数"><a href="#高数" class="headerlink" title="高数"></a>高数</h1><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/1.jpg"></p>
<p><strong>微积分的主要研究内容</strong></p>
<p>事物运动中的数量变化规律</p>
<p><strong>两种变化</strong></p>
<p>均匀变化</p>
<p>非均匀变化</p>
<p><strong>两个侧面</strong></p>
<p>微观（局部）</p>
<p>宏观（整体）</p>
<p><strong>微积分的主要研究对象</strong></p>
<p>函数y&#x3D;f(x) (a&lt;&#x3D;x&lt;&#x3D;b)的变化规律</p>
<p>微观（变化率）</p>
<p>宏观（变化量）</p>
<p><strong>思想方法</strong></p>
<p>利用已知求未知</p>
<p>通过均匀变化求非均匀变化</p>
<p>局部均匀化求近似，利用极限得精确</p>
<p>微分和积分分别是处理均匀量的商和积在处理非均匀量中的发展</p>
<h1 id="函数与极限"><a href="#函数与极限" class="headerlink" title="函数与极限"></a>函数与极限</h1><h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>给定两个非空集合 X 和 Y，<strong>函数</strong>（或映射） f 是一种规则，使得对于集合 XXX 中的任一元素 xxx ，都存在唯一一个元素 y∈Y与之对应，这个对应关系记作y&#x3D;f(x).</p>
<ul>
<li><strong>定义域</strong>：<strong>（Domain）</strong>：所有可以作为函数 f 输入的 x 的集合，即 X。</li>
<li><strong>值域（Range 或 Image）</strong>：函数f实际取值的集合</li>
<li><strong>对应关系</strong>：对于每个 x∈X，存在唯一的 y∈Y使得 f(x)&#x3D;y。</li>
</ul>
<p>通过定义域和对应关系可以确定一个函数。</p>
<p><strong>举例常见函数</strong></p>
<p>绝对值函数</p>
<p>符号函数</p>
<p>取整函数</p>
<p><strong>函数的几种特性</strong></p>
<p>有界性</p>
<p>单调性</p>
<p>奇偶性</p>
<p>周期性</p>
<h2 id="反函数与复合函数"><a href="#反函数与复合函数" class="headerlink" title="反函数与复合函数"></a>反函数与复合函数</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/2.jpg"></p>
<p>原函数与它的反函数关于y&#x3D;x对称</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/3.jpg"></p>
<h2 id="函数的运算"><a href="#函数的运算" class="headerlink" title="函数的运算"></a>函数的运算</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/4.jpg"></p>
<h2 id="初等函数"><a href="#初等函数" class="headerlink" title="初等函数"></a>初等函数</h2><p>将幂函数，指数函数，对数函数，三角函数，反三角函数统称为初等函数。</p>
<h3 id="幂函数-1"><a href="#幂函数-1" class="headerlink" title="幂函数"></a>幂函数</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/6.jpg"></p>
<blockquote>
<p>x是自变量</p>
<p>a是一个常数（可以是正数、负数、分数或整数）。</p>
<p>当 a 为正整数时，幂函数就是多项式中的单项式；当 a 取非整数值或负值时，其定义域和性质会有所不同。</p>
</blockquote>
<p><strong>定义域与奇偶性</strong></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/7.jpg"></p>
<p><strong>图像</strong></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/8.jpg"></p>
<h3 id="指数函数-1"><a href="#指数函数-1" class="headerlink" title="指数函数"></a>指数函数</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/9.jpg"></p>
<blockquote>
<p>底数 a 是常数，满足 a&gt;0 且 a≠1；</p>
<p>指数部分是变量 x。</p>
<p><strong>特别说明：</strong> 当底数 a&#x3D;e（自然常数，约等于2.71828）时，函数 f(x)&#x3D;e^x 被称为自然指数函数，具有许多优美的性质。</p>
</blockquote>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/10.jpg"></p>
<p>图像特点</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/11.jpg"></p>
<h3 id="对数函数-1"><a href="#对数函数-1" class="headerlink" title="对数函数"></a>对数函数</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/12.jpg"></p>
<blockquote>
<p><strong>底数 a 必须满足</strong>：a&gt;0 且 a≠1；</p>
<p><strong>变量 x 必须满足</strong>：x&gt;0。</p>
</blockquote>
<p>对数函数表示“a 的什么幂等于 x”，即满足</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/13.jpg"></p>
<p>当底数取自然常数 e 时，函数写作</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/14.jpg"></p>
<p><strong>基本性质</strong></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/15.jpg"></p>
<p><strong>图像特点</strong></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/16.jpg"></p>
<h3 id="三角函数-1"><a href="#三角函数-1" class="headerlink" title="三角函数"></a>三角函数</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/17.jpg"></p>
<h3 id="反三角函数"><a href="#反三角函数" class="headerlink" title="反三角函数"></a>反三角函数</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/18.jpg"></p>
<h2 id="数列极限的定义"><a href="#数列极限的定义" class="headerlink" title="数列极限的定义"></a>数列极限的定义</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/5.jpg"></p>
<p>一个数列不收敛，就说它没有极限，或者说它是发散的</p>
<h2 id="收敛数列的性质"><a href="#收敛数列的性质" class="headerlink" title="收敛数列的性质"></a>收敛数列的性质</h2><p>唯一性</p>
<p>有界性</p>
<p>保号性</p>
<p>收敛数列与其子数列之间的关系</p>
<p>如果一个数列 {a_n}收敛于极限 A，那么它的任意一个子数列也收敛，且极限也为 A。</p>
<h2 id="函数极限"><a href="#函数极限" class="headerlink" title="函数极限"></a>函数极限</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/19.jpg"></p>
<p><strong>单侧极限</strong></p>
<p><strong>无穷极限</strong></p>
<h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>唯一性</p>
<p>有界性</p>
<p>保号性</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/20.jpg"></p>
<h2 id="无穷"><a href="#无穷" class="headerlink" title="无穷"></a>无穷</h2><h3 id="无穷小"><a href="#无穷小" class="headerlink" title="无穷小"></a>无穷小</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/21.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/24.jpg"></p>
<h3 id="无穷大"><a href="#无穷大" class="headerlink" title="无穷大"></a>无穷大</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/22.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/23.jpg"></p>
<h2 id="极限的运算法则"><a href="#极限的运算法则" class="headerlink" title="极限的运算法则"></a>极限的运算法则</h2><p>定理1：两个无穷小的和是无穷小</p>
<p>定理2：有界函数与无穷小的乘积是无穷小</p>
<p>推论1：常数与无穷小的乘积是无穷小</p>
<p>推论2：有限个无穷小的和也是无穷小</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/25.jpg"></p>
<blockquote>
<p>无穷小的运算法则</p>
<p>极限四则运算法则（计算商的时候分母不能为0）</p>
<p>复合函数极限运算法则（内层函数不能为0）</p>
</blockquote>
<p>求函数极限的方法</p>
<blockquote>
<p>分式函数求极限的求法</p>
<p>代入法</p>
<p>零比零型约去分母0因子</p>
<p>无穷比无穷型，分子分母同除以最高次幂</p>
<p>复合函数求极限</p>
<p>设中间变量</p>
</blockquote>
<h3 id="零比零型极限问题"><a href="#零比零型极限问题" class="headerlink" title="零比零型极限问题"></a>零比零型极限问题</h3><p>利用平方差公式，立方差公式，因式分解来提取、消去零因子。</p>
<h3 id="无穷比无穷型"><a href="#无穷比无穷型" class="headerlink" title="无穷比无穷型"></a>无穷比无穷型</h3><blockquote>
<p>找出分子、分母的最高次项</p>
<p>所有项都除以最高次项（一般是分母的最高次幂）</p>
</blockquote>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/78.jpg"></p>
<h2 id="极限存在法则及两个重要极限"><a href="#极限存在法则及两个重要极限" class="headerlink" title="极限存在法则及两个重要极限"></a>极限存在法则及两个重要极限</h2><h3 id="夹逼准则"><a href="#夹逼准则" class="headerlink" title="夹逼准则"></a>夹逼准则</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/26.jpg"></p>
<h3 id="单调有界函数必有极限"><a href="#单调有界函数必有极限" class="headerlink" title="单调有界函数必有极限"></a>单调有界函数必有极限</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/27.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/81.jpg"></p>
<h3 id="两个重要极限"><a href="#两个重要极限" class="headerlink" title="两个重要极限"></a>两个重要极限</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/28.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/80.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/79.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/83.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/84.jpg"></p>
<h2 id="无穷小的比较"><a href="#无穷小的比较" class="headerlink" title="无穷小的比较"></a>无穷小的比较</h2><p>两个无穷小的和差积仍然是无穷小，但是对于商会有不同的情况。</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/29.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/30.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/31.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/32.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/33.jpg"></p>
<h3 id="等价无穷小的代换"><a href="#等价无穷小的代换" class="headerlink" title="等价无穷小的代换"></a>等价无穷小的代换</h3><p>代换原则：乘除关系可以代换</p>
<h3 id="常见的等价无穷小"><a href="#常见的等价无穷小" class="headerlink" title="常见的等价无穷小"></a>常见的等价无穷小</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/34.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/35.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/82.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/86.jpg"></p>
<h2 id="函数的连续性与间断点"><a href="#函数的连续性与间断点" class="headerlink" title="函数的连续性与间断点"></a>函数的连续性与间断点</h2><h3 id="连续性"><a href="#连续性" class="headerlink" title="连续性"></a>连续性</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/36.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/37.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/38.jpg"></p>
<h3 id="间断点"><a href="#间断点" class="headerlink" title="间断点"></a>间断点</h3><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/39.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/40.jpg"></p>
<h2 id="求极限的步骤"><a href="#求极限的步骤" class="headerlink" title="求极限的步骤"></a>求极限的步骤</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/85.jpg"></p>
<h2 id="连续函数及其性质"><a href="#连续函数及其性质" class="headerlink" title="连续函数及其性质"></a>连续函数及其性质</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/87.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/88.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/89.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/90.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/91.jpg"></p>
<h2 id="闭区间上连续函数的性质"><a href="#闭区间上连续函数的性质" class="headerlink" title="闭区间上连续函数的性质"></a>闭区间上连续函数的性质</h2><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/92.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/93.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/94.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/95.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/96.jpg"></p>
<h1 id="导数与微分"><a href="#导数与微分" class="headerlink" title="导数与微分"></a>导数与微分</h1><p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/97.jpg"></p>
<h2 id="费马引理"><a href="#费马引理" class="headerlink" title="费马引理"></a>费马引理</h2><p>证明过程</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/99.jpg"></p>
<h2 id="罗尔定理"><a href="#罗尔定理" class="headerlink" title="罗尔定理"></a>罗尔定理</h2><p>证明过程</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/98.jpg"></p>
<h2 id="拉格朗日中值定理"><a href="#拉格朗日中值定理" class="headerlink" title="拉格朗日中值定理"></a>拉格朗日中值定理</h2><p><strong>推论</strong></p>
<p>导数恒为零的函数必为常数函数</p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/100.jpg"></p>
<p><img src="/2025/04/08/%E8%80%83%E7%A0%94%E6%95%B0%E5%AD%A6/101.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/08/%E8%80%83%E7%A0%94%E8%8B%B1%E8%AF%AD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/08/%E8%80%83%E7%A0%94%E8%8B%B1%E8%AF%AD/" class="post-title-link" itemprop="url">考研英语</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-04-08 00:26:14" itemprop="dateCreated datePublished" datetime="2025-04-08T00:26:14+08:00">2025-04-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-04-18 15:30:59" itemprop="dateModified" datetime="2025-04-18T15:30:59+08:00">2025-04-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%80%83%E7%A0%94/" itemprop="url" rel="index"><span itemprop="name">考研</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>9.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>9 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="单词"><a href="#单词" class="headerlink" title="单词"></a>单词</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><h3 id="acquire"><a href="#acquire" class="headerlink" title="acquire"></a>acquire</h3><p>v.获得，得到</p>
<blockquote>
<p>The painting was acquired in 1921.</p>
<p>这幅画是在1921年获得的。</p>
</blockquote>
<h3 id="action"><a href="#action" class="headerlink" title="action"></a>action</h3><p>n.行为，行动；功能，作用</p>
<blockquote>
<p>Actions speak louder than words.</p>
<p>行动胜于雄辩。</p>
<p>Prior knowledge and interests influence the subsequent actions we take.</p>
<p>先前的知识和兴趣会影响我们接下来采取的行动。</p>
</blockquote>
<h3 id="activate"><a href="#activate" class="headerlink" title="activate"></a>activate</h3><p>v.使活动；激活</p>
<blockquote>
<p>The burglar alarm is activated by movement.</p>
<p>这防盗报警器一动就响。</p>
<p>Curiosity activates creative minds.</p>
<p>好奇心激发创造性思维。</p>
</blockquote>
<h3 id="active"><a href="#active" class="headerlink" title="active"></a>active</h3><p>adj.积极的，活跃的；起作用的</p>
<blockquote>
<p>Playing with digital devices discourages kids from active discovery.</p>
<p>玩电子设备会阻碍孩子积极探索。</p>
<p>The brain is as active during REM（rapid eve movement）sleep as it is when fully awake.</p>
<p>大脑在快速眼动睡眠时与完全清醒时是一样活跃的。</p>
</blockquote>
<h3 id="actural"><a href="#actural" class="headerlink" title="actural"></a>actural</h3><p>adj.实际的；真正的；真实的</p>
<blockquote>
<p>The actural cost was higher than we expected.</p>
<p>实际成本比我们预期的要高。</p>
<p>Their methods do not attempt to estimate the actural biomass.</p>
<p>他们的方法并不试图估算实际的生物量。</p>
</blockquote>
<h3 id="acturally"><a href="#acturally" class="headerlink" title="acturally"></a>acturally</h3><p>adv.事实上，实际上</p>
<blockquote>
<p>A new study suggests that people are actually more stressed at home than at work.</p>
<p>一项新的研究表明，人们在家里的压力实际上比在工作时更大。</p>
</blockquote>
<h3 id="allowance"><a href="#allowance" class="headerlink" title="allowance"></a>allowance</h3><p>n.津贴，补贴</p>
<h3 id="amaze"><a href="#amaze" class="headerlink" title="amaze"></a>amaze</h3><p>v.使惊奇；惊愕；</p>
<blockquote>
<p>Your sudden appearance amazed me a lot.</p>
<p>你突然出现让我非常惊讶。</p>
<p>We are amazed today at the mere number of plays produces.</p>
<p>今天，我们对所制作的戏剧数量感到震惊。</p>
</blockquote>
<h3 id="amazing"><a href="#amazing" class="headerlink" title="amazing"></a>amazing</h3><p>adj.令人惊异的；了不起的</p>
<blockquote>
<p>The networked computer is an amazing device.</p>
<p>网络计算机是一个令人惊叹的设备。</p>
</blockquote>
<h3 id="ambition"><a href="#ambition" class="headerlink" title="ambition"></a>ambition</h3><p>n.野心，雄心，抱负</p>
<blockquote>
<p>His burning ambition was to study medicine.</p>
<p>他最大的志向是学习医学。</p>
<p>He left the bank in 2005 with ambitions to be a CEO.</p>
<p>他于2005年离开了银行，怀着成为首席执行官的志向。</p>
</blockquote>
<h3 id="ambitious"><a href="#ambitious" class="headerlink" title="ambitious"></a>ambitious</h3><p>adj.有抱负的；有雄心的</p>
<h3 id="amuse"><a href="#amuse" class="headerlink" title="amuse"></a>amuse</h3><p>v.逗乐，逗笑；</p>
<h3 id="amusement"><a href="#amusement" class="headerlink" title="amusement"></a>amusement</h3><p>n.娱乐；消遣活动</p>
<h3 id="ancient"><a href="#ancient" class="headerlink" title="ancient"></a>ancient</h3><p>adj.古代的，古老的</p>
<blockquote>
<p>The pyramids were built in ancient times.</p>
<p>金字塔建于古代。</p>
</blockquote>
<h3 id="antique"><a href="#antique" class="headerlink" title="antique"></a>antique</h3><p>n.古董；古风</p>
<p>adj.古代的；古玩</p>
<h3 id="anticipate"><a href="#anticipate" class="headerlink" title="anticipate"></a>anticipate</h3><p>v.预测；预料；</p>
<blockquote>
<p>I anticipated his fate yesterday.</p>
<p>我昨天预料到了他的命运。</p>
</blockquote>
<h3 id="applaud"><a href="#applaud" class="headerlink" title="applaud"></a>applaud</h3><p>v.称赞；鼓掌</p>
<blockquote>
<p>They rose to applaud the speaker.</p>
<p>他们站起来为演讲者鼓掌。</p>
</blockquote>
<h3 id="arrest"><a href="#arrest" class="headerlink" title="arrest"></a>arrest</h3><p>n&#x2F;v.拘留；逮捕</p>
<h3 id="arise"><a href="#arise" class="headerlink" title="arise"></a>arise</h3><p>v.发生；产生；出现；由…引起</p>
<blockquote>
<p>His failure arose from his laziness.</p>
<p>他的失败源于他的懒惰。</p>
<p>It is speculated that gardens arise from a basic human need in the individuals who made them.</p>
<p>有人推测，花园源于那些建造它们的人的基本人类需求。</p>
</blockquote>
<h3 id="arouse"><a href="#arouse" class="headerlink" title="arouse"></a>arouse</h3><p>v.唤醒；唤起，引起，激起</p>
<blockquote>
<p>My curiosity was fully aroused by his expression.</p>
<p>他的表情完全引起了我的好奇心。</p>
<p>The idea arose because of the perplexing behavior of the women in the plant.</p>
<p>这个想法源于工厂里女性员工令人困惑的行为。</p>
</blockquote>
<h3 id="astonish"><a href="#astonish" class="headerlink" title="astonish"></a>astonish</h3><p>v.使十分惊讶</p>
<blockquote>
<p>The news astonished everyone.</p>
<p>She astonished us by saying she was leaving</p>
</blockquote>
<h3 id="astonishing"><a href="#astonishing" class="headerlink" title="astonishing"></a>astonishing</h3><p>adj.令人十分惊讶的；令人大为惊奇的；难以置信的</p>
<h3 id="attain"><a href="#attain" class="headerlink" title="attain"></a>attain</h3><p>v.达到，获得</p>
<h3 id="authority"><a href="#authority" class="headerlink" title="authority"></a>authority</h3><p>n.权威；当局，当权者；专家</p>
<h3 id="award"><a href="#award" class="headerlink" title="award"></a>award</h3><p>n.奖品，奖金</p>
<p>v.授予</p>
<blockquote>
<p>She was recently honoured with a lifetime achievement award.</p>
<p>她最近获得了终身成就奖。</p>
<p>A town of culture award could become an annual event.</p>
<p>“文化之城奖”可能会成为一项年度盛事。</p>
</blockquote>
<h3 id="awkward"><a href="#awkward" class="headerlink" title="awkward"></a>awkward</h3><p>adj.令人尴尬的；难处理的；笨拙的；不舒适的</p>
<blockquote>
<p>After he spoke , there was an awkward slience.</p>
<p>他讲完话后，场面一度陷入尴尬的沉默。</p>
<p>If you feel awkward being humorous, you must practice so that it becomes more natural.</p>
<p>如果你觉得开玩笑很尴尬，那你就必须多练习，让它变得更自然。</p>
</blockquote>
<h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><h3 id="behave"><a href="#behave" class="headerlink" title="behave"></a>behave</h3><p>v.表现；举止得体</p>
<blockquote>
<p>She doesn’t know how to behave in public.</p>
<p>她不知道在公共场合应该如何举止。</p>
</blockquote>
<h3 id="behaiour"><a href="#behaiour" class="headerlink" title="behaiour"></a>behaiour</h3><p>n.行为；举止；态度</p>
<blockquote>
<p>There’s no doubt that our peer groups exert enormous influence on our behavior.</p>
<p>毫无疑问，我们的同龄群体对我们的行为有着巨大的影响。</p>
</blockquote>
<h3 id="bloom"><a href="#bloom" class="headerlink" title="bloom"></a>bloom</h3><p>n.开花</p>
<p>v.开花</p>
<h3 id="boost"><a href="#boost" class="headerlink" title="boost"></a>boost</h3><p>n.提升，增加，激励</p>
<p>v.提高，增强，激励</p>
<h3 id="bonus"><a href="#bonus" class="headerlink" title="bonus"></a>bonus</h3><p>n.奖金，红利</p>
<h3 id="burglar"><a href="#burglar" class="headerlink" title="burglar"></a>burglar</h3><p>v.指“入室盗窃者”或“夜盗”</p>
<h3 id="burnout"><a href="#burnout" class="headerlink" title="burnout"></a>burnout</h3><p>n.精疲力竭；过度劳累；燃尽了</p>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><h3 id="characteristic"><a href="#characteristic" class="headerlink" title="characteristic"></a>characteristic</h3><p>n.特征；特点；</p>
<p>adj.典型的；独特的</p>
<h3 id="clap"><a href="#clap" class="headerlink" title="clap"></a>clap</h3><p>n&#x2F;v.鼓掌；拍手</p>
<blockquote>
<p>The band played a familiar tune which had everyone clapping along.</p>
<p>乐队演奏了一首熟悉的曲子，大家纷纷跟着鼓掌。</p>
<p>With a clap of his hands he ordered more food.</p>
<p>他拍了一下手，点了更多的食物。</p>
</blockquote>
<h3 id="clock"><a href="#clock" class="headerlink" title="clock"></a>clock</h3><p>n.钟，时钟；</p>
<p>v.记录时间</p>
<h3 id="conduct"><a href="#conduct" class="headerlink" title="conduct"></a>conduct</h3><p>v.组织，安排；实施，执行；指挥；指导</p>
<p>n.行为，举止</p>
<blockquote>
<p>The sport has a strict code of confuct.</p>
<p>这项运动有严格的行为规范。</p>
</blockquote>
<h3 id="conductor"><a href="#conductor" class="headerlink" title="conductor"></a>conductor</h3><p>n.指挥；售票员，检票员；导体</p>
<blockquote>
<p>Semiconductor industry had been taken over by foreign enterprises.</p>
<p>半导体行业已经被外国企业接管。</p>
</blockquote>
<h3 id="curb"><a href="#curb" class="headerlink" title="curb"></a>curb</h3><p>v.控制；抑制；限制</p>
<blockquote>
<p>He needs to learn to curb his temper.</p>
<p>他需要学会控制自己的脾气。</p>
<p>Curbs on business-method claims would be a dramatic about-face.</p>
<p>对商业方法专利的限制将是一个戏剧性的转变。</p>
</blockquote>
<h2 id="D"><a href="#D" class="headerlink" title="D"></a>D</h2><h3 id="desperate"><a href="#desperate" class="headerlink" title="desperate"></a>desperate</h3><p>adj.严重的，糟糕的；不顾一切的，奋不顾身的</p>
<h3 id="derive"><a href="#derive" class="headerlink" title="derive"></a>derive</h3><p>v.导出；追究，由来；</p>
<h3 id="deprive"><a href="#deprive" class="headerlink" title="deprive"></a>deprive</h3><p>v.夺走，抢夺</p>
<h3 id="detain"><a href="#detain" class="headerlink" title="detain"></a>detain</h3><p>v.拘留，留住；</p>
<h3 id="direct"><a href="#direct" class="headerlink" title="direct"></a>direct</h3><p>v.指导，指挥</p>
<p>adj.直接的</p>
<blockquote>
<p>The project mamagers direct the day-to-day.</p>
<p>项目经理负责日常事务的管理。</p>
</blockquote>
<h3 id="direction"><a href="#direction" class="headerlink" title="direction"></a>direction</h3><p>n.方向；方位；</p>
<h3 id="directly"><a href="#directly" class="headerlink" title="directly"></a>directly</h3><p>adv.直接地</p>
<h3 id="dismay"><a href="#dismay" class="headerlink" title="dismay"></a>dismay</h3><p>n.沮丧，灰心，丧气；诧异；惊愕</p>
<p>v.使失望；使惊愕</p>
<blockquote>
<p>I read of her resignation with some dismay.</p>
<p>我看到她的辞职报告的时候有些许沮丧</p>
<p>To her dismay,her name was not on the list.</p>
<p>令她失望的是，她的名字不在名单上。</p>
</blockquote>
<h3 id="distration"><a href="#distration" class="headerlink" title="distration"></a>distration</h3><p>n.干扰因素，焦虑不安</p>
<h3 id="domain"><a href="#domain" class="headerlink" title="domain"></a>domain</h3><p>n.领域，范围</p>
<h3 id="domestic"><a href="#domestic" class="headerlink" title="domestic"></a>domestic</h3><p>adj.家庭的，国内的</p>
<h3 id="dominate"><a href="#dominate" class="headerlink" title="dominate"></a>dominate</h3><p>v.控制，利用</p>
<h3 id="domination"><a href="#domination" class="headerlink" title="domination"></a>domination</h3><p>n.支配，控制；影响</p>
<h3 id="dominant"><a href="#dominant" class="headerlink" title="dominant"></a>dominant</h3><p>adj.有统治权的，支配的，占优势的</p>
<h3 id="drain"><a href="#drain" class="headerlink" title="drain"></a>drain</h3><p>v.排空，耗尽</p>
<h3 id="dynamic"><a href="#dynamic" class="headerlink" title="dynamic"></a>dynamic</h3><p>adj.动态的；有活力的</p>
<h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><h3 id="embarrass"><a href="#embarrass" class="headerlink" title="embarrass"></a>embarrass</h3><p>v.使窘迫；使尴尬</p>
<h3 id="embassy"><a href="#embassy" class="headerlink" title="embassy"></a>embassy</h3><p>n.大使馆</p>
<h3 id="embrace"><a href="#embrace" class="headerlink" title="embrace"></a>embrace</h3><p>v.拥抱；包括</p>
<h3 id="entertain"><a href="#entertain" class="headerlink" title="entertain"></a>entertain</h3><p>v.款待</p>
<h3 id="entire"><a href="#entire" class="headerlink" title="entire"></a>entire</h3><p>adj.全部的，整个的；完全的</p>
<blockquote>
<p>The entire village was destoryed.</p>
<p>整个村庄都被摧毁了。</p>
</blockquote>
<h3 id="entirely"><a href="#entirely" class="headerlink" title="entirely"></a>entirely</h3><p>adv.完全地；完整地</p>
<blockquote>
<p>But, the wonderful thing about failure is that it’s entirely up to us to decide how to look at it.</p>
<p>但是，失败最奇妙的一点在于，我们完全可以自己决定如何看待它。</p>
</blockquote>
<h3 id="exact"><a href="#exact" class="headerlink" title="exact"></a>exact</h3><p>adj.准确的，精确的，严谨的</p>
<p>v.要求；强迫；强求</p>
<blockquote>
<p>The colours were an almost exact match.</p>
<p>这些颜色几乎完全匹配。</p>
<p>You should make shopping lists for your ingredients in their exact quantities.</p>
<p>你应该根据配料的准确用量列出购物清单。</p>
</blockquote>
<h3 id="exactly"><a href="#exactly" class="headerlink" title="exactly"></a>exactly</h3><p>adv.准确地，精确地</p>
<blockquote>
<p>This year marks exactly two centuries since its publication.</p>
<p>今年正好是它出版两百周年。</p>
</blockquote>
<h3 id="exhaust"><a href="#exhaust" class="headerlink" title="exhaust"></a>exhaust</h3><p>v.使筋疲力竭</p>
<h3 id="exhausted"><a href="#exhausted" class="headerlink" title="exhausted"></a>exhausted</h3><p>adj.筋疲力尽的</p>
<h3 id="exercise"><a href="#exercise" class="headerlink" title="exercise"></a>exercise</h3><p>n.运动，锻炼，行使，施加</p>
<p>v.锻炼，行使，施加</p>
<h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><h3 id="fare"><a href="#fare" class="headerlink" title="fare"></a>fare</h3><p>n.票价</p>
<h3 id="farewell"><a href="#farewell" class="headerlink" title="farewell"></a>farewell</h3><p>v.告别</p>
<h3 id="fatigue"><a href="#fatigue" class="headerlink" title="fatigue"></a>fatigue</h3><p>n.疲劳；劳累</p>
<h3 id="fee"><a href="#fee" class="headerlink" title="fee"></a>fee</h3><p>n.费用；酬金</p>
<h3 id="flesh"><a href="#flesh" class="headerlink" title="flesh"></a>flesh</h3><p>n.肉，果肉；肉体；皮肤</p>
<blockquote>
<p>The flesh of the peach is sweet and juicy.</p>
<p>桃子的果肉香甜多汁。</p>
</blockquote>
<h3 id="forum"><a href="#forum" class="headerlink" title="forum"></a>forum</h3><p>n.论坛</p>
<h2 id="G"><a href="#G" class="headerlink" title="G"></a>G</h2><h3 id="gamble"><a href="#gamble" class="headerlink" title="gamble"></a>gamble</h3><p>v.赌博；冒险，碰运气</p>
<p>n.赌博；</p>
<blockquote>
<p>He’s gambing his reputation on this deal.</p>
<p>他在这笔交易上赌上了自己的名声。</p>
</blockquote>
<h3 id="gambler"><a href="#gambler" class="headerlink" title="gambler"></a>gambler</h3><p>n.赌徒</p>
<h3 id="gorgeous"><a href="#gorgeous" class="headerlink" title="gorgeous"></a>gorgeous</h3><p>adj.漂亮的；绚丽的；</p>
<p>同义词：beautiful</p>
<h2 id="H"><a href="#H" class="headerlink" title="H"></a>H</h2><h3 id="harness"><a href="#harness" class="headerlink" title="harness"></a>harness</h3><p>v.控制，利用</p>
<h3 id="hear"><a href="#hear" class="headerlink" title="hear"></a>hear</h3><p>v.听</p>
<h3 id="honor-honour"><a href="#honor-honour" class="headerlink" title="honor&#x2F;honour"></a>honor&#x2F;honour</h3><p>n.荣誉、光荣；奖项；</p>
<p>v.授予荣誉、表彰</p>
<h3 id="host"><a href="#host" class="headerlink" title="host"></a>host</h3><p>n.主人；东道主；主持人；</p>
<p>v.主持；举办活动</p>
<blockquote>
<p>The 2008 Olympic Games was held in Beijing.</p>
<p>2008年奥运会在北京举行。</p>
</blockquote>
<h2 id="I"><a href="#I" class="headerlink" title="I"></a>I</h2><h3 id="incur"><a href="#incur" class="headerlink" title="incur"></a>incur</h3><p>v.招致（负面后果），承担（费用、债务等），遭受</p>
<h3 id="inject"><a href="#inject" class="headerlink" title="inject"></a>inject</h3><p>v.注入，注射；</p>
<h3 id="injury"><a href="#injury" class="headerlink" title="injury"></a>injury</h3><p>v.受伤</p>
<h3 id="interact"><a href="#interact" class="headerlink" title="interact"></a>interact</h3><p>v.交流，沟通；相互影响，相互作用</p>
<blockquote>
<p>He interacts very well with other children.</p>
<p>他与其他孩子相处得很好。</p>
</blockquote>
<h3 id="interaction"><a href="#interaction" class="headerlink" title="interaction"></a>interaction</h3><p>n.互动，交流；相互作用</p>
<blockquote>
<p>The human systems and the landscapes we live on are linked , and the interactions go both ways.</p>
<p>人类系统与我们赖以生存的自然景观是相互关联的，而且这种互动是双向的。</p>
</blockquote>
<h3 id="innovate"><a href="#innovate" class="headerlink" title="innovate"></a>innovate</h3><p>v.创新；革新</p>
<blockquote>
<p>The company can once again innovate its way out of tough economic times.</p>
<p>公司可以再次通过创新摆脱经济困境。</p>
</blockquote>
<h3 id="innovation"><a href="#innovation" class="headerlink" title="innovation"></a>innovation</h3><p>n.创造；创新；改革</p>
<blockquote>
<p>The first thing needed for innovation is a fascination with wonder.</p>
<p>创新所需的第一件事是对奇迹的迷恋。</p>
</blockquote>
<h3 id="inquire"><a href="#inquire" class="headerlink" title="inquire"></a>inquire</h3><p>v.查询，询问</p>
<h3 id="isolate"><a href="#isolate" class="headerlink" title="isolate"></a>isolate</h3><p>v.隔离，孤立</p>
<h2 id="L"><a href="#L" class="headerlink" title="L"></a>L</h2><h3 id="leisure"><a href="#leisure" class="headerlink" title="leisure"></a>leisure</h3><p>n.空闲，闲暇，休闲</p>
<blockquote>
<p>These days we have increased opportunities for leisure.</p>
<p>如今，我们拥有更多的休闲机会。</p>
</blockquote>
<h2 id="M"><a href="#M" class="headerlink" title="M"></a>M</h2><h3 id="matain"><a href="#matain" class="headerlink" title="matain"></a>matain</h3><p>v.维持</p>
<h3 id="mere"><a href="#mere" class="headerlink" title="mere"></a>mere</h3><p>adj.仅仅的，只不过；纯粹的</p>
<blockquote>
<p>It took her a mere 20 minutes to win.</p>
<p>她仅仅用了 20 分钟就赢了。</p>
</blockquote>
<h3 id="merely"><a href="#merely" class="headerlink" title="merely"></a>merely</h3><blockquote>
<p>Merely expanding the orchestra’s repertoire will not be enough.</p>
<p>仅仅扩展乐团的曲目库是不够的。</p>
</blockquote>
<h3 id="monarch"><a href="#monarch" class="headerlink" title="monarch"></a>monarch</h3><p>n.君主，帝王，统治者</p>
<h3 id="monarchy"><a href="#monarchy" class="headerlink" title="monarchy"></a>monarchy</h3><p>n.君主制；君主政体</p>
<h2 id="R"><a href="#R" class="headerlink" title="R"></a>R</h2><h3 id="react"><a href="#react" class="headerlink" title="react"></a>react</h3><p>v.起化学反应；回应，做出反应</p>
<blockquote>
<p>All students in our university react strongly to the resign of the president.</p>
<p>我们学校的所有学生对校长辞职的反应很激烈。</p>
<p>The stock market reacts positively when companies tie CEO  pay to stock prices.</p>
<p>当公司把股价和首席执行官的工资挂钩时，股市会作出积极反应。</p>
</blockquote>
<h3 id="reaction"><a href="#reaction" class="headerlink" title="reaction"></a>reaction</h3><p>n.反应；反作用力</p>
<h3 id="reactor"><a href="#reactor" class="headerlink" title="reactor"></a>reactor</h3><p>n.核反应堆</p>
<h3 id="recreation"><a href="#recreation" class="headerlink" title="recreation"></a>recreation</h3><p>n.消遣，娱乐</p>
<p>n.再造</p>
<blockquote>
<p>His recreations include golf,football and shooting.</p>
<p>他的消遣活动包括高尔夫、足球和射击。</p>
<p>But traditionally they’ve focused on wildlife , watersheds and opportunities for recreation.</p>
<p>但传统上，他们关注的重点是野生动物、水源保护区和娱乐休闲的机会。</p>
</blockquote>
<h3 id="recur"><a href="#recur" class="headerlink" title="recur"></a>recur</h3><p>v.再发生；反复出现</p>
<blockquote>
<p>Cartwright believes one can exercise conscious control over recurring bad dreams.</p>
<p>卡特赖特相信一个人可以对反复出现的噩梦行使有意识的控制。</p>
</blockquote>
<h3 id="reign"><a href="#reign" class="headerlink" title="reign"></a>reign</h3><p>n.统治，支配</p>
<p>v.统治</p>
<blockquote>
<p>sovereign</p>
<p>n.君主，元首；</p>
<p>adj.至高无上的</p>
</blockquote>
<h3 id="reject"><a href="#reject" class="headerlink" title="reject"></a>reject</h3><p>v.拒绝</p>
<h3 id="respect"><a href="#respect" class="headerlink" title="respect"></a>respect</h3><p>v.尊敬，孝敬</p>
<blockquote>
<p>Respecting parents is argued to be of grreat importance.</p>
<p>尊敬父母被认为是非常重要的。</p>
</blockquote>
<h3 id="retain"><a href="#retain" class="headerlink" title="retain"></a>retain</h3><p>v.保持；聘请；记住</p>
<h3 id="retire"><a href="#retire" class="headerlink" title="retire"></a>retire</h3><p>v.退休；退役；退出</p>
<blockquote>
<p>He is retiring next year after 30 years with the company.</p>
<p>他将在明年退休，届时他已在这家公司工作了 30 年。</p>
</blockquote>
<h3 id="retiree"><a href="#retiree" class="headerlink" title="retiree"></a>retiree</h3><p>n.退休人员</p>
<blockquote>
<p>Meanwhile, it has more than $120 billion in unfunded liabilities, mostly for emplyee health and retirement coses.</p>
<p>与此同时，它有超过1200亿美元的未偿付负债，主要是员工健康和退休方面的费用。</p>
</blockquote>
<h3 id="retirement"><a href="#retirement" class="headerlink" title="retirement"></a>retirement</h3><p>n.退休</p>
<h3 id="refresh"><a href="#refresh" class="headerlink" title="refresh"></a>refresh</h3><p>v.使精神振作，使精力恢复</p>
<blockquote>
<p>The following moring she awoke refreshed.</p>
<p>第二天早上，她醒来时神清气爽。</p>
<p>It was specifically to provide city dwellers with spaces for leisure where they could experience “a refreshing air”.</p>
<p>其目的正是为城市居民提供休闲空间，让他们能够体验“清新的空气”。</p>
</blockquote>
<h3 id="require"><a href="#require" class="headerlink" title="require"></a>require</h3><p>v.需要</p>
<h3 id="rise"><a href="#rise" class="headerlink" title="rise"></a>rise</h3><p>n.上升，增加</p>
<p>v.上升；增加；起义，反抗</p>
<blockquote>
<p>They rose from the table.</p>
<p>他们从桌子旁站起来了。</p>
<p>Everybody loves a fat pay rise.</p>
<p>每个人都喜欢大幅加薪。</p>
</blockquote>
<blockquote>
<p>rise</p>
<p>上升，升起</p>
<p>arise</p>
<p>出现</p>
<p>arouse</p>
<p>呼吁唤起</p>
<p>raise</p>
<p>筹集；抚养</p>
</blockquote>
<h3 id="raise"><a href="#raise" class="headerlink" title="raise"></a>raise</h3><p>n.加薪</p>
<p>v.举起；增加；提高；提及；饲养</p>
<blockquote>
<p>They had raised the white flag in surrender.</p>
<p>他们已经举起了白旗表示投降。</p>
</blockquote>
<h3 id="renew"><a href="#renew" class="headerlink" title="renew"></a>renew</h3><p>v.更新；重新开始</p>
<blockquote>
<p>We have to renew our efforts to attract young players.</p>
<p>我们必须重新加大力度来吸引年轻球员。</p>
<p>These labels encourage style-conscious consumers to see clothes as disposable and to renew their wardrobe every few weeks</p>
<p>这些品牌鼓励注重时尚的消费者将衣服视为一次性用品，并每隔几周就更新他们的衣橱。</p>
</blockquote>
<h3 id="renovate"><a href="#renovate" class="headerlink" title="renovate"></a>renovate</h3><p>v.翻新，修复；</p>
<blockquote>
<p>They spent the summer renovating the farmhouse.</p>
<p>他们整个夏天都在翻修农舍。</p>
</blockquote>
<h3 id="restore"><a href="#restore" class="headerlink" title="restore"></a>restore</h3><p>v.恢复，修复；归还</p>
<blockquote>
<p>The operation restored his sight.</p>
<p>手术恢复了他的视力。</p>
</blockquote>
<h3 id="restoration"><a href="#restoration" class="headerlink" title="restoration"></a>restoration</h3><p>n.整修；恢复；归还</p>
<blockquote>
<p>The palace is closed for restoration.</p>
<p>宫殿因维修而关闭。</p>
</blockquote>
<h3 id="reward"><a href="#reward" class="headerlink" title="reward"></a>reward</h3><p>n.奖励；回报；报酬</p>
<p>v.奖赏；奖励</p>
<blockquote>
<p>You deserve a reward for being so helpful.</p>
<p>你这么乐于助人，应该得到一份奖励。</p>
<p>Scientists need journals in which to publish their research,so they will supply the articles without monetary reward.</p>
<p>科学家需要期刊来发表他们的研究成果，因此他们会无偿提供文章。</p>
</blockquote>
<h2 id="S"><a href="#S" class="headerlink" title="S"></a>S</h2><h3 id="speculate"><a href="#speculate" class="headerlink" title="speculate"></a>speculate</h3><p>v.投机；推测；思索；</p>
<blockquote>
<p>I speculated on his idea.</p>
<p>我对他的想法进行了猜测。</p>
</blockquote>
<h3 id="stale"><a href="#stale" class="headerlink" title="stale"></a>stale</h3><p>adj.不新鲜的；污浊的；陈腐的；厌倦的</p>
<blockquote>
<p>They starved but only could eat a piece of stale bread every day.</p>
<p>他们挨饿，每天只能吃一片发硬的面包。</p>
</blockquote>
<h3 id="steer"><a href="#steer" class="headerlink" title="steer"></a>steer</h3><p>v.驾驶；操纵；控制；引导</p>
<blockquote>
<p>steer clear of </p>
<p>避开；回避</p>
<p>This growth leader is also responsible for keeping the team focus on moving forward and steer them clear of distractions.</p>
<p>这位增长负责人还负责让团队专注于前进，并引导他们避开干扰。</p>
</blockquote>
<h3 id="stock"><a href="#stock" class="headerlink" title="stock"></a>stock</h3><p>n.股票股份</p>
<h3 id="storage"><a href="#storage" class="headerlink" title="storage"></a>storage</h3><p>n.贮存，贮藏</p>
<blockquote>
<p>There is a lot of storage space in the loft.</p>
<p>阁楼里有很多储藏空间。</p>
<p>But a boost in the storage capacity of batteries is making their ability to keep power flowing around the clock more likely.</p>
<p>但电池存储容量的提升使得它们全天候持续供电的能力变得更加可能。</p>
</blockquote>
<h3 id="store"><a href="#store" class="headerlink" title="store"></a>store</h3><p>n.商店；仓库</p>
<p>v.贮藏，贮存</p>
<h3 id="subject"><a href="#subject" class="headerlink" title="subject"></a>subject</h3><p>n.学科；主语</p>
<h3 id="subsequent"><a href="#subsequent" class="headerlink" title="subsequent"></a>subsequent</h3><p>adj.“随后的”、“后来的”或“接着发生的”</p>
<h3 id="sustain"><a href="#sustain" class="headerlink" title="sustain"></a>sustain</h3><p>v.维持</p>
<h2 id="T"><a href="#T" class="headerlink" title="T"></a>T</h2><h3 id="tie"><a href="#tie" class="headerlink" title="tie"></a>tie</h3><p>v.“系、绑、连接”</p>
<p>n.“领带、平局、联系”</p>
<h3 id="thrive"><a href="#thrive" class="headerlink" title="thrive"></a>thrive</h3><p>v.繁荣，兴旺发达。</p>
<h2 id="O"><a href="#O" class="headerlink" title="O"></a>O</h2><h3 id="obese"><a href="#obese" class="headerlink" title="obese"></a>obese</h3><p>adj.臃肿的；虚胖的</p>
<h3 id="object"><a href="#object" class="headerlink" title="object"></a>object</h3><p>n.物体，宾语；目标，对象；</p>
<p>v.拒绝，反对；</p>
<h3 id="obtain"><a href="#obtain" class="headerlink" title="obtain"></a>obtain</h3><p>v.获得，得到</p>
<h3 id="origin"><a href="#origin" class="headerlink" title="origin"></a>origin</h3><p>n.起源，源头</p>
<h3 id="original"><a href="#original" class="headerlink" title="original"></a>original</h3><p>adj.起初的，原先的；</p>
<h2 id="P"><a href="#P" class="headerlink" title="P"></a>P</h2><h3 id="peer"><a href="#peer" class="headerlink" title="peer"></a>peer</h3><p>n.同龄人，伙伴</p>
<h3 id="pension"><a href="#pension" class="headerlink" title="pension"></a>pension</h3><p>n.养老金</p>
<h3 id="pertain"><a href="#pertain" class="headerlink" title="pertain"></a>pertain</h3><p>v.适用</p>
<h3 id="philosophy"><a href="#philosophy" class="headerlink" title="philosophy"></a>philosophy</h3><p>n.哲学</p>
<h3 id="pollution"><a href="#pollution" class="headerlink" title="pollution"></a>pollution</h3><p>n.污染</p>
<blockquote>
<p>Pollution is thought to be serious by an increasing number of people.</p>
<p>越来越多的人认为污染是一个严重的问题。 </p>
</blockquote>
<h3 id="praise"><a href="#praise" class="headerlink" title="praise"></a>praise</h3><p>n&#x2F;v.表扬，赞美</p>
<blockquote>
<p>His teachers are full of praise for the progress he has made.</p>
<p>他的老师们对他取得的进步赞不绝口。</p>
<p>Retail trade groups praised the ruling.</p>
<p>零售贸易团体对这一裁决表示赞赏。</p>
</blockquote>
<h3 id="president"><a href="#president" class="headerlink" title="president"></a>president</h3><p>n.“总统、主席、校长、会长”</p>
<h3 id="prize"><a href="#prize" class="headerlink" title="prize"></a>prize</h3><p>n.奖赏；奖金；奖品</p>
<p>v.珍视</p>
<blockquote>
<p>She was awarded the Nobel Peace Prize.</p>
<p>她被授予了诺贝尔和平奖。</p>
</blockquote>
<h3 id="process"><a href="#process" class="headerlink" title="process"></a>process</h3><p>v.加工，处理</p>
<p>n.步骤，过程；进程；传票；【计】进程</p>
<h2 id="W"><a href="#W" class="headerlink" title="W"></a>W</h2><h3 id="weary"><a href="#weary" class="headerlink" title="weary"></a>weary</h3><p>adj.疲劳的</p>
<h3 id="weather"><a href="#weather" class="headerlink" title="weather"></a>weather</h3><p>n.天气</p>
<h3 id="wellfare"><a href="#wellfare" class="headerlink" title="wellfare"></a>wellfare</h3><p>n.福利</p>
<h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><h2 id="英语句子基本结构"><a href="#英语句子基本结构" class="headerlink" title="英语句子基本结构"></a>英语句子基本结构</h2><blockquote>
<p>主语+谓语</p>
<p>主语+谓语+宾语</p>
<p>主语+谓语（系动词）+表语</p>
<p>主语+谓语+间接宾语+直接宾语（主谓双宾）</p>
<p>主语+谓语+宾语+宾语补足语（复合宾语）</p>
</blockquote>
<h3 id="主语-谓语"><a href="#主语-谓语" class="headerlink" title="主语+谓语"></a>主语+谓语</h3><blockquote>
<p>The sun rises.（主语+谓语）</p>
</blockquote>
<h3 id="主谓宾及主系表"><a href="#主谓宾及主系表" class="headerlink" title="主谓宾及主系表"></a>主谓宾及主系表</h3><p>主谓宾结构的谓语动词一定是实义动词。</p>
<p>主系表结构的谓语动词一定是系动词。</p>
<p>系动词本身有实义，但是不能单独做谓语，后面必须跟表语构成系表结构，说明主语的身份、性质、状态。</p>
<p><strong>系动词分类</strong></p>
<blockquote>
<p>表状态：be动词</p>
<p>表感官：look, sound, taste, smell, feel（感官动词后面只能加形容词）</p>
<p>表变化：grow, fall, turn, get, become</p>
<p>表保持：stand, keep, stay, remain</p>
<p>表示表象：seem, appear</p>
<p>表示结果：prove</p>
</blockquote>
<p>以上有些动词既可以作系动词，又可以做实义动词</p>
<blockquote>
<p>get: 得到</p>
<p>turn: 转动，转弯</p>
<p>grow: 成长，发展，种植</p>
<p>fall: 下降</p>
<p>keep: 继续，养活</p>
<p>stay: 逗留</p>
</blockquote>
<h3 id="主谓双宾"><a href="#主谓双宾" class="headerlink" title="主谓双宾"></a>主谓双宾</h3><p>句子中有两个宾语，一个是<strong>间接宾语</strong>（通常是人），一个是<strong>直接宾语</strong>（通常是物）。</p>
<p><strong>双宾结构</strong>：动词后紧跟两个名词，一个表示<strong>人</strong>，一个表示<strong>物</strong>。</p>
<h3 id="主谓宾宾补"><a href="#主谓宾宾补" class="headerlink" title="主谓宾宾补"></a>主谓宾宾补</h3><p><strong>定义</strong>：句子中有一个宾语 + 一个宾语补足语，宾补通常说明宾语的状态或身份。</p>
<p><strong>宾补结构</strong>：动词后宾语 + 名词&#x2F;形容词，<strong>说明宾语的身份或状态</strong>。</p>
<h2 id="简单句成分"><a href="#简单句成分" class="headerlink" title="简单句成分"></a>简单句成分</h2><h3 id="谓语"><a href="#谓语" class="headerlink" title="谓语"></a>谓语</h3><p>充当谓语的成分一定是系动词或实义动词（词组）。</p>
<p>一个简单句中可以出现多个动词（词组）；</p>
<p>谓语只能由动词（词组）充当；</p>
<p>动词（词组）不可以直接用来作句子的主语、宾语或表语。</p>
<p><strong>非谓语的形式有三种</strong>：</p>
<ul>
<li>-ing形式（doing）包含现在分词和动名词（主动居多）。</li>
<li>过去分词形式（done）表示被动或完成（被动居多）。</li>
<li>不定时形式（to do）表目的或将来（目的居多）。</li>
</ul>
<p><strong>非谓语用法</strong></p>
<ul>
<li>做主语</li>
<li>作表语</li>
<li>作宾语</li>
<li>作定语</li>
<li>做状语</li>
<li>作补语</li>
<li>作同位语</li>
</ul>
<p><strong>一句话中不能没有动词</strong></p>
<p>谓语必须是实义动词或系动词，并且谓语必须有时态和语态。</p>
<p>一个简单句中有且只能有一个有时态和语态的实义动词或系动词，并且充当谓语。</p>
<h3 id="主语"><a href="#主语" class="headerlink" title="主语"></a>主语</h3><p>可以充当主语的成分有：代词、名字（短语）、非谓语动词（短语）和从句（引导词+句子）。</p>
<p><strong>无主语解决方案</strong></p>
<ul>
<li>it做主语</li>
<li>There be 句型</li>
<li>被动语态</li>
<li>人称代词做主语</li>
</ul>
<h3 id="宾语"><a href="#宾语" class="headerlink" title="宾语"></a>宾语</h3><p>充当宾语的成分有：代词、名字（短语）、非谓语动词（短语）和从句（引导词+句子）。</p>
<h3 id="表语"><a href="#表语" class="headerlink" title="表语"></a>表语</h3><p>在系动词之后的成分是表语。</p>
<p>充当表语的成分：代词、名字（短语）、非谓语动词（短语）、形容词、介词短语和从句。</p>
<h3 id="动词的分类"><a href="#动词的分类" class="headerlink" title="动词的分类"></a>动词的分类</h3><p><strong>实义动词</strong></p>
<p>表具体动作的词</p>
<p>及物动词</p>
<p>不及物动词</p>
<p><strong>连系动词</strong></p>
<p>状态</p>
<p>感官</p>
<p>变化</p>
<p>保持</p>
<p>表象</p>
<p>结果</p>
<p><strong>情态动词</strong></p>
<p>情态动词——表示对过去的推测：情态动词+have done</p>
<p>表推测的四种常见用法</p>
<blockquote>
<p>must have done：一定做过某事</p>
<p>needn’t have done：本没必要做某事，但是做了</p>
<p>could have done：本能够做某事，但没有做</p>
<p>should have done: 本应该做某事，但没做</p>
</blockquote>
<p><strong>助动词</strong></p>
<p>助动词帮助谓语动词一起构成否定、疑问、时态、语态等的词。</p>
<p>be</p>
<p>do</p>
<p>have</p>
<p>will&#x2F;would</p>
<h3 id="动词的时态"><a href="#动词的时态" class="headerlink" title="动词的时态"></a>动词的时态</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/04/07/PyTorch/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/04/07/PyTorch/" class="post-title-link" itemprop="url">PyTorch</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-04-07 13:08:08 / 修改时间：16:34:46" itemprop="dateCreated datePublished" datetime="2025-04-07T13:08:08+08:00">2025-04-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>65</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>安装PyTorch</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install PyTorch</span><br></pre></td></tr></table></figure>

<p>安装Jupyter notebook</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install notebook</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/28/%E7%AE%97%E6%B3%95%E5%B0%8F%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/28/%E7%AE%97%E6%B3%95%E5%B0%8F%E8%AE%B0/" class="post-title-link" itemprop="url">算法小记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-03-28 01:51:59" itemprop="dateCreated datePublished" datetime="2025-03-28T01:51:59+08:00">2025-03-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-04-11 20:35:40" itemprop="dateModified" datetime="2025-04-11T20:35:40+08:00">2025-04-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%AE%97%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">算法</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="只有输出"><a href="#只有输出" class="headerlink" title="只有输出"></a>只有输出</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span> str[] = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h1><h2 id="给定两整数求和"><a href="#给定两整数求和" class="headerlink" title="给定两整数求和"></a>给定两整数求和</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;</span><br><span class="line">    cin &gt;&gt; a &gt;&gt; b;</span><br><span class="line">    cout &lt;&lt; a+b &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><h2 id="一维数组"><a href="#一维数组" class="headerlink" title="一维数组"></a>一维数组</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入描述：</span><br><span class="line">第一行有一个整数n。</span><br><span class="line">第二行有n个整数a。</span><br><span class="line">输出描述：</span><br><span class="line">输出一个整数，代表数组元素之和。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> a;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> sum = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        cin &gt;&gt; a;</span><br><span class="line">        sum+=a;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; sum;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多组-一维数组-T组形式"><a href="#多组-一维数组-T组形式" class="headerlink" title="多组 一维数组 T组形式"></a>多组 一维数组 T组形式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">输入描述：</span><br><span class="line">第一行有一个整数t。</span><br><span class="line">随后t组数据。</span><br><span class="line">每组的第一行有一个整数n。</span><br><span class="line">每组的第二行有n个整数a。</span><br><span class="line">输出描述：</span><br><span class="line">输出t行，每行一个整数，代表数组元素之和。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;t;i++)&#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        <span class="type">int</span> a;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            cin &gt;&gt; a;</span><br><span class="line">            sum +=a;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; sum &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入描述：</span><br><span class="line">第一行有两个整数n和m。</span><br><span class="line">随后n行，每行有m个整数 </span><br><span class="line">输出描述：</span><br><span class="line">输出一个整数，代表数组元素之和。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j&lt;m;j++)&#123;</span><br><span class="line">            <span class="type">int</span> a;</span><br><span class="line">            cin &gt;&gt; a;</span><br><span class="line">            sum+=a;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; sum &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="多组-二维数-T组形式"><a href="#多组-二维数-T组形式" class="headerlink" title="多组 二维数 T组形式"></a>多组 二维数 T组形式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">输入描述：</span><br><span class="line">第一行有一个整数 t。</span><br><span class="line">随后 t 组数据。</span><br><span class="line">每组的第一行有两个整数 n和 m。</span><br><span class="line">每组的随后 n 行，每行有 m 个整数 a 。</span><br><span class="line">输出描述：</span><br><span class="line">输出 t 行，每行一个整数，代表数组元素之和。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;t;i++)&#123;</span><br><span class="line">        <span class="type">int</span> n,m;</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        <span class="type">long</span> <span class="type">long</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> k=<span class="number">0</span>;k&lt;m;k++)&#123;</span><br><span class="line">                <span class="type">int</span> a;</span><br><span class="line">                cin &gt;&gt; a;</span><br><span class="line">                sum+=a;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; sum &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><h2 id="字符串逆序"><a href="#字符串逆序" class="headerlink" title="字符串逆序"></a>字符串逆序</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">给定一个长度为 </span><br><span class="line">n的字符串s ，请你将其倒置，然后输出。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有一个整数 n。</span><br><span class="line">第二行有一个字符串 s，仅包含小写英文字符。</span><br><span class="line">输出描述：</span><br><span class="line">输出一个字符串，代表倒置后的字符串 s 。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;algorithm&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    string s;</span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">    cout &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="type">char</span> s[n]; </span><br><span class="line">    cin &gt;&gt; s;</span><br><span class="line">    <span class="comment">// 手动反转字符串</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n / <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        <span class="type">char</span> temp = s[i];</span><br><span class="line">        s[i] = s[n - <span class="number">1</span> - i];</span><br><span class="line">        s[n - <span class="number">1</span> - i] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="多组-字符串-T组形式"><a href="#多组-字符串-T组形式" class="headerlink" title="多组 字符串 T组形式"></a>多组 字符串 T组形式</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">给定 t 组询问，每次给出一个长度为 n 的字符串 s ，请将其倒置，然后输出。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有一个整数 t随后 t 组数据。</span><br><span class="line">每组的第一行有一个整数 n 。</span><br><span class="line">每组的第二行有一个字符串 s，仅包含小写英文字符。</span><br><span class="line">输出描述：</span><br><span class="line">输出 t 行，每行一个字符串，代表倒置后的字符串 s 。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;algorithm&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i&lt;t;i++)&#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        string s;</span><br><span class="line">        cin &gt;&gt; s;</span><br><span class="line">        <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">        cout &lt;&lt; s &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二维字符数组"><a href="#二维字符数组" class="headerlink" title="二维字符数组"></a>二维字符数组</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">描述：</span><br><span class="line">给定一个 n 行 m 列的二维字符数组 a ，第 i 行第 j 列元素的值为 a。</span><br><span class="line">请对行和列都倒置，然后输出之。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有两个整数 n。</span><br><span class="line">随后 n 行，每行有 m 个字符，仅包含小写英文字符 。</span><br><span class="line">输出描述：</span><br><span class="line">输出一个二维字符数组。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="type">char</span> arr[n][m];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;m;j++)&#123;</span><br><span class="line">            cin &gt;&gt;arr[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">            cout &lt;&lt; arr[n<span class="number">-1</span> - i][m<span class="number">-1</span> - j];</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="type">char</span> arr[n][m]; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取输入</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">            cin &gt;&gt; arr[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 行倒置（交换上下对称行）</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n / <span class="number">2</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(arr[i][j], arr[n - <span class="number">1</span> - i][j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 列倒置（交换左右对称列）</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m / <span class="number">2</span>; ++j) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(arr[i][j], arr[i][m - <span class="number">1</span> - j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出结果</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; m; ++j) &#123;</span><br><span class="line">            cout &lt;&lt; arr[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="带空格的字符串"><a href="#带空格的字符串" class="headerlink" title="带空格的字符串"></a>带空格的字符串</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">描述：</span><br><span class="line">给定 t 组询问，每次给出一个长度为 n 的带空格的字符串 s ，请你去掉空格之后，将其倒置，然后输出。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有一个整数 t 。</span><br><span class="line">随后 t 组数据。</span><br><span class="line">每组的第一行有一个整数 n 。</span><br><span class="line">每组的第二行有一个字符串 s，仅包含小写英文字符和空格，保证字符串首尾都不是空格。</span><br><span class="line">输出描述：</span><br><span class="line">输出 t 行，每行一个字符串，代表倒置后的字符串 s 。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;string&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;t;i++)&#123;</span><br><span class="line">        <span class="type">int</span> n;</span><br><span class="line">        cin &gt;&gt; n;</span><br><span class="line">        cin.<span class="built_in">ignore</span>();</span><br><span class="line">        string s;</span><br><span class="line">        <span class="built_in">getline</span>(cin, s);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[n<span class="number">-1</span>-j]!=<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">                cout &lt;&lt; s[n<span class="number">-1</span>-j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="格式化数字"><a href="#格式化数字" class="headerlink" title="格式化数字"></a>格式化数字</h1><h2 id="保留小数位数"><a href="#保留小数位数" class="headerlink" title="保留小数位数"></a>保留小数位数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">描述：</span><br><span class="line">给定一个小数 n ，请保留 3 位小数后输出。</span><br><span class="line">如果原来的小数位数少于 3 ，需要补充 0 。</span><br><span class="line">如果原来的小数位数多于 3 ，需要四舍五入到 3 位。</span><br><span class="line">输入：</span><br><span class="line">第一行有一个小数 n 。</span><br><span class="line">输出：</span><br><span class="line">输出一个小数，保留 3 位。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">float</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.3f\n&quot;</span>,t);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="补充前导0"><a href="#补充前导0" class="headerlink" title="补充前导0"></a>补充前导0</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">给定一个正整数 n ，请你保留 9 个数位，然后输出。</span><br><span class="line">如果数位少于 9 个，那么需要补充前导零。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有一个整数 n 。</span><br><span class="line">输出描述：</span><br><span class="line">输出一个数字，保留 9 个数位。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> t;</span><br><span class="line">    cin &gt;&gt; t;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%09d\n&quot;</span>,t);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="spj判断YES与NO"><a href="#spj判断YES与NO" class="headerlink" title="spj判断YES与NO"></a>spj判断YES与NO</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">描述：</span><br><span class="line">给定一个正整数n</span><br><span class="line">如果n是奇数，输出yes</span><br><span class="line">如果n是偶数，输出no</span><br><span class="line">输入描述：</span><br><span class="line">第一行有一个整数n</span><br><span class="line">输出描述：</span><br><span class="line">如果n是奇数，输出yes</span><br><span class="line">如果n是偶数，输出no</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">if</span> (n%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;YES&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="spj浮点误差"><a href="#spj浮点误差" class="headerlink" title="spj浮点误差"></a>spj浮点误差</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">描述：</span><br><span class="line">给定一个圆的半径 r ，请你求出该圆的面积。</span><br><span class="line">保证半径 r 是整数。</span><br><span class="line">如果你的答案和标准答案的误差不超过 0.001，即可通过本题。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有一个整数 n。</span><br><span class="line">输出描述：</span><br><span class="line">输出一个数字，代表圆的面积。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;iostream&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;cmath&quot;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line">    cin &gt;&gt; r;</span><br><span class="line">    <span class="type">double</span> s = <span class="built_in">pow</span>(r,<span class="number">2</span>)*M_PI;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.6f\n&quot;</span>,s);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="spj判断数组之和"><a href="#spj判断数组之和" class="headerlink" title="spj判断数组之和"></a>spj判断数组之和</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">描述</span><br><span class="line">给定两个整数 n 和 m ，请你构造一个长度为 n 的正整数数组，使得其元素之和为 m 。</span><br><span class="line">保证有 n≤m 。</span><br><span class="line">输入描述：</span><br><span class="line">第一行有两个整数 n 和 m。</span><br><span class="line">输出描述：</span><br><span class="line">输出 n 个正整数，它们的和需要为 m 。</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m;</span><br><span class="line">    cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="type">int</span> sum =<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">        sum+=i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sum==m)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            cout &lt;&lt; i &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (m==n)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i =<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">            cout &lt;&lt; <span class="number">1</span> &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; m-n<span class="number">+1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/23/%E8%AF%A6%E8%A7%A3TEA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/23/%E8%AF%A6%E8%A7%A3TEA/" class="post-title-link" itemprop="url">详解TEA</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-03-23 21:15:30 / 修改时间：23:52:34" itemprop="dateCreated datePublished" datetime="2025-03-23T21:15:30+08:00">2025-03-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/" itemprop="url" rel="index"><span itemprop="name">编码与加解密</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="TEA简介"><a href="#TEA简介" class="headerlink" title="TEA简介"></a>TEA简介</h1><p>TEA（Tiny Encryption Algorithm）是一种对称密钥分组密码算法。</p>
<p>分组长度：64位（8字节）（明文分为两个32位块，密文分为两个32位块）。</p>
<p>密钥长度：128位（16字节）（分为四个32位子密钥）。</p>
<h1 id="加密流程"><a href="#加密流程" class="headerlink" title="加密流程"></a>加密流程</h1><h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><ul>
<li><p>将64位明文分为两部分：<code>L0</code>（左32位）和 <code>R0</code>（右32位）。</p>
</li>
<li><p>初始化轮常量：<em>δ</em>&#x3D;0x9E3779B9（黄金比例相关常数，用于增强非线性）。</p>
</li>
<li><p>初始化累加变量：sum&#x3D;0。</p>
</li>
</ul>
<h2 id="轮迭代（64轮）"><a href="#轮迭代（64轮）" class="headerlink" title="轮迭代（64轮）"></a>轮迭代（64轮）</h2><p>对于每一轮i（从0到63）</p>
<p>1.更新累加变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum=sum+δ</span><br></pre></td></tr></table></figure>

<p>2.更新左半部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">L(i+1)=Ri</span><br></pre></td></tr></table></figure>

<p>3.更新右半部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ri+1=Li+F(Ri,sum,K)</span><br></pre></td></tr></table></figure>

<h3 id="轮函数F"><a href="#轮函数F" class="headerlink" title="轮函数F"></a>轮函数F</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F(Ri,sum,K)=((Ri&lt;&lt;4)+Kleft)⊕(Ri+sum)⊕((Ri&gt;&gt;5)+Kright)</span><br></pre></td></tr></table></figure>

<h3 id="Kleft和Kright"><a href="#Kleft和Kright" class="headerlink" title="Kleft和Kright"></a>Kleft和Kright</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">偶数轮（i为偶数）：Kleft=K[0], Kright=K[1]</span><br><span class="line">奇数轮（i为奇数）：Kleft=K[2], Kright=K[3]</span><br></pre></td></tr></table></figure>

<h2 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h2><p>经过64轮后，密文为左右部分合并</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ciphertext=(L64∣∣R64)</span><br></pre></td></tr></table></figure>

<h1 id="XTEA简介"><a href="#XTEA简介" class="headerlink" title="XTEA简介"></a>XTEA简介</h1><p>XTEA（Extended TEA）是TEA（Tiny Encryption Algorithm）的改进版本。</p>
<ol>
<li><strong>密钥调度</strong>：引入更复杂的子密钥生成逻辑，避免密钥相关攻击。</li>
<li><strong>轮函数</strong>：调整位移和混合操作的顺序，增强非线性性和扩散性。</li>
<li><strong>轮常量计算</strong>：优化轮常量的使用方式，减少数学规律性。</li>
</ol>
<h2 id="算法参数"><a href="#算法参数" class="headerlink" title="算法参数"></a>算法参数</h2><ul>
<li><strong>分组长度</strong>：64位（分为两个32位块 <em>L</em> 和 <em>R</em>）。</li>
<li><strong>密钥长度</strong>：128位（16字节）（分为四个32位子密钥 <em>K</em>[0],<em>K</em>[1],<em>K</em>[2],<em>K</em>[3]）。</li>
<li><strong>加密轮数</strong>：通常为 <strong>64轮</strong>（Feistel结构）。</li>
<li><strong>安全性</strong>：抗相关密钥攻击和已知明文攻击，理论安全性优于TEA。</li>
</ul>
<h1 id="加密流程-1"><a href="#加密流程-1" class="headerlink" title="加密流程"></a>加密流程</h1><p>XTEA采用 <strong>Feistel结构</strong>，每轮操作更新左右两部分数据。</p>
<h2 id="初始化-1"><a href="#初始化-1" class="headerlink" title="初始化"></a>初始化</h2><ul>
<li>明文分为两个32位块：<em>L</em>0（左）和 <em>R</em>0（右）。</li>
<li>轮常量：<em>δ</em>&#x3D;0x9E3779B9（黄金比例相关常数）。</li>
<li>累加变量：<em>sum</em>&#x3D;0。</li>
</ul>
<h2 id="64轮迭代"><a href="#64轮迭代" class="headerlink" title="64轮迭代"></a>64轮迭代</h2><p>对于每轮 <em>i</em>（从0到63）：</p>
<p><strong>更新左半部分</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Li+1=Li+(((Ri≪4)⊕(Ri≫5))+Ri)⊕(sum+K[(sum≫11)&amp;3])</span><br></pre></td></tr></table></figure>

<p><strong>更新累加变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum=sum+δ</span><br></pre></td></tr></table></figure>

<p><strong>更新右半部分</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ri+1=Ri+(((Li+1≪4)⊕(Li+1≫5))+Li+1)⊕(sum+K[sum&amp;3])</span><br></pre></td></tr></table></figure>

<h2 id="合并-1"><a href="#合并-1" class="headerlink" title="合并"></a>合并</h2><p>经过64轮后，密文为左右部分合并：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ciphertext=(L64∣∣R64)</span><br></pre></td></tr></table></figure>

<h1 id="XXTEA简介"><a href="#XXTEA简介" class="headerlink" title="XXTEA简介"></a>XXTEA简介</h1><p>XXTEA（Corrected Block TEA）是TEA算法的最终改进版本,旨在解决TEA和XTEA在处理 <strong>可变长度数据块</strong> 时的局限性。它支持任意长度的数据块（最小64位），并在混合操作中引入更复杂的非线性逻辑，显著提升了安全性。</p>
<h2 id="核心改进"><a href="#核心改进" class="headerlink" title="核心改进"></a>核心改进</h2><ol>
<li><strong>支持可变长度数据块</strong>：可加密任意长度（≥64位）的数据，无需固定分组。</li>
<li><strong>增强的混合操作</strong>：通过多次位移和异或操作，强化非线性扩散。</li>
<li><strong>优化的密钥调度</strong>：密钥参与更分散，避免局部性弱点。</li>
</ol>
<h2 id="算法参数-1"><a href="#算法参数-1" class="headerlink" title="算法参数"></a>算法参数</h2><ul>
<li><strong>数据块长度</strong>：任意长度（最小64位，即8字节）。</li>
<li><strong>密钥长度</strong>：128位（16字节）（分为四个32位子密钥 <em>K</em>[0],<em>K</em>[1],<em>K</em>[2],<em>K</em>[3]）。</li>
<li><strong>推荐轮数</strong>：通常为 <strong>52轮</strong>（根据数据块长度动态调整）。</li>
<li><strong>安全性</strong>：抗已知明文攻击和选择密文攻击，安全性优于XTEA。</li>
</ul>
<h1 id="加密流程-2"><a href="#加密流程-2" class="headerlink" title="加密流程"></a>加密流程</h1><p>XXTEA采用 <strong>整块混合迭代</strong> 而非Feistel结构，所有数据字参与每轮计算。</p>
<h2 id="初始化-2"><a href="#初始化-2" class="headerlink" title="初始化"></a>初始化</h2><ul>
<li>将明文分为 <em>n</em> 个32位字（<em>v</em>0,<em>v</em>1,…,<em>v**n</em>−1），<em>n</em>≥2。</li>
<li>定义轮常量：<em>δ</em>&#x3D;0x9E3779B9</li>
<li>累加变量 <em>s<strong>u</strong>m</em>&#x3D;0。</li>
</ul>
<h2 id="预处理轮次"><a href="#预处理轮次" class="headerlink" title="预处理轮次"></a>预处理轮次</h2><p><strong>计算初始轮次：</strong></p>
<p><img src="/2025/03/23/%E8%AF%A6%E8%A7%A3TEA/1.jpg"></p>
<p>例如：<em>n</em>&#x3D;4（128位数据块）→ Rounds &#x3D; 6 + 13 &#x3D; 19轮。</p>
<h2 id="轮迭代（每轮更新所有字）"><a href="#轮迭代（每轮更新所有字）" class="headerlink" title="轮迭代（每轮更新所有字）"></a>轮迭代（每轮更新所有字）</h2><p>对于每轮 <em>i</em>（从0到Rounds-1）：</p>
<p><strong>更新累加变量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sum=sum+δ</span><br></pre></td></tr></table></figure>

<p><strong>计算密钥混合索引</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e=(sum≫2)&amp;3</span><br></pre></td></tr></table></figure>

<p><strong>逐字更新数据块</strong></p>
<p>对于每个字 vj（<em>j</em> 从0到 <em>n</em>−1）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vj=vj+(((vj−1≪4)⊕(vj+1≫5))+vj+1)⊕(sum+K[(j&amp;3)⊕e])</span><br></pre></td></tr></table></figure>

<p><strong>边界处理</strong>：</p>
<ul>
<li><em>v</em>−1&#x3D;<em>vn</em>−1（当 <em>j</em>&#x3D;0 时）。</li>
<li><em>vn</em>&#x3D;<em>v</em>0（当 <em>j</em>&#x3D;<em>n</em>−1 时）。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/23/%E8%AF%A6%E8%A7%A3SM3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/23/%E8%AF%A6%E8%A7%A3SM3/" class="post-title-link" itemprop="url">详解SM3</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-03-23 18:14:29 / 修改时间：19:57:59" itemprop="dateCreated datePublished" datetime="2025-03-23T18:14:29+08:00">2025-03-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/" itemprop="url" rel="index"><span itemprop="name">编码与加解密</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SM3介绍"><a href="#SM3介绍" class="headerlink" title="SM3介绍"></a>SM3介绍</h1><p><strong>SM3</strong> 是中国国家密码管理局发布的密码杂凑算法（Hash Algorithm），SM3 是一种密码学安全哈希函数，用于生成固定长度的消息摘要（通常为 256 比特），广泛应用于数字签名、消息认证码、数据完整性校验等领域。</p>
<h1 id="初始向量"><a href="#初始向量" class="headerlink" title="初始向量"></a>初始向量</h1><p>8个32位寄存器IV</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">H0=A=0x7380166F,</span><br><span class="line">H1=B=0x4914B2B9,</span><br><span class="line">H2=C=0x172442D7,</span><br><span class="line">H3=D=0xDA8A0600,</span><br><span class="line">H4=E=0xA96F30BC,</span><br><span class="line">H5=F=0x163138AA,</span><br><span class="line">H6=G=0xE38DEE4D,</span><br><span class="line">H7=H=0xB0FB0E4E</span><br></pre></td></tr></table></figure>

<h1 id="消息预处理"><a href="#消息预处理" class="headerlink" title="消息预处理"></a>消息预处理</h1><h2 id="消息填充"><a href="#消息填充" class="headerlink" title="消息填充"></a>消息填充</h2><p>把输入数据填充到64字节（512位）的倍数（最少填充9个字节，最多填充64+8个字节）。</p>
<p><strong>填充方式：</strong></p>
<ul>
<li>在原始数据的后面填充0x80</li>
<li>填充N个0</li>
<li>使用大端序在最后8个字节填充输入数据的bit长度</li>
</ul>
<h2 id="分组处理"><a href="#分组处理" class="headerlink" title="分组处理"></a>分组处理</h2><p>将填充后的消息划分为 512 比特的分组<code>Bi</code>，每个分组划分为16个32比特字W0，W1，W2，W3 … … W15（大端序）</p>
<h2 id="消息扩展"><a href="#消息扩展" class="headerlink" title="消息扩展"></a>消息扩展</h2><p>把16个32比特字扩展为132个32比特字（前68个字，后64个字）</p>
<h3 id="前68个字"><a href="#前68个字" class="headerlink" title="前68个字"></a>前68个字</h3><p>初始16个字来自分组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wj=Wj(i)0≤j≤15</span><br></pre></td></tr></table></figure>

<p>后续的52个字</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wj=P1(W(j−16)⊕W(j−9)⊕(W(j−3)&lt;&lt;&lt;15))⊕(W(j−13)&lt;&lt;&lt;7)⊕W(j−6),16≤j≤67</span><br></pre></td></tr></table></figure>

<h4 id="置换函数P1-X"><a href="#置换函数P1-X" class="headerlink" title="置换函数P1(X)"></a>置换函数P1(X)</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P1(X)=X⊕(X&lt;&lt;&lt;15)⊕(X&lt;&lt;&lt;23)</span><br></pre></td></tr></table></figure>

<p>通过循环移位和异或操作，破坏输入数据的线性结构，增强扩散性。</p>
<h3 id="后64个字"><a href="#后64个字" class="headerlink" title="后64个字"></a>后64个字</h3><p>直接由前68个字生成</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Wj′=Wj⊕W(j+4),0≤j≤63</span><br></pre></td></tr></table></figure>

<p>这样就得到了132个32比热的字</p>
<h1 id="迭代压缩"><a href="#迭代压缩" class="headerlink" title="迭代压缩"></a>迭代压缩</h1><p>将消息扩展后的132个字（<code>Wj </code>和 <code>Wj′</code>）与初始向量（<code>IV</code>）结合，通过多轮非线性操作生成最终的256位哈希值。</p>
<h2 id="加载初始值"><a href="#加载初始值" class="headerlink" title="加载初始值"></a>加载初始值</h2><p>初始寄存器值 <em>V</em>(<em>i</em>)&#x3D;(<em>A</em>,<em>B</em>,<em>C</em>,<em>D</em>,<em>E</em>,<em>F</em>,<em>G</em>,<em>H</em>)。</p>
<p>如果是第一个分组，<em>V</em>(0) 为IV；后续分组使用前一分组的输出。</p>
<h2 id="64轮迭代更新"><a href="#64轮迭代更新" class="headerlink" title="64轮迭代更新"></a>64轮迭代更新</h2><h3 id="轮常量Tj"><a href="#轮常量Tj" class="headerlink" title="轮常量Tj"></a>轮常量Tj</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Tj=</span><br><span class="line">&#123; </span><br><span class="line">	0x79CC4519, 0≤j≤15(前16轮)</span><br><span class="line">	0x7A879D8A, 16≤j≤63(后48轮)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="逻辑函数FFj和GGj"><a href="#逻辑函数FFj和GGj" class="headerlink" title="逻辑函数FFj和GGj"></a>逻辑函数FFj和GGj</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FFj(X,Y,Z) = X⊕Y⊕Z		GGj(X,Y,Z)=X⊕Y⊕Z	,0≤j≤15(前16轮)</span><br><span class="line">FFj(X,Y,Z) = (X&amp;Y)|(X&amp;Z)|(Y&amp;Z)			,16≤j≤63(后48轮)</span><br><span class="line">GGj(X,Y,Z) = (X&amp;Y)|(~X&amp;Z)				,16≤j≤63(后48轮)</span><br></pre></td></tr></table></figure>



<h3 id="以第j轮迭代流程为例"><a href="#以第j轮迭代流程为例" class="headerlink" title="以第j轮迭代流程为例"></a>以第j轮迭代流程为例</h3><h4 id="计算中间变量SS1-和-SS2"><a href="#计算中间变量SS1-和-SS2" class="headerlink" title="计算中间变量SS1 和 SS2"></a>计算中间变量SS1 和 SS2</h4><p>结合寄存器和轮常量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SS1=((A&lt;&lt;&lt;12)+E+(Tj&lt;&lt;&lt;j))&lt;&lt;&lt;7</span><br><span class="line">SS2=(SS1⊕A&lt;&lt;&lt;12)</span><br></pre></td></tr></table></figure>

<h4 id="计算临时变量TT1和TT2"><a href="#计算临时变量TT1和TT2" class="headerlink" title="计算临时变量TT1和TT2"></a>计算临时变量TT1和TT2</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TT1 = FFj(A,B,C) + D + SS2 + Wj&#x27;</span><br><span class="line">TT2 = GGj(E,F,G) + H + SS1 + Wj</span><br></pre></td></tr></table></figure>

<h4 id="更新寄存器"><a href="#更新寄存器" class="headerlink" title="更新寄存器"></a>更新寄存器</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">D=C</span><br><span class="line">C=B&lt;&lt;&lt;9</span><br><span class="line">B=A</span><br><span class="line">A=TT1</span><br><span class="line">H=G</span><br><span class="line">G=F&lt;&lt;&lt;9</span><br><span class="line">F=E</span><br><span class="line">E=P0(TT2)</span><br></pre></td></tr></table></figure>

<h5 id="置换函数P0"><a href="#置换函数P0" class="headerlink" title="置换函数P0"></a>置换函数P0</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">P0(X)=X⊕(X&lt;&lt;&lt;9)⊕(X&lt;&lt;&lt;17)</span><br></pre></td></tr></table></figure>

<h1 id="结果输出"><a href="#结果输出" class="headerlink" title="结果输出"></a>结果输出</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">H0=H0⊕A，H1=H1⊕B，H2=H2⊕C，H3=H3⊕D，H4=H4⊕E，H5=H5⊕F，H6=H6⊕G，H7=H7⊕H</span><br></pre></td></tr></table></figure>

<p>按照大端序排列输出</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/20/Python%E8%84%9A%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/20/Python%E8%84%9A%E6%9C%AC/" class="post-title-link" itemprop="url">Python脚本</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-03-20 23:38:59" itemprop="dateCreated datePublished" datetime="2025-03-20T23:38:59+08:00">2025-03-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-31 16:37:50" itemprop="dateModified" datetime="2025-03-31T16:37:50+08:00">2025-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="数据类型转换"><a href="#数据类型转换" class="headerlink" title="数据类型转换"></a>数据类型转换</h1><h2 id="转为int类型"><a href="#转为int类型" class="headerlink" title="转为int类型"></a><strong>转为int类型</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串转整数</span></span><br><span class="line">num = <span class="built_in">int</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(num)  <span class="comment"># 输出: 123</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 浮点数转整数（截断小数部分）</span></span><br><span class="line">num = <span class="built_in">int</span>(<span class="number">3.14</span>)</span><br><span class="line"><span class="built_in">print</span>(num)  <span class="comment"># 输出: 3</span></span><br></pre></td></tr></table></figure>

<h2 id="转为float类型"><a href="#转为float类型" class="headerlink" title="转为float类型"></a><strong>转为float类型</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串转浮点数</span></span><br><span class="line">num = <span class="built_in">float</span>(<span class="string">&quot;3.14&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(num)  <span class="comment"># 输出: 3.14</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 整数转浮点数</span></span><br><span class="line">num = <span class="built_in">float</span>(<span class="number">123</span>)</span><br><span class="line"><span class="built_in">print</span>(num)  <span class="comment"># 输出: 123.0</span></span><br></pre></td></tr></table></figure>

<h2 id="转为str类型"><a href="#转为str类型" class="headerlink" title="转为str类型"></a><strong>转为str类型</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 整数转字符串</span></span><br><span class="line">text = <span class="built_in">str</span>(<span class="number">123</span>)</span><br><span class="line"><span class="built_in">print</span>(text)  <span class="comment"># 输出: &quot;123&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 浮点数转字符串</span></span><br><span class="line">text = <span class="built_in">str</span>(<span class="number">3.14</span>)</span><br><span class="line"><span class="built_in">print</span>(text)  <span class="comment"># 输出: &quot;3.14&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="转为bin二进制类型"><a href="#转为bin二进制类型" class="headerlink" title="转为bin二进制类型"></a><strong>转为bin二进制类型</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 整数转二进制字符串</span></span><br><span class="line">bin_str = <span class="built_in">bin</span>(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(bin_str)  <span class="comment"># 输出: &#x27;0b1010&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 二进制字符串转整数</span></span><br><span class="line">num = <span class="built_in">int</span>(<span class="string">&quot;0b1010&quot;</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(num)  <span class="comment"># 输出: 10</span></span><br></pre></td></tr></table></figure>

<h2 id="转为hex十六进制"><a href="#转为hex十六进制" class="headerlink" title="转为hex十六进制"></a><strong>转为hex十六进制</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 整数转十六进制字符串</span></span><br><span class="line">hex_str = <span class="built_in">hex</span>(<span class="number">255</span>)</span><br><span class="line"><span class="built_in">print</span>(hex_str)  <span class="comment"># 输出: &#x27;0xff&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="字符串与字节序列"><a href="#字符串与字节序列" class="headerlink" title="字符串与字节序列"></a><strong>字符串与字节序列</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;hello world&quot;</span></span><br><span class="line">str2bytes = <span class="built_in">str</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(str2bytes)</span><br><span class="line">// <span class="string">b&#x27;hello world&#x27;</span></span><br><span class="line"></span><br><span class="line">bytes2str = str2bytes.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(bytes2str)</span><br><span class="line">// hello world</span><br></pre></td></tr></table></figure>

<h2 id="字节序列与列表"><a href="#字节序列与列表" class="headerlink" title="字节序列与列表"></a><strong>字节序列与列表</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;hello world&quot;</span></span><br><span class="line">str2bytes = <span class="built_in">str</span>.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">bytes2list = <span class="built_in">list</span>(str2bytes)</span><br><span class="line"><span class="built_in">print</span>(bytes2list)</span><br><span class="line">// [<span class="number">104</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">32</span>, <span class="number">119</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">list2bytes = <span class="built_in">bytes</span>(bytes2list)</span><br><span class="line"><span class="built_in">print</span>(list2bytes)</span><br><span class="line">// <span class="string">b&#x27;hello world&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="int类型转字节序列，可指定字节长度和字节顺序"><a href="#int类型转字节序列，可指定字节长度和字节顺序" class="headerlink" title="int类型转字节序列，可指定字节长度和字节顺序"></a><strong>int类型转字节序列，可指定字节长度和字节顺序</strong></h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span>.to_bytes(length, byteorder, *, signed=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">// length:指定字节序列的长度</span><br><span class="line">// byteorder:指定字节顺序 <span class="string">&#x27;big&#x27;</span>：大端序（高位字节在前） <span class="string">&#x27;little&#x27;</span>：小端序（低位字节在前）</span><br><span class="line">// signed:指定整数是否为有符号整数，默认为 <span class="literal">False</span>（无符号整数）。如果为 <span class="literal">True</span>，则支持负数的转换。</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tt = <span class="number">0x123456789abcdef</span></span><br><span class="line">bytes_big = tt.to_bytes(<span class="number">8</span>,<span class="string">&quot;big&quot;</span>)</span><br><span class="line">bytes_little = tt.to_bytes(<span class="number">8</span>,<span class="string">&quot;little&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;bytes_big:&quot;</span>,bytes_big)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;list_bytes_big:&quot;</span>,<span class="built_in">list</span>(bytes_big))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;bytes_little:&quot;</span>,bytes_little)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;list_bytes_little:&quot;</span>,<span class="built_in">list</span>(bytes_little))</span><br><span class="line"></span><br><span class="line">bytes_big: <span class="string">b&#x27;\x01#Eg\x89\xab\xcd\xef&#x27;</span></span><br><span class="line">list_bytes_big [<span class="number">1</span>, <span class="number">35</span>, <span class="number">69</span>, <span class="number">103</span>, <span class="number">137</span>, <span class="number">171</span>, <span class="number">205</span>, <span class="number">239</span>]</span><br><span class="line">bytes_little: <span class="string">b&#x27;\xef\xcd\xab\x89gE#\x01&#x27;</span></span><br><span class="line">list_bytes_little [<span class="number">239</span>, <span class="number">205</span>, <span class="number">171</span>, <span class="number">137</span>, <span class="number">103</span>, <span class="number">69</span>, <span class="number">35</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int.from_bytes()</span><br></pre></td></tr></table></figure>



<h2 id="hexstr2barr"><a href="#hexstr2barr" class="headerlink" title="hexstr2barr"></a>hexstr2barr</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hexstr2barr</span>(<span class="params"><span class="built_in">hex</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>))</span><br></pre></td></tr></table></figure>






      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/16/%E8%AF%A6%E8%A7%A3SM4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/16/%E8%AF%A6%E8%A7%A3SM4/" class="post-title-link" itemprop="url">详解SM4</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-03-16 11:23:57 / 修改时间：13:08:07" itemprop="dateCreated datePublished" datetime="2025-03-16T11:23:57+08:00">2025-03-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/" itemprop="url" rel="index"><span itemprop="name">编码与加解密</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="SM4简介"><a href="#SM4简介" class="headerlink" title="SM4简介"></a>SM4简介</h1><p>SM4是中国国家密码管理局（GM&#x2F;T 0002-2012）发布的商用分组密码算法，属于对称加密算法。</p>
<p>类型：对称分组加密</p>
<p><strong>分组长度</strong>：128位（16字节）</p>
<p><strong>密钥长度</strong>：128位（16字节）</p>
<p><strong>迭代轮数</strong>：32轮</p>
<p><strong>设计结构</strong>：基于Feistel网络结构，但实际采用更高效的<strong>非线性迭代结构</strong>。</p>
<h1 id="加密流程"><a href="#加密流程" class="headerlink" title="加密流程"></a>加密流程</h1><h2 id="明文处理"><a href="#明文处理" class="headerlink" title="明文处理"></a>明文处理</h2><p>将128位明文分为4个32位字（大端序存储）：X0，X1，X2，X3</p>
<h2 id="32轮迭代加密"><a href="#32轮迭代加密" class="headerlink" title="32轮迭代加密"></a>32轮迭代加密</h2><h3 id="轮函数"><a href="#轮函数" class="headerlink" title="轮函数"></a>轮函数</h3><p>每轮的操作公式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X&#123;i+4&#125;=Xi⊕T(X&#123;i+1&#125;⊕X&#123;i+2&#125;⊕X&#123;i+3&#125;⊕rki)</span><br><span class="line"></span><br><span class="line">// rki会在后面密钥调度中提到，这里理解为轮秘钥</span><br></pre></td></tr></table></figure>

<p>也可以把这个公式理解为轮函数F</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X&#123;i+4&#125; = F(Xi,X&#123;i+1&#125;,X&#123;i+2&#125;,X&#123;i+3&#125;) = Xi⊕T(X&#123;i+1&#125;⊕X&#123;i+2&#125;⊕X&#123;i+3&#125;⊕rki)</span><br></pre></td></tr></table></figure>

<h3 id="核心函数T"><a href="#核心函数T" class="headerlink" title="核心函数T"></a>核心函数T</h3><h4 id="S盒置换（非线性层）"><a href="#S盒置换（非线性层）" class="headerlink" title="S盒置换（非线性层）"></a>S盒置换（非线性层）</h4><p>将T函数的输入<code>X&#123;i+1&#125;⊕X&#123;i+2&#125;⊕X&#123;i+3&#125;⊕rki</code>32位拆分为4个8位字节，每个字节通过固定S盒替换（查表），得到32位的结果B.</p>
<h4 id="线性变换L（扩散层）"><a href="#线性变换L（扩散层）" class="headerlink" title="线性变换L（扩散层）"></a>线性变换L（扩散层）</h4><p>对S盒的32位输出B进行循环左移和异或</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">L(B)=B⊕(B⋘2)⊕(B⋘10)⊕(B⋘18)⊕(B⋘24)</span><br></pre></td></tr></table></figure>

<h3 id="更新寄存器"><a href="#更新寄存器" class="headerlink" title="更新寄存器"></a>更新寄存器</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X&#123;i+4&#125;=Xi⊕L(B)</span><br></pre></td></tr></table></figure>

<h2 id="反序合并"><a href="#反序合并" class="headerlink" title="反序合并"></a>反序合并</h2><p>最终输出密文时，将<em>X</em>32,<em>X</em>33,<em>X</em>34,<em>X</em>35反序排列并合并为128位。</p>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">X32=0x12345678(字A)</span><br><span class="line">X33=0x9ABCDEF0(字B)</span><br><span class="line">X34=0x11223344(字C)</span><br><span class="line">X35=0x55667788(字D)</span><br></pre></td></tr></table></figure>

<p>取逆序字：<code>D=0x55667788</code>, <code>C=0x11223344</code>, <code>B=0x9ABCDEF0</code>, <code>A=0x12345678</code>。</p>
<p>按大端序合并</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cipher = 0x55667788112233449ABCDEF012345678</span><br></pre></td></tr></table></figure>

<h1 id="密钥调度"><a href="#密钥调度" class="headerlink" title="密钥调度"></a>密钥调度</h1><p>通过密钥调度生成32个轮秘钥（每轮一个，32位）。</p>
<h2 id="主密钥拆分"><a href="#主密钥拆分" class="headerlink" title="主密钥拆分"></a>主密钥拆分</h2><p>首先将128位主密钥分为4个32位字：MK0，MK1，MK2，MK3</p>
<h2 id="固定常数FK"><a href="#固定常数FK" class="headerlink" title="固定常数FK"></a>固定常数FK</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FK0=0xA3B1BAC6,</span><br><span class="line">FK1=0x56AA3350,</span><br><span class="line">FK2=0x677D9197,</span><br><span class="line">FK3=0xB27022DC.</span><br></pre></td></tr></table></figure>

<h2 id="固定参数CK"><a href="#固定参数CK" class="headerlink" title="固定参数CK"></a>固定参数CK</h2><p><img src="/2025/03/16/%E8%AF%A6%E8%A7%A3SM4/1.jpg"></p>
<h2 id="生成中间密钥"><a href="#生成中间密钥" class="headerlink" title="生成中间密钥"></a>生成中间密钥</h2><p>每个<code>MKi</code>与<code>FKi</code>异或，得到初始密钥<code>K0</code>到<code>K3</code></p>
<h2 id="迭代生成轮秘钥"><a href="#迭代生成轮秘钥" class="headerlink" title="迭代生成轮秘钥"></a>迭代生成轮秘钥</h2><p>通过32轮迭代生成后续的<code>K4</code>到<code>K35</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">├─迭代32轮：</span><br><span class="line">│   for i = 0 to 31:</span><br><span class="line">│     计算中间值 = K_&#123;i+1&#125; ⊕ K_&#123;i+2&#125; ⊕ K_&#123;i+3&#125; ⊕ CK_i</span><br><span class="line">│     │</span><br><span class="line">│     ├─S盒置换（4字节查表）</span><br><span class="line">│     │</span><br><span class="line">│     └─线性变换L&#x27;（循环左移13、23位后异或）</span><br><span class="line">│     生成 K_&#123;i+4&#125; = K_i ⊕ T&#x27;(中间值)</span><br><span class="line">│     保存 rk_i = K_&#123;i+4&#125;</span><br></pre></td></tr></table></figure>

<h3 id="T’函数"><a href="#T’函数" class="headerlink" title="T’函数"></a>T’函数</h3><p>与加密过程中的T函数类似，S盒置换与加密算法中的S盒算法相同，有区别的是线性替换L’</p>
<h3 id="线性变换L′"><a href="#线性变换L′" class="headerlink" title="线性变换L′"></a>线性变换L′</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">L′(B)=B⊕(B⋘13)⊕(B⋘23)</span><br></pre></td></tr></table></figure>

<h2 id="流程总结"><a href="#流程总结" class="headerlink" title="流程总结"></a>流程总结</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">主密钥 (128位)</span><br><span class="line">│</span><br><span class="line">├─拆分为 MK₀, MK₁, MK₂, MK₃</span><br><span class="line">│</span><br><span class="line">├─异或 FK₀-FK₃ → 生成 K₀-K₃</span><br><span class="line">│</span><br><span class="line">├─迭代32轮：</span><br><span class="line">│   for i = 0 to 31:</span><br><span class="line">│     计算中间值 = K_&#123;i+1&#125; ⊕ K_&#123;i+2&#125; ⊕ K_&#123;i+3&#125; ⊕ CK_i</span><br><span class="line">│     │</span><br><span class="line">│     ├─S盒置换（4字节查表）</span><br><span class="line">│     │</span><br><span class="line">│     └─线性变换L&#x27;（循环左移13、23位后异或）</span><br><span class="line">│     生成 K_&#123;i+4&#125; = K_i ⊕ T&#x27;(中间值)</span><br><span class="line">│     保存 rk_i = K_&#123;i+4&#125;</span><br><span class="line">│</span><br><span class="line">└─输出轮密钥 rk_0, rk_1, ..., rk_31</span><br></pre></td></tr></table></figure>






      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/" class="post-title-link" itemprop="url">某幸白盒AES</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-03-15 17:02:12 / 修改时间：17:07:25" itemprop="dateCreated datePublished" datetime="2025-03-15T17:02:12+08:00">2025-03-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>20 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.lucky.luckyclient</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/1.jpg"></p>
<h2 id="过检测"><a href="#过检测" class="headerlink" title="过检测"></a>过检测</h2><p>root检测：使用狐妖面具隐藏列表实现绕过</p>
<p>360加固：使用脱壳网站脱壳 <a target="_blank" rel="noopener" href="https://56.al/">56.al</a></p>
<p>frida检测：使用小工具</p>
<h2 id="逆向目标"><a href="#逆向目标" class="headerlink" title="逆向目标"></a>逆向目标</h2><p><code>com.luckincoffee.safeboxlib.CryptoHelper</code>类下的<code>localAESWork()</code>方法</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/2.jpg"></p>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p><code>localAESWork()</code>这个方法被通类下的<code>c</code>方法调用</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> String <span class="title function_">c</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    <span class="type">c</span> <span class="variable">cVar</span> <span class="operator">=</span> <span class="built_in">this</span>.f93097a;</span><br><span class="line">    <span class="keyword">if</span> (cVar == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(StubApp.getString2(<span class="string">&quot;32267&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> cVar.a();</span><br><span class="line">    <span class="keyword">if</span> (TextUtils.isEmpty(a10)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        str2 = <span class="keyword">new</span> <span class="title class_">String</span>(Base64.encode(localAESWork(str.getBytes(), <span class="number">2</span>, Base64.decode(a10.replace(org.objectweb.asm.signature.b.f127225c, org.objectweb.asm.signature.b.f127224b).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes(), <span class="number">2</span>)), <span class="number">2</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e10) &#123;</span><br><span class="line">        e10.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str2.replace(org.objectweb.asm.signature.b.f127224b, org.objectweb.asm.signature.b.f127225c).replace(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>单独看与<code>localAESWork</code>有关的，如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">str2 = <span class="keyword">new</span> <span class="title class_">String</span>(</span><br><span class="line">    Base64.encode(</span><br><span class="line">        localAESWork(str.getBytes(), <span class="number">2</span>, </span><br><span class="line">                     Base64.decode(a10.replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;+&quot;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes(), <span class="number">2</span>)</span><br><span class="line">                    ), </span><br><span class="line">        <span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对原始字符串str进行AES加密</span></span><br><span class="line"><span class="comment">// 将a10中的&quot;-&quot;替换为&quot;+&quot;、&quot;_&quot;替换为&quot;/&quot;，然后解码为base64字节数组</span></span><br><span class="line"><span class="comment">// 对加密结果进行Base64编码</span></span><br><span class="line"><span class="comment">// Base64的第二个参数2代表URL安全的标准Base64</span></span><br></pre></td></tr></table></figure>

<p>获取<code>a10</code>的值</p>
<p>它是一个接口，我们找到接口的实现类，然后进行hook</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">get_a10</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> a = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.lucky.lib.http2.b$a&quot;</span>).$new();</span><br><span class="line">        <span class="keyword">let</span> result = a.<span class="title function_">a</span>();</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a10:&quot;</span>,result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主动调用，输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a10: gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=</span><br></pre></td></tr></table></figure>

<h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><p>先使用<code>get_quic_code</code>脚本获取<code>jinCode</code></p>
<p>我这里是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;size&quot;:40,&quot;offset&quot;:&#123;&quot;jniCode&quot;:24,&quot;quickCode&quot;:32,&quot;accessFlags&quot;:4&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>然后通过如下脚本打印函数id(artmethodid)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoadersSync</span>().<span class="title function_">forEach</span>(<span class="function"><span class="params">classLoader</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(classLoader.<span class="title function_">loadClass</span>(<span class="string">&quot;com.alibaba.android.arouter.launcher.a&quot;</span>))&#123;</span><br><span class="line">                    <span class="title class_">Java</span>.<span class="property">classFactory</span>.<span class="property">loader</span> = classLoader;</span><br><span class="line">                    <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">CryptoHelper</span>.<span class="property">$l</span>.<span class="title function_">find</span>(<span class="string">&quot;localAESWork&quot;</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span>(a)&#123;</span><br><span class="line">    </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook</span>()</span><br></pre></td></tr></table></figure>

<p>输出</p>
<p><code>m</code>代表method，<code>s</code>代表<code>static</code>，后面是artmethodid</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m:s0x78c6261350</span><br></pre></td></tr></table></figure>

<p><code>artmethodid</code>加上<code>jniCode</code>就是函数的地址</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">ptr</span>(<span class="number">0x78c6261350</span>).<span class="title function_">add</span>(<span class="number">24</span>).<span class="title function_">readPointer</span>());</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x7868699ed8</span><br></pre></td></tr></table></figure>

<p>根据这个地址就可以获取函数的地址和偏移量了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Process</span>.<span class="title function_">findModuleByAddress</span>(<span class="title function_">ptr</span>(<span class="number">0x7868699ed8</span>)).<span class="property">name</span>);             <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">ptr</span>(<span class="number">0x7868699ed8</span>).<span class="title function_">sub</span>(<span class="title class_">Process</span>.<span class="title function_">findModuleByAddress</span>(<span class="title function_">ptr</span>(<span class="title function_">ptr</span>(<span class="number">0x7868699ed8</span>))).<span class="property">base</span>));</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">libcryptoDD.so</span><br><span class="line">0x41ed8</span><br></pre></td></tr></table></figure>

<h2 id="抓个包"><a href="#抓个包" class="headerlink" title="抓个包"></a>抓个包</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">utl:</span><br><span class="line">https://capi.lkcoffee.com/resource/m/user/login</span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">  &quot;x-lk-akv&quot;: &quot;5.3.15&quot;,</span><br><span class="line">  &quot;x-lk-mid&quot;: &quot;&quot;,</span><br><span class="line">  &quot;x-lk-sid&quot;: &quot;&quot;,</span><br><span class="line">  &quot;x-business-language&quot;: &quot;zh-CN&quot;,</span><br><span class="line">  &quot;x-business-regioncode&quot;: &quot;CN&quot;,</span><br><span class="line">  &quot;event_id&quot;: &quot;1741972196535&quot;,</span><br><span class="line">  &quot;x-lk-csid&quot;: &quot;38e7641d-7f62-44e9-bb24-2beca40b68bc&quot;,</span><br><span class="line">  &quot;cookie&quot;: &quot;uid=b4e31b9d-d7ab-40a9-9b64-14e52f633b911741972183784&quot;,</span><br><span class="line">  &quot;content-type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="line">  &quot;content-length&quot;: &quot;704&quot;,</span><br><span class="line">  &quot;accept-encoding&quot;: &quot;gzip&quot;,</span><br><span class="line">  &quot;user-agent&quot;: &quot;okhttp/4.9.3&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body=&#123;</span><br><span class="line">  &quot;sign&quot;: &quot;997653005130164991918737828941799149694&quot;,</span><br><span class="line">  &quot;q&quot;: &quot;veIdVUqstntHvdzxURbvo9_8_soZQht-Vv8TOV4GNTFKY6eV5ccjTgjpUT5CJprcq7Cm5fuzbAvdlfrSQP4ygoeGnUubcH0XonTCzfIs4RYqF7kOdlbEDxFl84iVqKnFQX0Bg2K7cuqYRTR1YkyBckbtvaPOFk-F9jt8cNUe_PFp-oiwzzex5tcqLefG2ZmVBuWJlarfJP4h-XtNmdYpWm5k4_4jhldfVngv29YLYv8GO7m4RQCdDgoydMbu2adjsKsEKy_oWLC2a50RpV_9Yd-AcAGU4OLg3vzL9HqBNttDo6M_bylZJmvYurt3CTn4cvrX3wu0aGPMYr2rBpEEtT062cD7qL7F2mLfqeH8ijsggM0_eqqqk4m2S1dOqky_WXSVbluyFcUQBPUernSXKvLnsLCLgDUVsVeTdpXvt_UP8ia6R6IHhDXkqzjBiCWQqAAOjwfd5shrgNPRNP_h7NpjwwCfK5zJ3g1T9j084UnGoiGQo2cpvBhMWH8RTXAKI7i8K1ZgvGkzHiYAE5zN35WnsNd7ma-61nrItQzMo-TIDr-IIFlv199ErBcCs1Yl&quot;,</span><br><span class="line">  &quot;uid&quot;: &quot;b4e31b9d-d7ab-40a9-9b64-14e52f633b911741972183784&quot;,</span><br><span class="line">  &quot;t&quot;: &quot;1741972256316&quot;,</span><br><span class="line">  &quot;cid&quot;: &quot;210101&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response:</span><br><span class="line">57l6aGIjM8ySP5qUW5cmXG_swqXZ3-CDvlz4K-CW5JHHIAiIXoiAtXFef1i898pFnXG2UaYYFPgo4B-QISWmwxGVgzf63I98g8s1TCjJ2qHAI2q4UI-IP1nRHfLevhZ8Kgx6gyMYgsoibWQJ_IU1cONmes8MQqWG3BlsfA7TAVesjF0N3KaEEfHH0RONmDSU3hSp9D9T3nl-xsHSpLBlPQPQRsLBEHzAgEeKO5EueBVpw8cCq3WnWYGT_Ai2TxBpFIImOPBAMnR-T3lHx0D4Pp-iF9p7c_xa8Ek3IhwVx5m8lpQCuAta8PG1ffVGX7Pgr82woPcekBWvF9qFV4kiabebYKsMQHmAbnNfKxLsSEs=</span><br></pre></td></tr></table></figure>



<h2 id="Unidbg初始环境搭建"><a href="#Unidbg初始环境搭建" class="headerlink" title="Unidbg初始环境搭建"></a>Unidbg初始环境搭建</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> <span class="keyword">extends</span> <span class="title class_">AbstractJni</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AndroidEmulator emulator;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">process</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Memory memory;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VM vm;</span><br><span class="line">    <span class="keyword">private</span> DalvikModule dm;</span><br><span class="line">    <span class="keyword">private</span> Module cryptoDDmodule;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Test</span><span class="params">()</span> &#123;</span><br><span class="line">        emulator = AndroidEmulatorBuilder</span><br><span class="line">                .for64Bit() <span class="comment">// for32Bit()</span></span><br><span class="line">                .setProcessName(process)</span><br><span class="line">                .setRootDir(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;target/rootfs&quot;</span>))</span><br><span class="line">                .addBackendFactory(<span class="keyword">new</span> <span class="title class_">Unicorn2Factory</span>(<span class="literal">true</span>))</span><br><span class="line">                .build();</span><br><span class="line">        memory = emulator.getMemory();</span><br><span class="line">        memory.setLibraryResolver(<span class="keyword">new</span> <span class="title class_">AndroidResolver</span>(<span class="number">23</span>));</span><br><span class="line">        vm = emulator.createDalvikVM(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;apktest/ruixingcoffee_5.2.65.apk&quot;</span>));</span><br><span class="line">        vm.setJni(<span class="built_in">this</span>);</span><br><span class="line">        vm.setVerbose(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">AndroidModule</span>(emulator,vm).register(memory);</span><br><span class="line">        dm = vm.loadLibrary(<span class="string">&quot;cryptoDD&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        dm.callJNI_OnLoad(emulator);</span><br><span class="line">        cryptoDDmodule = dm.getModule();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> <span class="string">&quot;gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>;</span><br><span class="line">        <span class="type">byte</span>[] decode_a10 = Base64.getDecoder().decode(a10.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes());</span><br><span class="line">        <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">                <span class="string">&quot;xiaojia&quot;</span>.getBytes(),</span><br><span class="line">                <span class="number">2</span>,</span><br><span class="line">                decode_a10);</span><br><span class="line">        <span class="type">String</span> <span class="variable">b64encoded</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(byteValues.getValue());</span><br><span class="line">        System.out.println(b64encoded);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Test</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line">        test.localAESWork();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下，报错了，根据unidbg的日志提示，如下，是写入内存失败了</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/3.jpg"></p>
<p>可以通过trace断在报错的位置</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> <span class="string">&quot;gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] decode_a10 = Base64.getDecoder().decode(a10.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes());</span><br><span class="line">    <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加trace</span></span><br><span class="line">    emulator.traceCode(cryptoDDmodule.base,cryptoDDmodule.base+cryptoDDmodule.size);</span><br><span class="line">    </span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;xiaojia&quot;</span>.getBytes(),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            decode_a10);</span><br><span class="line">    <span class="type">String</span> <span class="variable">b64encoded</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(byteValues.getValue());</span><br><span class="line">    System.out.println(b64encoded);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看输出日志</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[16:56:56 473][libcryptoDD.so 0x17e64] [11de47f9] 0x12017e64: &quot;ldr x17, [x16, #0xfb8]&quot; x16=0x1204b000 =&gt; x17=0x121bbac0</span><br><span class="line">[16:56:56 473][libcryptoDD.so 0x17e68] [10e23e91] 0x12017e68: &quot;add x16, x16, #0xfb8&quot; x16=0x1204b000 =&gt; x16=0x1204bfb8</span><br><span class="line">[16:56:56 473][libcryptoDD.so 0x17e6c] [20021fd6] 0x12017e6c: &quot;br x17&quot; x17=0x121bbac0Exception in thread &quot;main&quot; java.lang.NullPointerException: Cannot invoke &quot;com.github.unidbg.linux.android.dvm.array.ByteArray.getValue()&quot; because &quot;byteValues&quot; is null</span><br><span class="line">	at com.luckincoffee.safeboxlib.Test.localAESWork(Test.java:62)</span><br><span class="line">	at com.luckincoffee.safeboxlib.Test.main(Test.java:68)</span><br></pre></td></tr></table></figure>

<p>最后是在<code>0x17e6c</code>这个地方停了下来</p>
<p>到IDA里面去看</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/4.jpg"></p>
<p>是一个free函数，Unidbg无法处理这个函数</p>
<p>我们用HookZz来处理，同时把trace关掉</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//        修复free函数</span></span><br><span class="line">    <span class="type">HookZz</span> <span class="variable">hookZz</span> <span class="operator">=</span> HookZz.getInstance(emulator);</span><br><span class="line">    <span class="type">Module</span> <span class="variable">module</span> <span class="operator">=</span> memory.findModule(<span class="string">&quot;libc.so&quot;</span>);</span><br><span class="line">    hookZz.replace(<span class="keyword">module</span>.findSymbolByName(<span class="string">&quot;free&quot;</span>).getAddress(), <span class="keyword">new</span> <span class="title class_">ReplaceCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HookStatus <span class="title function_">onCall</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> info)</span> &#123;</span><br><span class="line">            <span class="type">RegisterContext</span> <span class="variable">rc</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">            <span class="keyword">return</span> HookStatus.RET(emulator, rc.getLRPointer().toIntPeer());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> <span class="string">&quot;gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] decode_a10 = Base64.getDecoder().decode(a10.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes());</span><br><span class="line">    <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">	<span class="comment">// 关trace</span></span><br><span class="line">    <span class="comment">// emulator.traceCode(cryptoDDmodule.base,cryptoDDmodule.base+cryptoDDmodule.size);</span></span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;xiaojia&quot;</span>.getBytes(),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            decode_a10);</span><br><span class="line">    <span class="type">String</span> <span class="variable">b64encoded</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(byteValues.getValue());</span><br><span class="line">    System.out.println(b64encoded);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下，输出结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sroyS1xvlvLB1iUSzRC2yw==</span><br></pre></td></tr></table></figure>

<h2 id="加密方式"><a href="#加密方式" class="headerlink" title="加密方式"></a>加密方式</h2><h3 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h3><p>将明文分割为固定大小的块（例如 AES 的 128 位块），每个块独立加密。</p>
<p><strong>相同明文块</strong>加密后生成<strong>相同密文块</strong>，没有块之间的关联性。</p>
<p>例如：如果两个明文块内容相同，加密后的密文块也相同。</p>
<p>如下</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/5.jpg"></p>
<h3 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a>CBC</h3><p>每个明文块在加密前会与<strong>前一个密文块</strong>进行异或（XOR）操作（第一个块使用初始化向量 IV）。</p>
<p>块之间存在链式依赖，<strong>相同明文块</strong>加密后生成<strong>不同密文块</strong>。</p>
<p>例如：即使两个明文块相同，加密后的密文块也不同。</p>
<h3 id="确定加密方式"><a href="#确定加密方式" class="headerlink" title="确定加密方式"></a>确定加密方式</h3><p>我们可以传入相同的字符的明文，然后看输出有没有重复</p>
<p>将加密结果转为hex编码，然后搜索看有没有重复的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//        修复free函数</span></span><br><span class="line">    <span class="type">HookZz</span> <span class="variable">hookZz</span> <span class="operator">=</span> HookZz.getInstance(emulator);</span><br><span class="line">    <span class="type">Module</span> <span class="variable">module</span> <span class="operator">=</span> memory.findModule(<span class="string">&quot;libc.so&quot;</span>);</span><br><span class="line">    hookZz.replace(<span class="keyword">module</span>.findSymbolByName(<span class="string">&quot;free&quot;</span>).getAddress(), <span class="keyword">new</span> <span class="title class_">ReplaceCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HookStatus <span class="title function_">onCall</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> info)</span> &#123;</span><br><span class="line">            <span class="type">RegisterContext</span> <span class="variable">rc</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">            <span class="keyword">return</span> HookStatus.RET(emulator, rc.getLRPointer().toIntPeer());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> <span class="string">&quot;gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] decode_a10 = Base64.getDecoder().decode(a10.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes());</span><br><span class="line">    <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;xiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaaxiaojiaa&quot;</span>.getBytes(),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            decode_a10);</span><br><span class="line">    System.out.println(Hex.encodeHex(byteValues.getValue()));</span><br><span class="line"><span class="comment">//        String b64encoded = Base64.getEncoder().encodeToString(byteValues.getValue());</span></span><br><span class="line"><span class="comment">//        System.out.println(b64encoded);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如下，有重复的</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/6.jpg"></p>
<p>可以确定加密模式是ECB模式了</p>
<h2 id="trace分析"><a href="#trace分析" class="headerlink" title="trace分析"></a>trace分析</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//        修复free函数</span></span><br><span class="line">    <span class="type">HookZz</span> <span class="variable">hookZz</span> <span class="operator">=</span> HookZz.getInstance(emulator);</span><br><span class="line">    <span class="type">Module</span> <span class="variable">module</span> <span class="operator">=</span> memory.findModule(<span class="string">&quot;libc.so&quot;</span>);</span><br><span class="line">    hookZz.replace(<span class="keyword">module</span>.findSymbolByName(<span class="string">&quot;free&quot;</span>).getAddress(), <span class="keyword">new</span> <span class="title class_">ReplaceCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HookStatus <span class="title function_">onCall</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> info)</span> &#123;</span><br><span class="line">            <span class="type">RegisterContext</span> <span class="variable">rc</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">            <span class="keyword">return</span> HookStatus.RET(emulator, rc.getLRPointer().toIntPeer());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> <span class="string">&quot;gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] decode_a10 = Base64.getDecoder().decode(a10.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes());</span><br><span class="line">    <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// trace</span></span><br><span class="line">    emulator.traceCode(cryptoDDmodule.base,cryptoDDmodule.base+cryptoDDmodule.size);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">PrintStream</span> <span class="variable">traceStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PrintStream</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;trace.log&quot;</span>)),<span class="literal">true</span>);</span><br><span class="line">        traceHook.setRedirect(traceStream);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;xiaojiaa&quot;</span>.getBytes(),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            decode_a10);</span><br><span class="line">    System.out.println(Hex.encodeHex(byteValues.getValue()));</span><br><span class="line"><span class="comment">//        String b64encoded = Base64.getEncoder().encodeToString(byteValues.getValue());</span></span><br><span class="line"><span class="comment">//        System.out.println(b64encoded);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行之后，trace日志结果保存在<code>trace.log</code>文件中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c9cbd740c87749c660690b89498d077d</span><br></pre></td></tr></table></figure>

<p>根据输出结果到trace中搜索，比如<code>c9</code>、<code>cb</code>、<code>d7</code>、<code>40</code>等</p>
<p>找到一系列与输出对应的值，在<code>0xe4fff3c0</code>地址处，在IDA中跳转到他们任意的偏移地址</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/7.jpg"></p>
<p>在IDA中跳转到他们任意的偏移地址，然后反汇编，可以看到处于<code>sub_189C4</code>函数里</p>
<h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 密钥扩展 =&gt; 11轮密钥</span><br><span class="line"> * 轮密钥加 有异或操作，而且只有异或操作</span><br><span class="line"> *</span><br><span class="line"> * 循环 </span><br><span class="line"> * 字节代换 =&gt; 简单字符替换</span><br><span class="line"> * 行位移 =&gt; 只有位移，没有异或</span><br><span class="line"> * 列混淆 =&gt; 比较复杂，但是不需要key</span><br><span class="line"> * 轮密钥加</span><br><span class="line"> *</span><br><span class="line"> * 字节代换</span><br><span class="line"> * 行位移</span><br><span class="line"> * 轮密钥加</span><br><span class="line"> *</span><br><span class="line"> * 轮密钥加 </span><br><span class="line"> * 字节代换</span><br><span class="line"> * 行位移</span><br><span class="line"> * 列混淆</span><br><span class="line"> * */</span><br></pre></td></tr></table></figure>

<h2 id="调试"><a href="#调试" class="headerlink" title="调试"></a>调试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//        修复free函数</span></span><br><span class="line">    <span class="type">HookZz</span> <span class="variable">hookZz</span> <span class="operator">=</span> HookZz.getInstance(emulator);</span><br><span class="line">    <span class="type">Module</span> <span class="variable">module</span> <span class="operator">=</span> memory.findModule(<span class="string">&quot;libc.so&quot;</span>);</span><br><span class="line">    hookZz.replace(<span class="keyword">module</span>.findSymbolByName(<span class="string">&quot;free&quot;</span>).getAddress(), <span class="keyword">new</span> <span class="title class_">ReplaceCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> HookStatus <span class="title function_">onCall</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> info)</span> &#123;</span><br><span class="line">            <span class="type">RegisterContext</span> <span class="variable">rc</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">            <span class="keyword">return</span> HookStatus.RET(emulator, rc.getLRPointer().toIntPeer());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> <span class="string">&quot;gUG562L2Vf2lTAaXhg63pkkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] decode_a10 = Base64.getDecoder().decode(a10.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes());</span><br><span class="line">    <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 下断点</span></span><br><span class="line">    <span class="type">Debugger</span> <span class="variable">attach</span> <span class="operator">=</span> emulator.attach();</span><br><span class="line">    attach.addBreakPoint(cryptoDDmodule.base + <span class="number">0x189C4</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;xiaojiaa&quot;</span>.getBytes(),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            decode_a10);</span><br><span class="line">    System.out.println(Hex.encodeHex(byteValues.getValue()));</span><br><span class="line"><span class="comment">//        String b64encoded = Base64.getEncoder().encodeToString(byteValues.getValue());</span></span><br><span class="line"><span class="comment">//        System.out.println(b64encoded);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过<code>mx0</code>查看<code>x0</code>寄存器的内容</p>
<p>这就是我们传入的明文，后面是填充的内容</p>
<p>地址：0xe4fff3d0</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/8.jpg"></p>
<p>通过<code>mx1</code>查看<code>x1</code>寄存器的内容</p>
<p>这是一块空内存，应该就是存放返回值的</p>
<p>地址：0xe4fff3c0</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/9.jpg"></p>
<h2 id="AES流程分析"><a href="#AES流程分析" class="headerlink" title="AES流程分析"></a>AES流程分析</h2><p>对任意的AES，找到它加密流程中的四个步骤</p>
<p>字节代换</p>
<p>行位移</p>
<p>列混淆</p>
<p>轮秘钥加</p>
<p>sub_189C4这个函数应该是整个AES的函数，看它里面调用了哪些函数</p>
<h3 id="sub-219CC"><a href="#sub-219CC" class="headerlink" title="sub_219CC()"></a>sub_219CC()</h3><p>首先看<code>sub_219CC()</code>这个函数</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/10.jpg"></p>
<p>进入它的函数内部，看到都是异或操作</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/12.jpg"></p>
<p>那么就可能是轮秘钥加的步骤了</p>
<h3 id="sub-21BEC"><a href="#sub-21BEC" class="headerlink" title="sub_21BEC()"></a>sub_21BEC()</h3><p>接着往下看，看到一个sub_21BEC()函数</p>
<p>它里面有如下的操作</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/11.jpg"></p>
<p>看大佬的手写AES代码，猜测这里可能是字节代换的操作</p>
<p>继续往下看</p>
<h3 id="sub-223E0"><a href="#sub-223E0" class="headerlink" title="sub_223E0()"></a>sub_223E0()</h3><p>它进行如下操作</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/13.jpg"></p>
<p>猜测可能是行位移</p>
<p>接着往下看</p>
<h3 id="sub-22810"><a href="#sub-22810" class="headerlink" title="sub_22810()"></a>sub_22810()</h3><p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/14.jpg"></p>
<p>看着像是列混淆</p>
<h3 id="hook这几个地址"><a href="#hook这几个地址" class="headerlink" title="hook这几个地址"></a>hook这几个地址</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line"> * 密钥扩展 =&gt; 11轮密钥</span><br><span class="line"> * 轮密钥加 有异或操作，而且只有异或操作</span><br><span class="line"> *</span><br><span class="line"> * 循环 9次</span><br><span class="line"> * 字节代换 =&gt; 简单字符替换</span><br><span class="line"> * 行位移 =&gt; 只有位移，没有异或</span><br><span class="line"> * 列混淆 =&gt; 比较复杂，但是不需要key</span><br><span class="line"> * 轮密钥加</span><br><span class="line"> *</span><br><span class="line"> * 字节代换</span><br><span class="line"> * 行位移</span><br><span class="line"> * 轮密钥加</span><br><span class="line"> *</span><br><span class="line"> * 轮密钥加 =&gt; 11</span><br><span class="line"> * 字节代换 =&gt; 10</span><br><span class="line"> * 行位移 =&gt; 10</span><br><span class="line"> * 列混淆 =&gt; 9次</span><br><span class="line"> * */</span><br></pre></td></tr></table></figure>

<p>打印这几个函数的参数，返回值，调用次数</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Debugger</span> <span class="variable">attach</span> <span class="operator">=</span> emulator.attach();</span><br><span class="line"><span class="type">int</span>[] counts = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] offset = &#123;</span><br><span class="line">        <span class="number">0x219CC</span>,</span><br><span class="line">        <span class="number">0x21BEC</span>,</span><br><span class="line">        <span class="number">0x223E0</span>,</span><br><span class="line">        <span class="number">0x22810</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI</span> <span class="operator">=</span> i;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI1</span> <span class="operator">=</span> i;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI2</span> <span class="operator">=</span> i;</span><br><span class="line">    attach.addBreakPoint(cryptoDDmodule.base + offset[i], <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">            <span class="type">RegisterContext</span> <span class="variable">context</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">            <span class="type">UnidbgPointer</span> <span class="variable">lr</span> <span class="operator">=</span> context.getLRPointer();</span><br><span class="line">            <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">            <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">16</span>];</span><br><span class="line">            pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">            counts[finalI]++;</span><br><span class="line">            System.out.println(Hex.encodeHex(buf));</span><br><span class="line">            attach.addBreakPoint(lr.peer, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">                    <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">                    pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">                    System.out.println(Hex.encodeHex(buf));</span><br><span class="line">                    System.out.printf(<span class="string">&quot;====0x%x====%d====\n&quot;</span>,offset[finalI2],counts[finalI1]);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0x219cc:调用33次</span><br><span class="line">0x21bec:调用10次</span><br><span class="line">0x223e0:调用10次</span><br><span class="line">0x22810:调用9次</span><br></pre></td></tr></table></figure>

<p>这里面<code>0x219cc</code>调用了33次不太正常</p>
<h3 id="sub-219CC-1"><a href="#sub-219CC-1" class="headerlink" title="sub_219CC()"></a>sub_219CC()</h3><p>重新看sub_219CC()，把sub_219CC()单独拿出来分析</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Debugger</span> <span class="variable">attach</span> <span class="operator">=</span> emulator.attach();</span><br><span class="line"><span class="type">int</span>[] counts = &#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;;</span><br><span class="line"><span class="type">int</span>[] offset = &#123;</span><br><span class="line">        <span class="number">0x21BEC</span>,</span><br><span class="line">        <span class="number">0x223E0</span>,</span><br><span class="line">        <span class="number">0x22810</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI</span> <span class="operator">=</span> i;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI1</span> <span class="operator">=</span> i;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI2</span> <span class="operator">=</span> i;</span><br><span class="line">    attach.addBreakPoint(cryptoDDmodule.base + offset[i], <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">            <span class="type">RegisterContext</span> <span class="variable">context</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">            <span class="type">UnidbgPointer</span> <span class="variable">lr</span> <span class="operator">=</span> context.getLRPointer();</span><br><span class="line">            <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">            <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">16</span>];</span><br><span class="line">            pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">            counts[finalI]++;</span><br><span class="line">            System.out.println(Hex.encodeHex(buf));</span><br><span class="line">            attach.addBreakPoint(lr.peer, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">                    <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">                    pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">                    System.out.println(Hex.encodeHex(buf));</span><br><span class="line">                    System.out.printf(<span class="string">&quot;====0x%x====%d====\n&quot;</span>,offset[finalI2],counts[finalI1]);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 0x219CC</span></span><br><span class="line">attach.addBreakPoint(cryptoDDmodule.base + <span class="number">0x219CC</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">        <span class="type">RegisterContext</span> <span class="variable">context</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">lr</span> <span class="operator">=</span> context.getLRPointer();</span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">        <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">16</span>];</span><br><span class="line">        pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        counts[<span class="number">3</span>]++;</span><br><span class="line">        System.out.printf(<span class="string">&quot;[0x219CC] x0=&quot;</span>+ <span class="keyword">new</span> <span class="title class_">String</span>(Hex.encodeHex(buf)) +<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        pointerArg = context.getPointerArg(<span class="number">1</span>);</span><br><span class="line">        pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        System.out.printf(<span class="string">&quot;[0x219CC] x1=&quot;</span>+ <span class="keyword">new</span> <span class="title class_">String</span>(Hex.encodeHex(buf))+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        attach.addBreakPoint(lr.peer, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">                <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">                pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">                System.out.println(Hex.encodeHex(buf));</span><br><span class="line">                System.out.printf(<span class="string">&quot;====0x%x====%d====\n&quot;</span>,<span class="number">0x219CC</span>,counts[<span class="number">3</span>]);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>找到如下输出位置，从这里开始加密</p>
<p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/15.jpg"></p>
<p>再次修改hook</p>
<p>限制0x219CC函数的输出条件，从加密的时候开始</p>
<p>如下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 0x219CC</span></span><br><span class="line"><span class="keyword">final</span> <span class="type">boolean</span>[] is_ok = &#123;<span class="literal">false</span>&#125;;</span><br><span class="line">attach.addBreakPoint(cryptoDDmodule.base + <span class="number">0x219CC</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">        <span class="type">RegisterContext</span> <span class="variable">context</span> <span class="operator">=</span> emulator.getContext();</span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">lr</span> <span class="operator">=</span> context.getLRPointer();</span><br><span class="line">        <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">        <span class="type">byte</span>[] buf = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">16</span>];</span><br><span class="line">        pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">new</span> <span class="title class_">String</span>(Hex.encodeHex(buf)).equals(<span class="string">&quot;786a080869690808616108086f610808&quot;</span>))&#123;</span><br><span class="line">            is_ok[<span class="number">0</span>] =<span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (is_ok[<span class="number">0</span>])&#123;</span><br><span class="line">            counts[<span class="number">3</span>]++;</span><br><span class="line">            System.out.printf(<span class="string">&quot;[0x219CC] x0=&quot;</span>+ <span class="keyword">new</span> <span class="title class_">String</span>(Hex.encodeHex(buf)) +<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            pointerArg = context.getPointerArg(<span class="number">1</span>);</span><br><span class="line">            pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">            System.out.printf(<span class="string">&quot;[0x219CC] x1=&quot;</span>+ <span class="keyword">new</span> <span class="title class_">String</span>(Hex.encodeHex(buf))+<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            attach.addBreakPoint(lr.peer, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">                    <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> context.getPointerArg(<span class="number">0</span>);</span><br><span class="line">                    pointerArg.read(<span class="number">0</span>, buf, <span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">                    System.out.println(Hex.encodeHex(buf));</span><br><span class="line">                    System.out.printf(<span class="string">&quot;====0x%x====%d====\n&quot;</span>,<span class="number">0x219CC</span>,counts[<span class="number">3</span>]);</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>然后就有完美的输出展示了</p>
<p>把这部分的代码封装成一个函数，方便后续调用</p>
<h2 id="Dfa攻击"><a href="#Dfa攻击" class="headerlink" title="Dfa攻击"></a>Dfa攻击</h2><p>我们知道dfa攻击是从第九轮的列混淆开始的</p>
<p>首先保存正确的加密结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c9cbd740c87749c660690b89498d077d</span><br></pre></td></tr></table></figure>

<p>找到第九轮列混淆进行攻击</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Debugger</span> <span class="variable">attach</span> <span class="operator">=</span> emulator.attach();</span><br><span class="line"><span class="type">int</span>[] counts = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">attach.addBreakPoint(cryptoDDmodule.base + <span class="number">0x22810</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">        counts[<span class="number">0</span>]++;</span><br><span class="line">        <span class="keyword">if</span> (counts[<span class="number">0</span>]==<span class="number">9</span>)&#123;</span><br><span class="line">            <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">            <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> emulator.getContext().getPointerArg(<span class="number">0</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;攻击成功！&quot;</span>);</span><br><span class="line">            pointerArg.setByte(<span class="number">0</span>,(<span class="type">byte</span>) random.nextInt(<span class="number">255</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>攻击成功之后</p>
<p>写个循环，从第1个字节到第16个字节依次进行攻击</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">    <span class="type">Debugger</span> <span class="variable">attach</span> <span class="operator">=</span> emulator.attach();</span><br><span class="line">    <span class="type">int</span>[] counts = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> <span class="variable">finalI</span> <span class="operator">=</span> i;</span><br><span class="line">    attach.addBreakPoint(cryptoDDmodule.base + <span class="number">0x22810</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">            counts[<span class="number">0</span>]++;</span><br><span class="line">            <span class="keyword">if</span> (counts[<span class="number">0</span>]==<span class="number">9</span>)&#123;</span><br><span class="line">                <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">                <span class="type">UnidbgPointer</span> <span class="variable">pointerArg</span> <span class="operator">=</span> emulator.getContext().getPointerArg(<span class="number">0</span>);</span><br><span class="line">                pointerArg.setByte(finalI,(<span class="type">byte</span>) random.nextInt(<span class="number">255</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;xiaojiaa&quot;</span>.getBytes(),</span><br><span class="line">            <span class="number">2</span>,</span><br><span class="line">            decode_a10);</span><br><span class="line">    System.out.println(Hex.encodeHex(byteValues.getValue()));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关掉日志打印，输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0ccbd740c87749fc60698689497f077d</span><br><span class="line">c9d3d7400a7749c660690b98498d527d</span><br><span class="line">c9cbe040c82649c667690b89498d071c</span><br><span class="line">c9cbd737c877ddc660390b89d48d077d</span><br><span class="line">93cbd740c87749c860698b8949ec077d</span><br><span class="line">c970d740737749c660690b26498df27d</span><br><span class="line">c9cbfc40c86949c629690b89498d0741</span><br><span class="line">c9cbd7a4c877a3c660460b89e68d077d</span><br><span class="line">9fcbd740c87749b66069e8894930077d</span><br><span class="line">c927d7401d7749c660690b0f498d787d</span><br><span class="line">c9cb5240c8c249c6f6690b89498d0718</span><br><span class="line">c9cbd781c87753c660d20b891c8d077d</span><br><span class="line">c4cbd740c877493e606905894918077d</span><br><span class="line">c9aed740067749c660690b40498dd47d</span><br><span class="line">c9cbe640c8a349c65a690b89498d0772</span><br><span class="line">c9cbd740c87749c660690b89498d077d</span><br></pre></td></tr></table></figure>

<h2 id="还原第9轮的子密钥"><a href="#还原第9轮的子密钥" class="headerlink" title="还原第9轮的子密钥"></a>还原第9轮的子密钥</h2><p>使用phoenixAES库还原</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> phoenixAES</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;tracefile&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> t: <span class="comment"># 第一行放正确的加密结果</span></span><br><span class="line">    t.write(<span class="string">&quot;&quot;&quot;c9cbd740c87749c660690b89498d077d</span></span><br><span class="line"><span class="string">0ccbd740c87749fc60698689497f077d</span></span><br><span class="line"><span class="string">c9d3d7400a7749c660690b98498d527d</span></span><br><span class="line"><span class="string">c9cbe040c82649c667690b89498d071c</span></span><br><span class="line"><span class="string">c9cbd737c877ddc660390b89d48d077d</span></span><br><span class="line"><span class="string">93cbd740c87749c860698b8949ec077d</span></span><br><span class="line"><span class="string">c970d740737749c660690b26498df27d</span></span><br><span class="line"><span class="string">c9cbfc40c86949c629690b89498d0741</span></span><br><span class="line"><span class="string">c9cbd7a4c877a3c660460b89e68d077d</span></span><br><span class="line"><span class="string">9fcbd740c87749b66069e8894930077d</span></span><br><span class="line"><span class="string">c927d7401d7749c660690b0f498d787d</span></span><br><span class="line"><span class="string">c9cb5240c8c249c6f6690b89498d0718</span></span><br><span class="line"><span class="string">c9cbd781c87753c660d20b891c8d077d</span></span><br><span class="line"><span class="string">c4cbd740c877493e606905894918077d</span></span><br><span class="line"><span class="string">c9aed740067749c660690b40498dd47d</span></span><br><span class="line"><span class="string">c9cbe640c8a349c65a690b89498d0772</span></span><br><span class="line"><span class="string">c9cbd740c87749c660690b89498d077d</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">phoenixAES.crack_file(<span class="string">&#x27;tracefile&#x27;</span>, [], <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Round key bytes recovered:</span><br><span class="line">0E10F6D230677EBDF0D7D12C8DBD21CF</span><br><span class="line">Last round key #N found:</span><br><span class="line">0E10F6D230677EBDF0D7D12C8DBD21CF</span><br></pre></td></tr></table></figure>

<h2 id="根据第九轮子密钥推出初始密钥"><a href="#根据第九轮子密钥推出初始密钥" class="headerlink" title="根据第九轮子密钥推出初始密钥"></a>根据第九轮子密钥推出初始密钥</h2><p><img src="/2025/03/15/%E6%9F%90%E5%B9%B8%E7%99%BD%E7%9B%92AES/17.jpg"></p>
<p>密钥为<code>655534527846474A7372787545766C74</code></p>
<h1 id="用密钥对响应体解密"><a href="#用密钥对响应体解密" class="headerlink" title="用密钥对响应体解密"></a>用密钥对响应体解密</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toStandardB64</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;+&quot;</span>).replace(<span class="string">&quot;_&quot;</span>,<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypted_ecb</span>(<span class="params">encrypted_data,key</span>):</span><br><span class="line">    cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    decrypted_data = cipher.decrypt(encrypted_data)</span><br><span class="line">    unpadded_data = unpad(decrypted_data,AES.block_size)</span><br><span class="line">    <span class="keyword">return</span> unpadded_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_response</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    standardb64 = toStandardB64(ciphertext).encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    plaintext = aes_decrypted_ecb(base64.b64decode(standardb64),<span class="built_in">bytes</span>.fromhex(<span class="string">&quot;655534527846474A7372787545766C74&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> plaintext.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">&quot;57l6aGIjM8ySP5qUW5cmXG_swqXZ3-CDvlz4K-CW5JHHIAiIXoiAtXFef1i898pFnXG2UaYYFPgo4B-QISWmwxGVgzf63I98g8s1TCjJ2qHAI2q4UI-IP1nRHfLevhZ8Kgx6gyMYgsoibWQJ_IU1cONmes8MQqWG3BlsfA7TAVesjF0N3KaEEfHH0RONmDSU3hSp9D9T3nl-xsHSpLBlPQPQRsLBEHzAgEeKO5EueBVpw8cCq3WnWYGT_Ai2TxBpFIImOPBAMnR-T3lHx0D4Pp-iF9p7c_xa8Ek3IhwVx5m8lpQCuAta8PG1ffVGX7Pgr82woPcekBWvF9qFV4kiabebYKsMQHmAbnNfKxLsSEs=&quot;</span></span><br><span class="line"><span class="built_in">print</span>(decrypt_response(ciphertext=ciphertext))</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;bizId&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;busiCode&quot;</span>:<span class="string">&quot;BASE001&quot;</span>,<span class="string">&quot;code&quot;</span>:<span class="number">7</span>,<span class="string">&quot;content&quot;</span>:null,<span class="string">&quot;handler&quot;</span>:<span class="string">&quot;USER&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;验证码不正确&quot;</span>,<span class="string">&quot;shardingId&quot;</span>:<span class="string">&quot;&quot;</span>,<span class="string">&quot;status&quot;</span>:<span class="string">&quot;BASE_ERROR&quot;</span>,<span class="string">&quot;uid&quot;</span>:<span class="string">&quot;b4e31b9d-d7ab-40a9-9b64-14e52f633b911741972183784&quot;</span>,<span class="string">&quot;version&quot;</span>:<span class="string">&quot;101&quot;</span>,<span class="string">&quot;zeusId&quot;</span>:<span class="string">&quot;luckycapiproxy-0ade0947-483881-21580&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/" class="post-title-link" itemprop="url">瑞幸白盒AES</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-03-11 16:02:53" itemprop="dateCreated datePublished" datetime="2025-03-11T16:02:53+08:00">2025-03-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-15 17:07:18" itemprop="dateModified" datetime="2025-03-15T17:07:18+08:00">2025-03-15</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>46k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>42 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.lucky.luckyclient</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/1.jpg"></p>
<h1 id="过检测"><a href="#过检测" class="headerlink" title="过检测"></a>过检测</h1><h2 id="root检测"><a href="#root检测" class="headerlink" title="root检测"></a>root检测</h2><p>使用狐妖面具隐藏</p>
<h2 id="frida检测"><a href="#frida检测" class="headerlink" title="frida检测"></a>frida检测</h2><p>使用小工具绕过</p>
<h2 id="脱壳"><a href="#脱壳" class="headerlink" title="脱壳"></a>脱壳</h2><p>使用脱壳网站进行脱壳</p>
<p><a target="_blank" rel="noopener" href="https://56.al/">56.al</a></p>
<h1 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h1><p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/2.jpg"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">url:</span><br><span class="line">https://capi.lkcoffee.com/resource/m/sys/base/validcode</span><br><span class="line"></span><br><span class="line">headers:</span><br><span class="line">x-lk-akv	5260</span><br><span class="line">x-lk-mid	</span><br><span class="line">x-lk-sid	</span><br><span class="line">event_id	1741678678079</span><br><span class="line">x-lk-csid	08065795-7d98-4363-9c02-30d73c9f252e</span><br><span class="line">sentry-trace	2ea1d59760394ecd9ea18fab48820ffb-a39c080332b849f9-1</span><br><span class="line">baggage	sentry-environment=release,sentry-public_key=d4365939f7c346a4b0c6ee50a412c050,sentry-release=com.lucky.luckyclient%405.2.60%2B200,sentry-sample_rate=1,sentry-trace_id=2ea1d59760394ecd9ea18fab48820ffb,sentry-transaction=LoginActivity.tvReqAuthCode</span><br><span class="line">content-type	application/x-www-form-urlencoded</span><br><span class="line">content-length	228</span><br><span class="line">accept-encoding	gzip</span><br><span class="line">cookie	uid=</span><br><span class="line">user-agent	okhttp/4.9.3</span><br><span class="line"></span><br><span class="line">form:</span><br><span class="line">sign	7979560225808340751212263377520956346</span><br><span class="line">q	DURM6YZm8EJjngxNSvqLuaCpyTbBaQ1RNCfPIJl6_JATi85kT_JO5bo-nYuFGfCYknf1KQDtj0IXDItKNgs2ehphXU_Y0FeSA9JBPnZAggLlJK1fwwruC4J8vDz17ovkHjqEZp7bh3iAQYZY22P_NQ==</span><br><span class="line">t	1741680800108</span><br><span class="line">cid	210101</span><br></pre></td></tr></table></figure>

<p><strong>又抓了个登录包</strong></p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/3.jpg"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">url:</span><br><span class="line">https://capi.lkcoffee.com/resource/m/user/login</span><br><span class="line"></span><br><span class="line">headers:</span><br><span class="line">x-lk-akv	5260</span><br><span class="line">x-lk-mid	</span><br><span class="line">x-lk-sid	</span><br><span class="line">event_id	1741678678079</span><br><span class="line">x-lk-csid	08065795-7d98-4363-9c02-30d73c9f252e</span><br><span class="line">sentry-trace	7a99181659144d6fb9c42a30c0da15af-c53cfa10e78b4b98-1</span><br><span class="line">baggage	sentry-environment=release,sentry-public_key=d4365939f7c346a4b0c6ee50a412c050,sentry-release=com.lucky.luckyclient%405.2.60%2B200,sentry-sample_rate=1,sentry-trace_id=7a99181659144d6fb9c42a30c0da15af,sentry-transaction=LoginActivity.btnConfirm</span><br><span class="line">content-type	application/x-www-form-urlencoded</span><br><span class="line">content-length	685</span><br><span class="line">accept-encoding	gzip</span><br><span class="line">cookie	uid=e208b39d-8f40-4e93-ab22-430698abc6821741681516422</span><br><span class="line">user-agent	okhttp/4.9.3</span><br><span class="line"></span><br><span class="line">form:</span><br><span class="line">sign	5893325431374183456150891639716307865</span><br><span class="line">q	mOD2mwoFGDWinNSdsn9lI0tvoAQhA0e3_boidwfb61WKbU4LjgnSja-3Ynxdslq_rNFXWN49AcmYjkCEqBG7TCjDzT556tyHhu6wVtv1Kr-QAaK-RRvpSO0nqled_vXMwxgpjUWE2FvF-FfUZNfY8dVfEt7SpOlNsfiKHCWxwPOII5xpWmt4WZawpkq3dPnS5AP3ncMj8MctnB6Z2o2Wu9_s2BEfhweLyBoV8eYgVet8hvp2m_UfiZifKR3_FwD3q6x-iVVECbSjGYXyk-1JaYpcQUQZv8PMLtHfQ7CsfKCtkMlFETWuGNTNDy4kmiAjrFFDGen8D8yJ4-2rJAzsTzRsQI2hI1nvLcPKdoeObzl-C9-kLugMoKrecLKjIKtM0cwbqeGaSuo6F87GTbhmgh2lY85Jbc521efoup-KhMeHzApRp0TaofSDkO_ykmYiN_GsIr77RpT7tTu3a84FV-GfkjX_LgWbZhnPwFyx5boJ41xq7gZLF92ejvlFou4I6vKIfxxYn4-4e96gbbgW9eUepOub_ThVPyIGgrx_KVc=</span><br><span class="line">uid	e208b39d-8f40-4e93-ab22-430698abc6821741681516422</span><br><span class="line">t	1741681608374</span><br><span class="line">cid	210101</span><br><span class="line"></span><br><span class="line">response:</span><br><span class="line">vaTaFF5L8jW_LFnfCuwtZGulP6wG3s-O__HUjYaf8swfjrR3WG3qoYY5X8Gk_nN52wNx5lYRD4GsXuZWopXQ-SxeK58cf_zVpelAhEpcD_zuavE12lvsriUjHspxgNszHjcK9XTN3jT3S6xNKM8nqbadCDGMS1RQJAc5GTiNyBAqgx6y-P0CNYjDfc5iGXVuwIUBR3WoxJM1Yyfdvk8pvALlMMkF-ja2j63TioNTyKaBrCFJtDbYhQROjKSF7tjk6MQVbFyhHocTm7wBl54h4JzbhdatBO2wRaaym9fYUygUqaZTvhMxF11CWw1sPk5a</span><br></pre></td></tr></table></figure>

<p>请求参数<code>sign</code>，<code>q</code>，响应体都是加密的</p>
<p>又抓了个包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">utl:</span><br><span class="line">https://capi.lkcoffee.com/resource/m/user/login</span><br><span class="line"></span><br><span class="line">headers=&#123;</span><br><span class="line">  &quot;:authority&quot;: &quot;capi.lkcoffee.com&quot;,</span><br><span class="line">  &quot;:method&quot;: &quot;POST&quot;,</span><br><span class="line">  &quot;:path&quot;: &quot;/resource/m/user/login&quot;,</span><br><span class="line">  &quot;:scheme&quot;: &quot;https&quot;,</span><br><span class="line">  &quot;x-lk-akv&quot;: &quot;5265&quot;,</span><br><span class="line">  &quot;x-lk-mid&quot;: &quot;&quot;,</span><br><span class="line">  &quot;x-lk-sid&quot;: &quot;&quot;,</span><br><span class="line">  &quot;event_id&quot;: &quot;1741773373890&quot;,</span><br><span class="line">  &quot;x-lk-csid&quot;: &quot;b23ee6cb-c0f2-4e43-9580-727ce47f7b73&quot;,</span><br><span class="line">  &quot;sentry-trace&quot;: &quot;5d4028a1977c401da7dc5299c9fe942f-11ad2f67d12f4343-0&quot;,</span><br><span class="line">  &quot;baggage&quot;: &quot;sentry-environment=release,sentry-public_key=d4365939f7c346a4b0c6ee50a412c050,sentry-release=com.lucky.luckyclient%405.2.65%2B201,sentry-sample_rate=0,sentry-trace_id=5d4028a1977c401da7dc5299c9fe942f,sentry-transaction=LoginActivity.btnConfirm&quot;,</span><br><span class="line">  &quot;content-type&quot;: &quot;application/x-www-form-urlencoded&quot;,</span><br><span class="line">  &quot;content-length&quot;: &quot;684&quot;,</span><br><span class="line">  &quot;accept-encoding&quot;: &quot;gzip&quot;,</span><br><span class="line">  &quot;cookie&quot;: &quot;uid=ede6c26f-85eb-4f41-b103-051605ae1c821741773364713&quot;,</span><br><span class="line">  &quot;user-agent&quot;: &quot;okhttp/4.9.3&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body=&#123;</span><br><span class="line">  &quot;sign&quot;: &quot;7964953862091852252935269275418960748&quot;,</span><br><span class="line">  &quot;q&quot;: &quot;-YqmJeyS17YrIsczlOeETZzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDudPQ7clgzz0Xzjt_NO-L5mbbklzohRwsDO0eQtHxD58zL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=&quot;,</span><br><span class="line">  &quot;uid&quot;: &quot;ede6c26f-85eb-4f41-b103-051605ae1c821741773364713&quot;,</span><br><span class="line">  &quot;t&quot;: &quot;1741773407429&quot;,</span><br><span class="line">  &quot;cid&quot;: &quot;210101&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h1><p>jadx打开脱壳后的dex</p>
<p>Java通过System.load()和System.loadLibrary()来加载动态库，直接搜索<code>System.loadLibrary</code></p>
<p>发现一个可疑类</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/4.jpg"></p>
<p>双击进去看到so的名字是加密的，还有四个native方法和三个用于加解密的方法</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/5.jpg"></p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/6.jpg"></p>
<p>主动调用getString2()方法来解密so名字</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">call_getString2</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">StubApp</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.stub.StubApp&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> soName = <span class="title class_">StubApp</span>.<span class="title function_">getString2</span>(<span class="string">&quot;32264&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;so:&quot;</span>,soName);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用了，但是输出结果是乱码</p>
<p>用hook_RegisterNatives打印动态注册函数及其所在的so</p>
<p>然后找到了<code>libcryptoDD.so</code></p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/7.jpg"></p>
<h1 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h1><p>看了源码这几个native方法中只有<code>localAESWork</code>和<code>md5_crypt</code>被调用了</p>
<p>猜测sign是由<code>md5_crypt</code>生成的</p>
<p><code>q</code>和响应体是由<code>localAESWork</code>生成的</p>
<p>接下来对<code>localAESWork</code>、<code>md5_crypt</code>、<code>a</code>、<code>b</code>、<code>c</code>进行hook</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bArrToString</span>(<span class="params">bArr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>).$new(bArr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_localAESWork</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;localAESWork&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">bArr, i10, bArr2</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.localAESWork is called!`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArr&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArrToString(bArr)&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`i10=<span class="subst">$&#123;i10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArr2&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArrToString(bArr2)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;localAESWork&quot;</span>](bArr, i10, bArr2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.localAESWork result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.localAESWork result=<span class="subst">$&#123;bArrToString(result)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_localAESWork</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_md5_crypt</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;md5_crypt&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">bArr, i10, bArr2</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.md5_crypt is called!`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArr&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArrToString(bArr)&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`i10=<span class="subst">$&#123;i10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArr2&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArrToString(bArr2)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;md5_crypt&quot;</span>](bArr, i10, bArr2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.md5_crypt result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.md5_crypt result=<span class="subst">$&#123;bArrToString(result)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_md5_crypt</span>()</span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CryptoHelper.md5_crypt is called!</span><br><span class="line">bArr=99,105,100,61,50,49,48,49,48,49,59,113,61,88,122,48,82,56,50,102,83,52,56,53,98,50,51,98,97,56,49,55,101,52,74,122,80,72,48,68,98,66,45,72,121,104,119,48,57,90,74,85,108,57,107,90,52,83,90,95,75,107,86,104,48,55,117,66,113,106,56,101,106,121,107,84,119,49,98,108,48,50,118,117,49,100,116,54,55,66,98,73,75,65,45,49,70,113,108,84,117,70,71,104,56,86,111,74,101,109,121,69,107,109,104,113,110,102,54,119,57,117,57,56,100,75,118,67,100,112,70,80,68,105,82,107,116,85,45,80,71,68,116,110,68,57,89,56,114,66,89,103,66,72,117,80,121,102,110,77,82,49,53,106,84,77,97,70,48,72,86,52,83,77,119,54,113,85,95,83,95,51,112,55,55,49,106,72,83,69,57,75,108,56,89,120,54,122,75,103,107,66,118,55,49,113,76,104,81,80,54,56,86,78,115,105,102,110,109,81,70,98,116,69,66,100,81,116,53,104,75,49,45,57,87,76,71,122,114,104,66,49,106,76,105,76,49,69,74,84,116,109,113,71,121,109,84,50,49,121,109,113,117,81,72,88,99,68,117,107,45,121,81,81,79,69,86,81,104,77,118,78,56,112,95,100,69,107,68,50,51,88,54,110,68,86,110,116,84,51,70,84,67,57,48,100,109,77,73,116,80,68,76,54,81,108,81,111,87,115,82,84,113,118,108,86,77,107,85,122,50,119,83,78,80,115,65,112,86,98,50,104,113,51,48,68,52,120,57,82,83,118,68,69,51,115,75,74,66,71,65,122,70,113,68,71,95,88,119,69,54,121,111,111,106,68,78,80,110,50,119,72,48,72,48,111,51,45,119,116,67,115,111,48,104,82,74,88,108,118,80,84,72,122,95,122,77,89,100,84,99,77,78,75,84,119,99,99,87,103,117,48,109,109,98,72,53,78,75,99,86,67,120,114,90,54,82,50,77,101,67,102,85,98,56,65,67,112,55,80,75,106,90,101,65,101,99,97,72,113,95,82,69,117,51,75,107,111,105,51,120,88,80,80,75,95,77,85,95,101,76,108,53,65,49,77,70,119,95,100,55,97,122,84,83,72,72,85,70,109,76,51,82,100,105,67,49,53,118,118,65,49,98,97,106,72,49,78,68,98,76,69,65,120,77,86,56,110,85,79,74,86,102,117,87,120,88,68,71,83,48,68,105,107,110,121,106,48,86,57,53,65,116,95,75,66,71,52,121,55,89,108,111,45,52,102,118,52,61,59,116,61,49,55,52,49,54,57,57,53,50,52,55,56,57,59,117,105,100,61,49,102,48,48,56,48,102,56,45,50,51,56,102,45,52,56,51,97,45,98,101,48,52,45,57,97,55,101,50,99,97,52,99,48,101,54,49,55,52,49,54,56,56,52,49,51,55,57,49</span><br><span class="line">bArr=cid=210101;q=Xz0R82fS485b23ba817e4JzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDuk-yQQOEVQhMvN8p_dEkD23X6nDVntT3FTC90dmMItPDL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=;t=1741699524789;uid=1f0080f8-238f-483a-be04-9a7e2ca4c0e61741688413791</span><br><span class="line">i10=1</span><br><span class="line">bArr2=-87,-114,-67,121,108,-104,-58,66,-48,15,40,31,112,-58,-81,116,73,9,-6,80,-38,87,98,16,114,-89,108,124,97,-82,52,59</span><br><span class="line">bArr2=���yl��B�(pƯtI   �P�Wbr�l|a�4;</span><br><span class="line">CryptoHelper.md5_crypt</span><br><span class="line">result=49,53,55,50,54,49,52,51,49,49,53,50,55,54,56,53,54,49,50,53,53,52,48,48,53,56,51,49,49,52,49,55,49,51,48,53,53,50</span><br><span class="line">CryptoHelper.md5_crypt result=15726143115276856125540058311417130552</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">bArrToString</span>(<span class="params">bArr</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>).$new(bArr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_localAESWork</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;localAESWork&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">bArr, i10, bArr2</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.localAESWork is called!`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArr&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArrToString(bArr)&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`i10=<span class="subst">$&#123;i10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArr2&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArrToString(bArr2)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;localAESWork&quot;</span>](bArr, i10, bArr2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.localAESWork result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.localAESWork result=<span class="subst">$&#123;bArrToString(result)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_localAESWork</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_md5_crypt</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;md5_crypt&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">bArr, i10, bArr2</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.md5_crypt is called!`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArr&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr=<span class="subst">$&#123;bArrToString(bArr)&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`i10=<span class="subst">$&#123;i10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArr2&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`bArr2=<span class="subst">$&#123;bArrToString(bArr2)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;md5_crypt&quot;</span>](bArr, i10, bArr2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.md5_crypt result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.md5_crypt result=<span class="subst">$&#123;bArrToString(result)&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_md5_crypt</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_a</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;a&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str, i10</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.a is called: str=<span class="subst">$&#123;str&#125;</span>, i10=<span class="subst">$&#123;i10&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;a&quot;</span>](str, i10);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.a result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hook_a</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_b</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;b&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.b is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;b&quot;</span>](str);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.b result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hook_b</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_c</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">CryptoHelper</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="title class_">CryptoHelper</span>[<span class="string">&quot;c&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.c is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;c&quot;</span>](str);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`CryptoHelper.c result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hook_c</span>()</span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CryptoHelper.c is called: str=&#123;&quot;mobile&quot;:&quot;17888888888&quot;,&quot;countryNo&quot;:&quot;86&quot;,&quot;validateCode&quot;:&quot;123456&quot;,&quot;appversion&quot;:&quot;5265&quot;,&quot;type&quot;:1,&quot;deviceId&quot;:&quot;android_lucky_ef5722c5-96ff-4521-8096-27530a0365b2&quot;,&quot;systemVersion&quot;:&quot;29&quot;,&quot;blackBox&quot;:&quot;oGPHE1741688414xYaSQkj72m7&quot;,&quot;uniqueCode&quot;:&quot;DUQKlOhFPQSnh57_KB6erjHdTADHhPk26j60RFVRS2xPaEZQUVNuaDU3X0tCNmVyakhkVEFESGhQazI2ajYwc2h1&quot;,&quot;regionId&quot;:&quot;CO0001&quot;,&quot;regId&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;google&quot;,&quot;isSecurityVerify&quot;:false&#125;</span><br><span class="line">CryptoHelper.c result=Xz0R82fS485b23ba817e4JzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDuk-yQQOEVQhMvN8p_dEkD23X6nDVntT3FTC90dmMItPDL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=</span><br><span class="line">CryptoHelper.md5_crypt is called!</span><br><span class="line">bArr=99,105,100,61,50,49,48,49,48,49,59,113,61,88,122,48,82,56,50,102,83,52,56,53,98,50,51,98,97,56,49,55,101,52,74,122,80,72,48,68,98,66,45,72,121,104,119,48,57,90,74,85,108,57,107,90,52,83,90,95,75,107,86,104,48,55,117,66,113,106,56,101,106,121,107,84,119,49,98,108,48,50,118,117,49,100,116,54,55,66,98,73,75,65,45,49,70,113,108,84,117,70,71,104,56,86,111,74,101,109,121,69,107,109,104,113,110,102,54,119,57,117,57,56,100,75,118,67,100,112,70,80,68,105,82,107,116,85,45,80,71,68,116,110,68,57,89,56,114,66,89,103,66,72,117,80,121,102,110,77,82,49,53,106,84,77,97,70,48,72,86,52,83,77,119,54,113,85,95,83,95,51,112,55,55,49,106,72,83,69,57,75,108,56,89,120,54,122,75,103,107,66,118,55,49,113,76,104,81,80,54,56,86,78,115,105,102,110,109,81,70,98,116,69,66,100,81,116,53,104,75,49,45,57,87,76,71,122,114,104,66,49,106,76,105,76,49,69,74,84,116,109,113,71,121,109,84,50,49,121,109,113,117,81,72,88,99,68,117,107,45,121,81,81,79,69,86,81,104,77,118,78,56,112,95,100,69,107,68,50,51,88,54,110,68,86,110,116,84,51,70,84,67,57,48,100,109,77,73,116,80,68,76,54,81,108,81,111,87,115,82,84,113,118,108,86,77,107,85,122,50,119,83,78,80,115,65,112,86,98,50,104,113,51,48,68,52,120,57,82,83,118,68,69,51,115,75,74,66,71,65,122,70,113,68,71,95,88,119,69,54,121,111,111,106,68,78,80,110,50,119,72,48,72,48,111,51,45,119,116,67,115,111,48,104,82,74,88,108,118,80,84,72,122,95,122,77,89,100,84,99,77,78,75,84,119,99,99,87,103,117,48,109,109,98,72,53,78,75,99,86,67,120,114,90,54,82,50,77,101,67,102,85,98,56,65,67,112,55,80,75,106,90,101,65,101,99,97,72,113,95,82,69,117,51,75,107,111,105,51,120,88,80,80,75,95,77,85,95,101,76,108,53,65,49,77,70,119,95,100,55,97,122,84,83,72,72,85,70,109,76,51,82,100,105,67,49,53,118,118,65,49,98,97,106,72,49,78,68,98,76,69,65,120,77,86,56,110,85,79,74,86,102,117,87,120,88,68,71,83,48,68,105,107,110,121,106,48,86,57,53,65,116,95,75,66,71,52,121,55,89,108,111,45,52,102,118,52,61,59,116,61,49,55,52,49,55,48,48,51,49,50,53,53,50,59,117,105,100,61,49,102,48,48,56,48,102,56,45,50,51,56,102,45,52,56,51,97,45,98,101,48,52,45,57,97,55,101,50,99,97,52,99,48,101,54,49,55,52,49,54,56,56,52,49,51,55,57,49</span><br><span class="line">bArr=cid=210101;q=Xz0R82fS485b23ba817e4JzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDuk-yQQOEVQhMvN8p_dEkD23X6nDVntT3FTC90dmMItPDL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=;t=1741700312552;uid=1f0080f8-238f-483a-be04-9a7e2ca4c0e61741688413791</span><br><span class="line">i10=1</span><br><span class="line">bArr2=-87,-114,-67,121,108,-104,-58,66,-48,15,40,31,112,-58,-81,116,73,9,-6,80,-38,87,98,16,114,-89,108,124,97,-82,52,59</span><br><span class="line">bArr2=���yl��B�(pƯtI   �P�Wbr�l|a�4;</span><br><span class="line">CryptoHelper.md5_crypt result=56,53,56,57,53,48,53,49,49,55,50,50,48,53,48,50,52,49,48,57,49,48,51,48,53,48,56,49,54,52,55,52,50,53,53,53,52</span><br><span class="line">CryptoHelper.md5_crypt result=8589505117220502410910305081647425554</span><br><span class="line">CryptoHelper.b is called: str=Xz0R82fS485b23ba817e4JzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDuk-yQQOEVQhMvN8p_dEkD23X6nDVntT3FTC90dmMItPDL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=</span><br><span class="line">CryptoHelper.b result=&#123;&quot;mobile&quot;:&quot;17888888888&quot;,&quot;countryNo&quot;:&quot;86&quot;,&quot;validateCode&quot;:&quot;123456&quot;,&quot;appversion&quot;:&quot;5265&quot;,&quot;type&quot;:1,&quot;deviceId&quot;:&quot;android_lucky_ef5722c5-96ff-4521-8096-27530a0365b2&quot;,&quot;systemVersion&quot;:&quot;29&quot;,&quot;blackBox&quot;:&quot;oGPHE1741688414xYaSQkj72m7&quot;,&quot;uniqueCode&quot;:&quot;DUQKlOhFPQSnh57_KB6erjHdTADHhPk26j60RFVRS2xPaEZQUVNuaDU3X0tCNmVyakhkVEFESGhQazI2ajYwc2h1&quot;,&quot;regionId&quot;:&quot;CO0001&quot;,&quot;regId&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;google&quot;,&quot;isSecurityVerify&quot;:false&#125;</span><br><span class="line">CryptoHelper.b is called: str=nMymqvoWI5UzuGSsfOyxWS9E0JQYtcev4A_O1LXSr_HosyYfsqRmenMCcYf7-mdZjZ8LUfNc6HbRD89pGuGxJhYP475VhWKSXmkD7eAkTSmxA1MpUjQQHOjueGL1F_YWGExcwjd3N-sOHxEfeB59eTF1vGH9C_S6Q5TrXqrOg1R0yv5lrZ0CUyVHr38KtyytHyv4ip5jmin3q-HoLrMNZgkywRFi2RKOdxa8F-I1PLBhIOxZmtNm7IBiSVPvc8q2fnKJLbxMfM680Zr9YwRrxe_XcuzE1YLdSXTc2cmy5cq8M0xQ12eMbJo1sZhGPGs7</span><br><span class="line">CryptoHelper.b result=&#123;&quot;busiCode&quot;:&quot;BASE001&quot;,&quot;code&quot;:7,&quot;content&quot;:null,&quot;handler&quot;:&quot;USER&quot;,&quot;msg&quot;:&quot;验证码无效&quot;,&quot;status&quot;:&quot;BASE_ERROR&quot;,&quot;uid&quot;:&quot;1f0080f8-238f-483a-be04-9a7e2ca4c0e61741688413791&quot;,&quot;version&quot;:&quot;101&quot;,&quot;zeusId&quot;:&quot;luckycapiproxy-0ade0957-483805-214303&quot;&#125;</span><br><span class="line">CryptoHelper.b is called: str=nMymqvoWI5UzuGSsfOyxWS9E0JQYtcev4A_O1LXSr_HosyYfsqRmenMCcYf7-mdZjZ8LUfNc6HbRD89pGuGxJhYP475VhWKSXmkD7eAkTSmxA1MpUjQQHOjueGL1F_YWGExcwjd3N-sOHxEfeB59eTF1vGH9C_S6Q5TrXqrOg1R0yv5lrZ0CUyVHr38KtyytHyv4ip5jmin3q-HoLrMNZgkywRFi2RKOdxa8F-I1PLBhIOxZmtNm7IBiSVPvc8q2fnKJLbxMfM680Zr9YwRrxe_XcuzE1YLdSXTc2cmy5cq8M0xQ12eMbJo1sZhGPGs7</span><br><span class="line">CryptoHelper.b result=&#123;&quot;busiCode&quot;:&quot;BASE001&quot;,&quot;code&quot;:7,&quot;content&quot;:null,&quot;handler&quot;:&quot;USER&quot;,&quot;msg&quot;:&quot;验证码无效&quot;,&quot;status&quot;:&quot;BASE_ERROR&quot;,&quot;uid&quot;:&quot;1f0080f8-238f-483a-be04-9a7e2ca4c0e61741688413791&quot;,&quot;version&quot;:&quot;101&quot;,&quot;zeusId&quot;:&quot;luckycapiproxy-0ade0957-483805-214303&quot;&#125;</span><br></pre></td></tr></table></figure>

<p>c方法对一堆参数加密，加密结果为q值，md5_crypt对q及其他内容进行签名，b方法对响应体和q解密</p>
<h2 id="c方法"><a href="#c方法" class="headerlink" title="c方法"></a>c方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">synchronized</span> String <span class="title function_">c</span><span class="params">(String str)</span> &#123;</span><br><span class="line">    <span class="type">c</span> <span class="variable">cVar</span> <span class="operator">=</span> <span class="built_in">this</span>.f93097a;</span><br><span class="line">    <span class="keyword">if</span> (cVar == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(StubApp.getString2(<span class="string">&quot;32267&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">String</span> <span class="variable">str2</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">String</span> <span class="variable">a10</span> <span class="operator">=</span> cVar.a();</span><br><span class="line">    <span class="keyword">if</span> (TextUtils.isEmpty(a10)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        str2 = <span class="keyword">new</span> <span class="title class_">String</span>(Base64.encode(localAESWork(str.getBytes(), <span class="number">2</span>, Base64.decode(a10.replace(org.objectweb.asm.signature.b.f127225c, org.objectweb.asm.signature.b.f127224b).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes(), <span class="number">2</span>)), <span class="number">2</span>));</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e10) &#123;</span><br><span class="line">        e10.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> str2.replace(org.objectweb.asm.signature.b.f127224b, org.objectweb.asm.signature.b.f127225c).replace(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;_&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">CryptoHelper</span><span class="params">(c cVar)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.f93097a = cVar;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里面有一个字段<code>a10</code>需要找它的来源，它来源于a方法，而它是个接口方法</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/8.jpg"></p>
<p>找它的实现类<code>com.lucky.lib.http2.b</code></p>
<p>这里面实现了<code>a</code>方法</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/9.jpg"></p>
<p>接下来通过主动调用获取它的值</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function <span class="title function_">get_a10</span><span class="params">()</span>&#123;</span><br><span class="line">    Java.perform(function()&#123;</span><br><span class="line">        <span class="type">let</span> <span class="variable">a</span> <span class="operator">=</span> Java.use(<span class="string">&quot;com.lucky.lib.http2.b$a&quot;</span>).$<span class="keyword">new</span>();</span><br><span class="line">        <span class="type">let</span> <span class="variable">result</span> <span class="operator">=</span> a.a();</span><br><span class="line">        console.log(<span class="string">&quot;a10:&quot;</span>,result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a10: qY69eWyYxkLQDygfcMavdEkJ+lDaV2IQcqdsfGGuNDs=</span><br></pre></td></tr></table></figure>

<p>接下来看这部分代码，弄清楚这里面的值和逻辑</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str2 = new String(Base64.encode(localAESWork(str.getBytes(), 2, Base64.decode(a10.replace(&#x27;-&#x27;, &#x27;+&#x27;).replace(&#x27;_&#x27;, &#x27;/&#x27;).getBytes(), 2)), 2));</span><br></pre></td></tr></table></figure>

<p>看我们hook到的结果协助分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CryptoHelper.c is called: str=&#123;&quot;mobile&quot;:&quot;17888888888&quot;,&quot;countryNo&quot;:&quot;86&quot;,&quot;validateCode&quot;:&quot;123456&quot;,&quot;appversion&quot;:&quot;5265&quot;,&quot;type&quot;:1,&quot;deviceId&quot;:&quot;android_lucky_ef5722c5-96ff-4521-8096-27530a0365b2&quot;,&quot;systemVersion&quot;:&quot;29&quot;,&quot;blackBox&quot;:&quot;oGPHE1741688414xYaSQkj72m7&quot;,&quot;uniqueCode&quot;:&quot;DUQKlOhFPQSnh57_KB6erjHdTADHhPk26j60RFVRS2xPaEZQUVNuaDU3X0tCNmVyakhkVEFESGhQazI2ajYwc2h1&quot;,&quot;regionId&quot;:&quot;CO0001&quot;,&quot;regId&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;google&quot;,&quot;isSecurityVerify&quot;:false&#125;</span><br><span class="line">CryptoHelper.c result=Xz0R82fS485b23ba817e4JzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDuk-yQQOEVQhMvN8p_dEkD23X6nDVntT3FTC90dmMItPDL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=</span><br></pre></td></tr></table></figure>

<h1 id="unidbg调用"><a href="#unidbg调用" class="headerlink" title="unidbg调用"></a>unidbg调用</h1><h2 id="初始环境搭建"><a href="#初始环境搭建" class="headerlink" title="初始环境搭建"></a>初始环境搭建</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.luckincoffee.safeboxlib;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.AndroidEmulator;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.Module;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.arm.backend.Unicorn2Factory;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.linux.android.AndroidEmulatorBuilder;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.linux.android.AndroidResolver;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.linux.android.dvm.*;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.memory.Memory;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.virtualmodule.android.AndroidModule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CryptoHelper</span> <span class="keyword">extends</span> <span class="title class_">AbstractJni</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AndroidEmulator emulator;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">String</span> <span class="variable">process</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Memory memory;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VM vm;</span><br><span class="line">    <span class="keyword">private</span> DalvikModule dm;</span><br><span class="line">    <span class="keyword">private</span> Module <span class="keyword">module</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CryptoHelper</span><span class="params">()</span> &#123;</span><br><span class="line">        emulator = AndroidEmulatorBuilder</span><br><span class="line">                .for64Bit() <span class="comment">// for32Bit()</span></span><br><span class="line">                .setProcessName(process)</span><br><span class="line">                .setRootDir(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;target/rootfs&quot;</span>))</span><br><span class="line">                .addBackendFactory(<span class="keyword">new</span> <span class="title class_">Unicorn2Factory</span>(<span class="literal">true</span>))</span><br><span class="line">                .build();</span><br><span class="line">        <span class="comment">// 设置执行多少条指令切换一次线程</span></span><br><span class="line">        <span class="comment">// emulator.getBackend().registerEmuCountHook(10000);</span></span><br><span class="line">        <span class="comment">// 开启线程调度器</span></span><br><span class="line">        <span class="comment">// emulator.getSyscallHandler().setEnableThreadDispatcher(true);</span></span><br><span class="line">        memory = emulator.getMemory();</span><br><span class="line">        memory.setLibraryResolver(<span class="keyword">new</span> <span class="title class_">AndroidResolver</span>(<span class="number">23</span>));</span><br><span class="line">        vm = emulator.createDalvikVM(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;apktest/ruixingcoffee_5.2.65.apk&quot;</span>));</span><br><span class="line">        vm.setJni(<span class="built_in">this</span>);</span><br><span class="line">        vm.setVerbose(<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">AndroidModule</span>(emulator,vm).register(memory);</span><br><span class="line">        dm = vm.loadLibrary(<span class="string">&quot;cryptoDD&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        dm.callJNI_OnLoad(emulator);</span><br><span class="line">        <span class="keyword">module</span> = dm.getModule();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">localAESWork</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">        <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;localAESWork([BI[B)[B&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&#123;\&quot;mobile\&quot;:\&quot;17888888888\&quot;,\&quot;countryNo\&quot;:\&quot;86\&quot;,\&quot;validateCode\&quot;:\&quot;123456\&quot;,\&quot;appversion\&quot;:\&quot;5265\&quot;,\&quot;type\&quot;:1,\&quot;deviceId\&quot;:\&quot;android_lucky_ef5722c5-96ff-4521-8096-27530a0365b2\&quot;,\&quot;systemVersion\&quot;:\&quot;29\&quot;,\&quot;blackBox\&quot;:\&quot;oGPHE1741688414xYaSQkj72m7\&quot;,\&quot;uniqueCode\&quot;:\&quot;DUQKlOhFPQSnh57_KB6erjHdTADHhPk26j60RFVRS2xPaEZQUVNuaDU3X0tCNmVyakhkVEFESGhQazI2ajYwc2h1\&quot;,\&quot;regionId\&quot;:\&quot;CO0001\&quot;,\&quot;regId\&quot;:\&quot;\&quot;,\&quot;deviceBrand\&quot;:\&quot;google\&quot;,\&quot;isSecurityVerify\&quot;:false&#125;&quot;</span>.getBytes(),</span><br><span class="line">                <span class="number">2</span>,</span><br><span class="line">                Base64.getDecoder().decode(<span class="string">&quot;qY69eWyYxkLQDygfcMavdEkJ+lDaV2IQcqdsfGGuNDs=&quot;</span>.replace(<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>).replace(<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).getBytes()));</span><br><span class="line">        <span class="type">String</span> <span class="variable">ret</span> <span class="operator">=</span> bytesTohexString(byteValues.getValue());</span><br><span class="line">        System.out.println(<span class="string">&quot;ret=&quot;</span>+ret);</span><br><span class="line">        <span class="type">String</span> <span class="variable">b64encoded</span> <span class="operator">=</span> Base64.getEncoder().encodeToString(byteValues.getValue());</span><br><span class="line">        System.out.println(b64encoded);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">CryptoHelper</span> <span class="variable">cryptoHelper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CryptoHelper</span>();</span><br><span class="line">        cryptoHelper.localAESWork();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下，报错了，看打印的信息</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JNIEnv-&gt;NewByteArray(416) was called from RX@0x12043ae4[libcryptoDD.so]0x43ae4</span><br><span class="line">JNIEnv-&gt;SetByteArrayRegion([B@72a7c7e0, 0, 416, RW@0x123991c0) was called from RX@0x12043b08[libcryptoDD.so]0x43b08</span><br><span class="line">[10:38:44 101]  WARN [com.github.unidbg.arm.AbstractARM64Emulator] (AbstractARM64Emulator$1:66) - Write memory failed: address=0x0, size=8, value=0x12057000</span><br></pre></td></tr></table></figure>

<p>在<code>0x43b08</code>这个地方报错了，IDA分析一下</p>
<p>在下面这个地方，内存无法写入</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/10.jpg"></p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/11.jpg"></p>
<p>用unidbg处理一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">patchFreeByConsoleDebugger</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">Symbol</span> <span class="variable">free</span> <span class="operator">=</span> emulator.getMemory().findModule(<span class="string">&quot;libc.so&quot;</span>).findSymbolByName(<span class="string">&quot;free&quot;</span>);</span><br><span class="line"></span><br><span class="line">    emulator.attach().addBreakPoint(free.getAddress(), <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">            emulator.getBackend().reg_write(Arm64Const.UC_ARM64_REG_W0,<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后可以输出正确结果了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ret=5f3d11f367d2e3ce5bdb76daf35edee03b1b6ce1b3c1846a175a1ec87bc6c9ddc66d65a239b38f7b7727befc6a17c44a3fa7921c901c66596ca7cedacc48a08db0cb0931efcbb9a7afbf9ab379d992ba66f84c3e529d4e2f96072db2212bc9ab4225a162ee55d4ea0e9648d49d532735fe628c175e6b81163b05bf97bd030634c09dc45f0e536b75dd1f29f8ea328eb60907c08ff1c309d7ea64257aad490fe7a50f06c86d33a6cfcd1494ec5ae0b07fc4d1dc5094a6161985ebee8bac53057e07603836b0bcc15b34dcaa4f8ff361b5df5855e5f5f9d4c8b8c5c0f9c936f697c37795ac6ef7fb66513216f2019d08fd477ef712b4cf4036441a0a56e429f3fc440bbfce851936683e74024fc1abcfeb50480f747fcaabf346eebca3d5881ecbbaf639c96a6db5f22d362223bc766e39fc0a4472b197a5be78f2bf947afe15660b97c9b496d0e39103ed77672327ab36c7920e6d763f1271bb017615c49afcb50429218b6f3d76156129095eb1082f33bbc2f732f7ba76584b04cd388aadc16e0faaf872eecb1810a6bb25ae9532a600bf2b597e2e50bb97d0df5fa4a7457f53</span><br><span class="line">Xz0R82fS485b23ba817e4DsbbOGzwYRqF1oeyHvGyd3GbWWiObOPe3cnvvxqF8RKP6eSHJAcZllsp87azEigjbDLCTHvy7mnr7+as3nZkrpm+Ew+Up1OL5YHLbIhK8mrQiWhYu5V1OoOlkjUnVMnNf5ijBdea4EWOwW/l70DBjTAncRfDlNrdd0fKfjqMo62CQfAj/HDCdfqZCV6rUkP56UPBshtM6bPzRSU7FrgsH/E0dxQlKYWGYXr7ousUwV+B2A4NrC8wVs03KpPj/Nhtd9YVeX1+dTIuMXA+ck29pfDd5Wsbvf7ZlEyFvIBnQj9R373ErTPQDZEGgpW5Cnz/EQLv86FGTZoPnQCT8Grz+tQSA90f8qr80buvKPViB7LuvY5yWpttfItNiIjvHZuOfwKRHKxl6W+ePK/lHr+FWYLl8m0ltDjkQPtd2cjJ6s2x5IObXY/EnG7AXYVxJr8tQQpIYtvPXYVYSkJXrEILzO7wvcy97p2WEsEzTiKrcFuD6r4cu7LGBCmuyWulTKmAL8rWX4uULuX0N9fpKdFf1M=</span><br></pre></td></tr></table></figure>

<h2 id="打印详细日志信息"><a href="#打印详细日志信息" class="headerlink" title="打印详细日志信息"></a>打印详细日志信息</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.log4j.Level;</span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ARM64 JNI 详细日志</span></span><br><span class="line">        Logger.getLogger(DalvikVM64.class).setLevel(Level.DEBUG);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ARM32 JNI 详细日志</span></span><br><span class="line">        Logger.getLogger(DalvikVM.class).setLevel(Level.DEBUG);</span><br></pre></td></tr></table></figure>

<p>把<code>Logger.getLogger(DalvikVM64.class).setLevel(Level.DEBUG);</code>添加到<code>localAESWork()</code>方法里</p>
<h2 id="使用简单的明文测试"><a href="#使用简单的明文测试" class="headerlink" title="使用简单的明文测试"></a>使用简单的明文测试</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">明文用：bileton</span><br><span class="line">hex:fd2bd308e45a3d24b2c715b54b92713f</span><br><span class="line">base64:/SvTCORaPSSyxxW1S5JxPw==</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">JNIEnv-&gt;NewByteArray(16) was called from RX@0x12043ae4[libcryptoDD.so]0x43ae4</span><br><span class="line">JNIEnv-&gt;SetByteArrayRegion([B@0x00000000000000000000000000000000, 0, 16, RW@0x12399010) was called from RX@0x12043b08[libcryptoDD.so]0x43b08</span><br><span class="line"></span><br><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[11:59:10 243]SetByteArrayRegion array=[B@0x00000000000000000000000000000000, start=0, length=16, buf=RW@0x12399010, md5=f640f07e317bb73715399251206b7cdd, hex=fd2bd308e45a3d24b2c715b54b92713f</span><br><span class="line">size: 16</span><br><span class="line">0000: FD 2B D3 08 E4 5A 3D 24 B2 C7 15 B5 4B 92 71 3F    .+...Z=$....K.q?</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br><span class="line">[11:59:10 243] DEBUG [com.github.unidbg.linux.android.dvm.DalvikVM64] (DalvikVM64$189:3075) - ReleaseByteArrayElements arrayPointer=unidbg@0x3e92efc3, pointer=RW@0x12056000, mode=0</span><br><span class="line">ret=fd2bd308e45a3d24b2c715b54b92713f</span><br><span class="line">/SvTCORaPSSyxxW1S5JxPw==</span><br></pre></td></tr></table></figure>

<p>根据日志看到结果是在<code>0x12399010</code>这个地方来的</p>
<h2 id="trace-0x12399010"><a href="#trace-0x12399010" class="headerlink" title="trace 0x12399010"></a>trace 0x12399010</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emulator.traceWrite(<span class="number">0x12399010</span>,<span class="number">0x12399010</span>+<span class="number">0x10</span>);</span><br></pre></td></tr></table></figure>

<p>这是trace下俩的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[12:07:18 602] Memory WRITE at 0x12399010, data size = 8, data value = 0x0000000000000000, PC=RX@0x121bc688[libc.so]0x1c688, LR=RX@0x12043970[libcryptoDD.so]0x43970</span><br><span class="line">[12:07:18 603] Memory WRITE at 0x12399018, data size = 8, data value = 0x0000000000000000, PC=RX@0x121bc688[libc.so]0x1c688, LR=RX@0x12043970[libcryptoDD.so]0x43970</span><br><span class="line">[12:07:18 603] Memory WRITE at 0x12399010, data size = 8, data value = 0x0000000000000000, PC=RX@0x121bc694[libc.so]0x1c694, LR=RX@0x12043970[libcryptoDD.so]0x43970</span><br><span class="line">[12:07:18 603] Memory WRITE at 0x12399018, data size = 8, data value = 0x0000000000000000, PC=RX@0x121bc694[libc.so]0x1c694, LR=RX@0x12043970[libcryptoDD.so]0x43970</span><br><span class="line">[12:07:18 608] Memory WRITE at 0x12399010, data size = 8, data value = 0x243d5ae408d32bfd, PC=RX@0x12018940[libcryptoDD.so]0x18940, LR=RX@0x1201892c[libcryptoDD.so]0x1892c</span><br><span class="line">[12:07:18 608] Memory WRITE at 0x12399018, data size = 8, data value = 0x3f71924bb515c7b2, PC=RX@0x12018940[libcryptoDD.so]0x18940, LR=RX@0x1201892c[libcryptoDD.so]0x1892c</span><br></pre></td></tr></table></figure>

<p>这里看到数据写入的位置是在<code>0x18940</code>，数据是以小端存储的LR寄存器的值是<code>0x1892c</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x243d5ae408d32bfd</span><br><span class="line">0x3f71924bb515c7b2</span><br></pre></td></tr></table></figure>

<h2 id="使用IDA分析0x1892c"><a href="#使用IDA分析0x1892c" class="headerlink" title="使用IDA分析0x1892c"></a>使用IDA分析0x1892c</h2><p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/12.jpg"></p>
<p>反汇编</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/13.jpg"></p>
<h2 id="分析sub-189C4"><a href="#分析sub-189C4" class="headerlink" title="分析sub_189C4()"></a>分析<code>sub_189C4()</code></h2><p>下断点打印参数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">emulator.attach().addBreakPoint(module.base+0x189C4);</span><br></pre></td></tr></table></figure>

<p>打印X0寄存器的值</p>
<p>如下是输入的明文</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/14.jpg"></p>
<p>打印X1寄存器的值</p>
<p>如下是一段空值</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/15.jpg"></p>
<p>根据入参的值，看它被传进了哪个函数里找到AES加密的位置</p>
<p>找到一个函数<code>sub_21BEC()</code></p>
<p>它的内容比较可疑</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/16.jpg"></p>
<p>对这个函数进行hook</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">emulator.attach().addBreakPoint(<span class="keyword">module</span>.base + <span class="number">0x21BEC</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        System.out.println(count);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>如下打印了10次</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/17.jpg"></p>
<p>先保留一份正确的密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fd2bd308e45a3d24b2c715b54b92713f</span><br></pre></td></tr></table></figure>

<p>然后在第九轮的时候进行故障注入</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/18.jpg"></p>
<h1 id="故障注入差分"><a href="#故障注入差分" class="headerlink" title="故障注入差分"></a>故障注入差分</h1><h2 id="故障注入1"><a href="#故障注入1" class="headerlink" title="故障注入1"></a>故障注入1</h2><p>对这几个寄存器进行故障注入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">emulator.attach().addBreakPoint(<span class="keyword">module</span>.base + <span class="number">0x21E8C</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(count==<span class="number">9</span>)&#123;</span><br><span class="line">            <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">            emulator.getBackend().reg_write(Arm64Const.UC_ARM64_REG_W9,random.nextInt(<span class="number">255</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>循环10次</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="type">CryptoHelper</span> <span class="variable">cryptoHelper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CryptoHelper</span>();</span><br><span class="line">    cryptoHelper.patchFreeByConsoleDebugger();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">        cryptoHelper.localAESWork();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>循环10次，输出密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fd2bbc08e43b3d24eec715b54b927120</span><br><span class="line">fd2b2c08e48c3d246dc715b54b9271e1</span><br><span class="line">fd2bb208e49f3d2496c715b54b927197</span><br><span class="line">fd2b7f08e4873d24b8c715b54b9271fa</span><br><span class="line">fd2b4e08e4573d24efc715b54b927118</span><br><span class="line">fd2b2608e4eb3d247ec715b54b9271d2</span><br><span class="line">fd2b6708e4963d2442c715b54b927180</span><br><span class="line">fd2b4508e4ea3d2443c715b54b927153</span><br><span class="line">fd2b1908e4c93d24e4c715b54b927166</span><br><span class="line">fd2b5408e4943d246fc715b54b92717c</span><br></pre></td></tr></table></figure>

<h2 id="差分1"><a href="#差分1" class="headerlink" title="差分1"></a>差分1</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> phoenixAES</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;tracefile&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> t:</span><br><span class="line">    t.write(<span class="string">&quot;&quot;&quot;fd2bd308e45a3d24b2c715b54b92713f</span></span><br><span class="line"><span class="string">fd2bbc08e43b3d24eec715b54b927120</span></span><br><span class="line"><span class="string">fd2b2c08e48c3d246dc715b54b9271e1</span></span><br><span class="line"><span class="string">fd2bb208e49f3d2496c715b54b927197</span></span><br><span class="line"><span class="string">fd2b7f08e4873d24b8c715b54b9271fa</span></span><br><span class="line"><span class="string">fd2b4e08e4573d24efc715b54b927118</span></span><br><span class="line"><span class="string">fd2b2608e4eb3d247ec715b54b9271d2</span></span><br><span class="line"><span class="string">fd2b6708e4963d2442c715b54b927180</span></span><br><span class="line"><span class="string">fd2b4508e4ea3d2443c715b54b927153</span></span><br><span class="line"><span class="string">fd2b1908e4c93d24e4c715b54b927166</span></span><br><span class="line"><span class="string">fd2b5408e4943d246fc715b54b92717c</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.encode(<span class="string">&#x27;utf8&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">phoenixAES.crack_file(<span class="string">&#x27;tracefile&#x27;</span>, [], <span class="literal">True</span>, <span class="literal">False</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Round key bytes recovered:</span><br><span class="line">....ED....D2....C0............C0</span><br></pre></td></tr></table></figure>

<h2 id="故障注入2"><a href="#故障注入2" class="headerlink" title="故障注入2"></a>故障注入2</h2><p>换一个寄存器</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">emulator.attach().addBreakPoint(<span class="keyword">module</span>.base + <span class="number">0x21E90</span>, <span class="keyword">new</span> <span class="title class_">BreakPointCallback</span>() &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">onHit</span><span class="params">(Emulator&lt;?&gt; emulator, <span class="type">long</span> address)</span> &#123;</span><br><span class="line">        count++;</span><br><span class="line">        <span class="keyword">if</span>(count==<span class="number">9</span>)&#123;</span><br><span class="line">            <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">            emulator.getBackend().reg_write(Arm64Const.UC_ARM64_REG_W10,random.nextInt(<span class="number">255</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fd2bd34ae45afb24b22315b5a192713f</span><br><span class="line">fd2bd375e45aae24b2b515b5b892713f</span><br><span class="line">fd2bd3aae45abe24b2af15b55a92713f</span><br><span class="line">fd2bd3bbe45ad424b24515b57b92713f</span><br><span class="line">fd2bd38be45a6e24b2a615b56192713f</span><br><span class="line">fd2bd344e45aba24b29515b5f692713f</span><br><span class="line">fd2bd306e45ac324b23a15b5dd92713f</span><br><span class="line">fd2bd3d5e45a4424b24a15b53792713f</span><br><span class="line">fd2bd3bae45a9a24b2e615b51592713f</span><br><span class="line">fd2bd33de45a4724b2a515b51692713f</span><br></pre></td></tr></table></figure>

<h2 id="差分2"><a href="#差分2" class="headerlink" title="差分2"></a>差分2</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import phoenixAES</span><br><span class="line"></span><br><span class="line">with open(&quot;tracefile&quot;,&quot;wb&quot;) as t:</span><br><span class="line">    t.write(&quot;&quot;&quot;fd2bd308e45a3d24b2c715b54b92713f</span><br><span class="line">fd2bbc08e43b3d24eec715b54b927120</span><br><span class="line">fd2b2c08e48c3d246dc715b54b9271e1</span><br><span class="line">fd2bb208e49f3d2496c715b54b927197</span><br><span class="line">fd2b7f08e4873d24b8c715b54b9271fa</span><br><span class="line">fd2b4e08e4573d24efc715b54b927118</span><br><span class="line">fd2b2608e4eb3d247ec715b54b9271d2</span><br><span class="line">fd2b6708e4963d2442c715b54b927180</span><br><span class="line">fd2b4508e4ea3d2443c715b54b927153</span><br><span class="line">fd2b1908e4c93d24e4c715b54b927166</span><br><span class="line">fd2b5408e4943d246fc715b54b92717c</span><br><span class="line">fd2bd34ae45afb24b22315b5a192713f</span><br><span class="line">fd2bd375e45aae24b2b515b5b892713f</span><br><span class="line">fd2bd3aae45abe24b2af15b55a92713f</span><br><span class="line">fd2bd3bbe45ad424b24515b57b92713f</span><br><span class="line">fd2bd38be45a6e24b2a615b56192713f</span><br><span class="line">fd2bd344e45aba24b29515b5f692713f</span><br><span class="line">fd2bd306e45ac324b23a15b5dd92713f</span><br><span class="line">fd2bd3d5e45a4424b24a15b53792713f</span><br><span class="line">fd2bd3bae45a9a24b2e615b51592713f</span><br><span class="line">fd2bd33de45a4724b2a515b51692713f</span><br><span class="line">&quot;&quot;&quot;.encode(&#x27;utf8&#x27;))</span><br><span class="line">    </span><br><span class="line">phoenixAES.crack_file(&#x27;tracefile&#x27;, [], True, False, 3)</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Round key bytes recovered:</span><br><span class="line">....EDFD..D27D..C0D0....4E....C0</span><br></pre></td></tr></table></figure>

<h2 id="故障注入3"><a href="#故障注入3" class="headerlink" title="故障注入3"></a>故障注入3</h2><p>修改hook地址和寄存器</p>
<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fa2bd308e45a3dc7b2c737b54b48713f</span><br><span class="line">132bd308e45a3d96b2c7afb54b72713f</span><br><span class="line">aa2bd308e45a3d7db2c798b54bee713f</span><br><span class="line">7d2bd308e45a3de9b2c708b54ba6713f</span><br><span class="line">252bd308e45a3dd4b2c79db54bb8713f</span><br><span class="line">f92bd308e45a3d40b2c704b54b3f713f</span><br><span class="line">c62bd308e45a3d60b2c782b54b0b713f</span><br><span class="line">022bd308e45a3d7eb2c738b54b5d713f</span><br><span class="line">5a2bd308e45a3d3db2c7b6b54bd0713f</span><br><span class="line">152bd308e45a3d0db2c7c9b54bbc713f</span><br></pre></td></tr></table></figure>

<h2 id="差分3"><a href="#差分3" class="headerlink" title="差分3"></a>差分3</h2><p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Round key bytes recovered:</span><br><span class="line">A3..EDFD..D27DD1C0D010..4EFC..C0</span><br></pre></td></tr></table></figure>

<h2 id="故障注入4"><a href="#故障注入4" class="headerlink" title="故障注入4"></a>故障注入4</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fdd7d308275a3d24b2c715bf4b929d3f</span><br><span class="line">fd41d308e75a3d24b2c715b14b92d73f</span><br><span class="line">fdb8d308f15a3d24b2c715954b92fe3f</span><br><span class="line">fd69d3089a5a3d24b2c715094b92823f</span><br><span class="line">fdd4d308b85a3d24b2c7156b4b92cd3f</span><br><span class="line">fd2dd308b45a3d24b2c715254b921c3f</span><br><span class="line">fdd8d308035a3d24b2c715934b927d3f</span><br><span class="line">fd03d308a65a3d24b2c715274b92303f</span><br><span class="line">fdc0d308d35a3d24b2c715674b927b3f</span><br><span class="line">fd98d3087a5a3d24b2c715eb4b92783f</span><br></pre></td></tr></table></figure>

<h2 id="差分4"><a href="#差分4" class="headerlink" title="差分4"></a>差分4</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Round key bytes recovered:</span><br><span class="line">A3AEEDFD2DD27DD1C0D010724EFCCBC0</span><br></pre></td></tr></table></figure>

<p>好了，这就是第10轮的轮密钥</p>
<h1 id="由第10轮的轮密钥推算初始密钥"><a href="#由第10轮的轮密钥推算初始密钥" class="headerlink" title="由第10轮的轮密钥推算初始密钥"></a>由第10轮的轮密钥推算初始密钥</h1><p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/19.jpg"></p>
<p>推出初始密钥为：32395842753445546A487830596E6643</p>
<p>验证下，如下加密结果正确</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/20.jpg"></p>
<p>CyberChef中处理不了字符串的replace，如下</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/21.jpg"></p>
<h1 id="Python生成q"><a href="#Python生成q" class="headerlink" title="Python生成q"></a>Python生成q</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt_ecb</span>(<span class="params">plaintext,key</span>):</span><br><span class="line">    cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    padded_data = pad(plaintext,AES.block_size)</span><br><span class="line">    encrypted_data = cipher.encrypt(padded_data)</span><br><span class="line">    <span class="keyword">return</span> encrypted_data</span><br><span class="line"></span><br><span class="line">data = <span class="string">b&#x27;&#123;&quot;mobile&quot;:&quot;17888888888&quot;,&quot;countryNo&quot;:&quot;86&quot;,&quot;validateCode&quot;:&quot;123456&quot;,&quot;appversion&quot;:&quot;5265&quot;,&quot;type&quot;:1,&quot;deviceId&quot;:&quot;android_lucky_ef5722c5-96ff-4521-8096-27530a0365b2&quot;,&quot;systemVersion&quot;:&quot;29&quot;,&quot;blackBox&quot;:&quot;oGPHE1741688414xYaSQkj72m7&quot;,&quot;uniqueCode&quot;:&quot;DUQKlOhFPQSnh57_KB6erjHdTADHhPk26j60RFVRS2xPaEZQUVNuaDU3X0tCNmVyakhkVEFESGhQazI2ajYwc2h1&quot;,&quot;regionId&quot;:&quot;CO0001&quot;,&quot;regId&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;google&quot;,&quot;isSecurityVerify&quot;:false&#125;&#x27;</span></span><br><span class="line">key = <span class="string">b&quot;29XBu4ETjHx0YnfC&quot;</span></span><br><span class="line">aes_encrypted_data = aes_encrypt_ecb(data,key=key)</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(aes_encrypted_data).decode(<span class="string">&quot;utf-8&quot;</span>).replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;-&quot;</span>).replace(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;_&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="unidbg调用md5-crypt"><a href="#unidbg调用md5-crypt" class="headerlink" title="unidbg调用md5_crypt"></a>unidbg调用md5_crypt</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">md5_crypt</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">DvmClass</span> <span class="variable">CryptoHelperClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.luckincoffee.safeboxlib.CryptoHelper&quot;</span>);</span><br><span class="line">    <span class="type">String</span> <span class="variable">bArr</span> <span class="operator">=</span> <span class="string">&quot;cid=210101;q=Xz0R82fS485b23ba817e4JzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDuk-yQQOEVQhMvN8p_dEkD23X6nDVntT3FTC90dmMItPDL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=;t=1741699524789;uid=1f0080f8-238f-483a-be04-9a7e2ca4c0e61741688413791&quot;</span>;</span><br><span class="line">    <span class="type">byte</span>[] bArr2 = &#123;-<span class="number">87</span>,-<span class="number">114</span>,-<span class="number">67</span>,<span class="number">121</span>,<span class="number">108</span>,-<span class="number">104</span>,-<span class="number">58</span>,<span class="number">66</span>,-<span class="number">48</span>,<span class="number">15</span>,<span class="number">40</span>,<span class="number">31</span>,<span class="number">112</span>,-<span class="number">58</span>,-<span class="number">81</span>,<span class="number">116</span>,<span class="number">73</span>,<span class="number">9</span>,-<span class="number">6</span>,<span class="number">80</span>,-<span class="number">38</span>,<span class="number">87</span>,<span class="number">98</span>,<span class="number">16</span>,<span class="number">114</span>,-<span class="number">89</span>,<span class="number">108</span>,<span class="number">124</span>,<span class="number">97</span>,-<span class="number">82</span>,<span class="number">52</span>,<span class="number">59</span>&#125;;</span><br><span class="line">    <span class="type">ByteArray</span> <span class="variable">byteValues</span> <span class="operator">=</span> CryptoHelperClass.callStaticJniMethodObject(emulator, <span class="string">&quot;md5_crypt([BI[B)[B&quot;</span>,</span><br><span class="line">            bArr.getBytes(),</span><br><span class="line">            <span class="number">1</span>,</span><br><span class="line">            bArr2);</span><br><span class="line">    <span class="type">String</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(byteValues.getValue());</span><br><span class="line">    System.out.println(ret);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出并打印详细日志</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">JNIEnv-&gt;SetByteArrayRegion([B@0x0000000000000000000000000000000000000000000000000000000000000000000000000000, 0, 38, RW@0x12393030) was called from RX@0x120441a8[libcryptoDD.so]0x441a8</span><br><span class="line">&gt;-----------------------------------------------------------------------------&lt;</span><br><span class="line">[21:08:40 131]SetByteArrayRegion array=[B@0x0000000000000000000000000000000000000000000000000000000000000000000000000000, start=0, length=38, buf=RW@0x12393030, md5=05dca414c8058fff5156a7ec4d10303f, hex=3135373236313433313135323736383536313235353430303538333131343137313330353532</span><br><span class="line">size: 38</span><br><span class="line">0000: 31 35 37 32 36 31 34 33 31 31 35 32 37 36 38 35    1572614311527685</span><br><span class="line">0010: 36 31 32 35 35 34 30 30 35 38 33 31 31 34 31 37    6125540058311417</span><br><span class="line">0020: 31 33 30 35 35 32                                  130552</span><br><span class="line">^-----------------------------------------------------------------------------^</span><br><span class="line">[21:08:40 132] DEBUG [com.github.unidbg.linux.android.dvm.DalvikVM64] (DalvikVM64$189:3075) - ReleaseByteArrayElements arrayPointer=unidbg@0x659a969b, pointer=RW@0x12056000, mode=0</span><br><span class="line">15726143115276856125540058311417130552</span><br></pre></td></tr></table></figure>

<p>使用简单明文参数<code>bileton</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">76453193612323879985881527471282403340</span><br></pre></td></tr></table></figure>

<p>根据可以看出数据来源于<code>0x441a8</code>这个地址处，到IDA里找到这个地址</p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/22.jpg"></p>
<p>到IDA里看没发现什么</p>
<p>反汇编后，看传入的明文参数的传递过程，到了<code>sub_4095C()</code></p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/23.jpg"></p>
<p>通过断点调试查看参数，发现数据后面加了盐<code>29XBu4ETjHx0YnfC</code></p>
<p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/24.jpg"></p>
<h2 id="md5"><a href="#md5" class="headerlink" title="md5"></a>md5</h2><p><img src="/2025/03/11/%E7%91%9E%E5%B9%B8%E7%99%BD%E7%9B%92AES/25.jpg"></p>
<p>这里后面分析不下来了，看了别人的文章了解到对md5的结果又进行了处理，这里直接把算法搬过来</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">getsign</span>():</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        encode_str = <span class="string">&#x27;d26e2b204974bf9edcf18055b39013f4&#x27;</span></span><br><span class="line">        i*=<span class="number">4</span></span><br><span class="line">        result = (<span class="built_in">int</span>(encode_str[(i+<span class="number">1</span>)*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">16</span>) | (<span class="built_in">int</span>(encode_str[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">24</span>) | (<span class="built_in">int</span>(encode_str[(i+<span class="number">2</span>)*<span class="number">2</span>:(i+<span class="number">2</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">8</span>) | <span class="built_in">int</span>(encode_str[(i+<span class="number">3</span>)*<span class="number">2</span>:(i+<span class="number">3</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)</span><br><span class="line">        result &amp;= <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> result &amp; <span class="number">0x80000000</span>:</span><br><span class="line">            result = -((result ^ <span class="number">0xffffffff</span>) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> result&lt;<span class="number">0</span>:</span><br><span class="line">            result = -result</span><br><span class="line">        res+=<span class="built_in">str</span>(result)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">getsign()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 76453193612323879985881527471282403340</span></span><br></pre></td></tr></table></figure>

<h1 id="Python实现md5-crypt"><a href="#Python实现md5-crypt" class="headerlink" title="Python实现md5_crypt"></a>Python实现md5_crypt</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_call</span>(<span class="params">encoded_data</span>):</span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(encoded_data)</span><br><span class="line">    <span class="keyword">return</span> md5.digest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getsign</span>(<span class="params">encode_str</span>):</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        i*=<span class="number">4</span></span><br><span class="line">        result = (<span class="built_in">int</span>(encode_str[(i+<span class="number">1</span>)*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">16</span>) | (<span class="built_in">int</span>(encode_str[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">24</span>) | (<span class="built_in">int</span>(encode_str[(i+<span class="number">2</span>)*<span class="number">2</span>:(i+<span class="number">2</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">8</span>) | <span class="built_in">int</span>(encode_str[(i+<span class="number">3</span>)*<span class="number">2</span>:(i+<span class="number">3</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)</span><br><span class="line">        result &amp;= <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> result &amp; <span class="number">0x80000000</span>:</span><br><span class="line">            result = -((result ^ <span class="number">0xffffffff</span>) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> result&lt;<span class="number">0</span>:</span><br><span class="line">            result = -result</span><br><span class="line">        res+=<span class="built_in">str</span>(result)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;bileton&quot;</span></span><br><span class="line">salt = <span class="string">&quot;29XBu4ETjHx0YnfC&quot;</span></span><br><span class="line">md5 = <span class="built_in">bytes</span>.<span class="built_in">hex</span>(md5_call((data+salt).encode(<span class="string">&quot;utf-8&quot;</span>)))</span><br><span class="line"><span class="built_in">print</span>(md5)</span><br><span class="line"><span class="built_in">print</span>(getsign(md5))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 76453193612323879985881527471282403340</span></span><br></pre></td></tr></table></figure>



<h1 id="Python实现响应体解密"><a href="#Python实现响应体解密" class="headerlink" title="Python实现响应体解密"></a>Python实现响应体解密</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypted_ecb</span>(<span class="params">encrypted_data,key</span>):</span><br><span class="line">    cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    decrypted_data = cipher.decrypt(encrypted_data)</span><br><span class="line">    unpadded_data = unpad(decrypted_data,AES.block_size)</span><br><span class="line">    <span class="keyword">return</span> unpadded_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toStandardB64</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;+&quot;</span>).replace(<span class="string">&quot;_&quot;</span>,<span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ciphertext = <span class="string">&quot;nMymqvoWI5UzuGSsfOyxWS9E0JQYtcev4A_O1LXSr_HosyYfsqRmenMCcYf7-mdZjZ8LUfNc6HbRD89pGuGxJhYP475VhWKSXmkD7eAkTSmxA1MpUjQQHOjueGL1F_YWGExcwjd3N-sOHxEfeB59eTF1vGH9C_S6Q5TrXqrOg1R0yv5lrZ0CUyVHr38KtyytHyv4ip5jmin3q-HoLrMNZgkywRFi2RKOdxa8F-I1PLBhIOxZmtNm7IBiSVPvc8q2fnKJLbxMfM680Zr9YwRrxe_XcuzE1YLdSXTc2cmy5cq8M0xQ12eMbJo1sZhGPGs7&quot;</span></span><br><span class="line"></span><br><span class="line">standardb64 = toStandardB64(ciphertext).encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">plaintext = aes_decrypted_ecb(base64.b64decode(standardb64),<span class="string">b&quot;29XBu4ETjHx0YnfC&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;busiCode&quot;:&quot;BASE001&quot;,&quot;code&quot;:7,&quot;content&quot;:null,&quot;handler&quot;:&quot;USER&quot;,&quot;msg&quot;:&quot;验证码无效&quot;,&quot;status&quot;:&quot;BASE_ERROR&quot;,&quot;uid&quot;:&quot;1f0080f8-238f-483a-be04-9a7e2ca4c0e61741688413791&quot;,&quot;version&quot;:&quot;101&quot;,&quot;zeusId&quot;:&quot;luckycapiproxy-0ade0957-483805-214303&quot;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="整合代码，实现完整流程"><a href="#整合代码，实现完整流程" class="headerlink" title="整合代码，实现完整流程"></a>整合代码，实现完整流程</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt_ecb</span>(<span class="params">plaintext,key</span>):</span><br><span class="line">    cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    padded_data = pad(plaintext,AES.block_size)</span><br><span class="line">    encrypted_data = cipher.encrypt(padded_data)</span><br><span class="line">    <span class="keyword">return</span> encrypted_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypted_ecb</span>(<span class="params">encrypted_data,key</span>):</span><br><span class="line">    cipher = AES.new(key,AES.MODE_ECB)</span><br><span class="line">    decrypted_data = cipher.decrypt(encrypted_data)</span><br><span class="line">    unpadded_data = unpad(decrypted_data,AES.block_size)</span><br><span class="line">    <span class="keyword">return</span> unpadded_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">toStandardB64</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="keyword">return</span> data.replace(<span class="string">&quot;-&quot;</span>,<span class="string">&quot;+&quot;</span>).replace(<span class="string">&quot;_&quot;</span>,<span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_call</span>(<span class="params">encoded_data</span>):</span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(encoded_data)</span><br><span class="line">    <span class="keyword">return</span> md5.digest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getsign</span>(<span class="params">encode_str</span>):</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        i*=<span class="number">4</span></span><br><span class="line">        result = (<span class="built_in">int</span>(encode_str[(i+<span class="number">1</span>)*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">16</span>) | (<span class="built_in">int</span>(encode_str[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">24</span>) | (<span class="built_in">int</span>(encode_str[(i+<span class="number">2</span>)*<span class="number">2</span>:(i+<span class="number">2</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)&lt;&lt;<span class="number">8</span>) | <span class="built_in">int</span>(encode_str[(i+<span class="number">3</span>)*<span class="number">2</span>:(i+<span class="number">3</span>)*<span class="number">2</span>+<span class="number">2</span>],<span class="number">16</span>)</span><br><span class="line">        result &amp;= <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> result &amp; <span class="number">0x80000000</span>:</span><br><span class="line">            result = -((result ^ <span class="number">0xffffffff</span>) + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> result&lt;<span class="number">0</span>:</span><br><span class="line">            result = -result</span><br><span class="line">        res+=<span class="built_in">str</span>(result)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g_q</span>():</span><br><span class="line">    data = <span class="string">b&#x27;&#123;&quot;mobile&quot;:&quot;17888888888&quot;,&quot;countryNo&quot;:&quot;86&quot;,&quot;validateCode&quot;:&quot;123456&quot;,&quot;appversion&quot;:&quot;5265&quot;,&quot;type&quot;:1,&quot;deviceId&quot;:&quot;android_lucky_ef5722c5-96ff-4521-8096-27530a0365b2&quot;,&quot;systemVersion&quot;:&quot;29&quot;,&quot;blackBox&quot;:&quot;oGPHE1741688414xYaSQkj72m7&quot;,&quot;uniqueCode&quot;:&quot;DUQKlOhFPQSnh57_KB6erjHdTADHhPk26j60RFVRS2xPaEZQUVNuaDU3X0tCNmVyakhkVEFESGhQazI2ajYwc2h1&quot;,&quot;regionId&quot;:&quot;CO0001&quot;,&quot;regId&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;google&quot;,&quot;isSecurityVerify&quot;:false&#125;&#x27;</span></span><br><span class="line">    key = <span class="string">b&quot;29XBu4ETjHx0YnfC&quot;</span></span><br><span class="line">    aes_encrypted_data = aes_encrypt_ecb(data,key=key)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(aes_encrypted_data).decode(<span class="string">&quot;utf-8&quot;</span>).replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;-&quot;</span>).replace(<span class="string">&quot;/&quot;</span>,<span class="string">&quot;_&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_response</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    standardb64 = toStandardB64(ciphertext).encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    plaintext = aes_decrypted_ecb(base64.b64decode(standardb64),<span class="string">b&quot;29XBu4ETjHx0YnfC&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> plaintext.decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://capi.lkcoffee.com/resource/m/user/login&quot;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&quot;x-lk-akv&quot;</span>: <span class="string">&quot;5265&quot;</span>,</span><br><span class="line">  <span class="string">&quot;x-lk-mid&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;x-lk-sid&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;event_id&quot;</span>: <span class="string">&quot;1741773373890&quot;</span>,</span><br><span class="line">  <span class="string">&quot;x-lk-csid&quot;</span>: <span class="string">&quot;b23ee6cb-c0f2-4e43-9580-727ce47f7b73&quot;</span>,</span><br><span class="line">  <span class="string">&quot;sentry-trace&quot;</span>: <span class="string">&quot;5d4028a1977c401da7dc5299c9fe942f-11ad2f67d12f4343-0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;baggage&quot;</span>: <span class="string">&quot;sentry-environment=release,sentry-public_key=d4365939f7c346a4b0c6ee50a412c050,sentry-release=com.lucky.luckyclient%405.2.65%2B201,sentry-sample_rate=0,sentry-trace_id=5d4028a1977c401da7dc5299c9fe942f,sentry-transaction=LoginActivity.btnConfirm&quot;</span>,</span><br><span class="line">  <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">  <span class="string">&quot;content-length&quot;</span>: <span class="string">&quot;684&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accept-encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span>,</span><br><span class="line">  <span class="string">&quot;cookie&quot;</span>: <span class="string">&quot;uid=ede6c26f-85eb-4f41-b103-051605ae1c821741773364713&quot;</span>,</span><br><span class="line">  <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;okhttp/4.9.3&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body = &#123;</span><br><span class="line"><span class="comment">#   &quot;sign&quot;: &quot;7964953862091852252935269275418960748&quot;,</span></span><br><span class="line"><span class="comment">#   &quot;q&quot;: &quot;-YqmJeyS17YrIsczlOeETZzPH0DbB-Hyhw09ZJUl9kZ4SZ_KkVh07uBqj8ejykTw1bl02vu1dt67BbIKA-1FqlTuFGh8VoJemyEkmhqnf6w9u98dKvCdpFPDiRktU-PGDtnD9Y8rBYgBHuPyfnMR15jTMaF0HV4SMw6qU_S_3p771jHSE9Kl8Yx6zKgkBv71qLhQP68VNsifnmQFbtEBdQt5hK1-9WLGzrhB1jLiL1EJTtmqGymT21ymquQHXcDudPQ7clgzz0Xzjt_NO-L5mbbklzohRwsDO0eQtHxD58zL6QlQoWsRTqvlVMkUz2wSNPsApVb2hq30D4x9RSvDE3sKJBGAzFqDG_XwE6yoojDNPn2wH0H0o3-wtCso0hRJXlvPTHz_zMYdTcMNKTwccWgu0mmbH5NKcVCxrZ6R2MeCfUb8ACp7PKjZeAecaHq_REu3Kkoi3xXPPK_MU_eLl5A1MFw_d7azTSHHUFmL3RdiC15vvA1bajH1NDbLEAxMV8nUOJVfuWxXDGS0Diknyj0V95At_KBG4y7Ylo-4fv4=&quot;,</span></span><br><span class="line">  <span class="string">&quot;q&quot;</span> : g_q(),</span><br><span class="line">  <span class="string">&quot;uid&quot;</span>: <span class="string">&quot;ede6c26f-85eb-4f41-b103-051605ae1c821741773364713&quot;</span>,</span><br><span class="line">  <span class="string">&quot;t&quot;</span>: <span class="string">&quot;1741773407429&quot;</span>,</span><br><span class="line">  <span class="string">&quot;cid&quot;</span>: <span class="string">&quot;210101&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">body_sorted = <span class="built_in">dict</span>(<span class="built_in">sorted</span>(body.items()))</span><br><span class="line"></span><br><span class="line">sign_data = <span class="string">&quot;;&quot;</span>.join([key+<span class="string">&quot;=&quot;</span>+value <span class="keyword">for</span> key,value <span class="keyword">in</span> body_sorted.items()])</span><br><span class="line">salt = <span class="string">&quot;29XBu4ETjHx0YnfC&quot;</span></span><br><span class="line">sign = getsign(<span class="built_in">bytes</span>.<span class="built_in">hex</span>(md5_call((sign_data+salt).encode(<span class="string">&quot;utf-8&quot;</span>))))</span><br><span class="line"></span><br><span class="line">body[<span class="string">&quot;sign&quot;</span>] = sign</span><br><span class="line"><span class="built_in">print</span>(sign)</span><br><span class="line"></span><br><span class="line">response = requests.post(url=url,headers=headers,data=body)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">ciphertext = response.text</span><br><span class="line"><span class="comment"># ciphertext = &quot;YpEwA8iL58QXeR-ZSZ3A7UAYW87GDqYNVVxccRJRXdrchLKJaUKgoMkCqriRjHJ4SHuZfPrwvOsq-38HXEl4EAM3FqOfGIeNuJ5q6Fu9OmWzWwpD4jYobI1KM2-6q8tRPbAQDw1nckcu6dY1NyzcLI_W1CV81Vyr7bEk33zBS_Qe5ayui3QUeI1r0cKnuzY2X7er31heAHd1jrRAX_rcylBkDe_EvXgcKWMJ8jw_KvXopUOKdAlZAOXaPmRvqP-XXFnmJ1md6AKmhZ4-64eo_iwXkOtjLv3PQHpr3CJr93C3kQIzAKmAR79hII_4WPcITE-Pb3x6ip6QuAEywIYn1_EZrhdvspv6kTdwrzn5kkA=&quot;</span></span><br><span class="line"><span class="built_in">print</span>(decrypt_response(ciphertext))</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;bizId&quot;:&quot;&quot;,&quot;busiCode&quot;:&quot;BASE001&quot;,&quot;code&quot;:7,&quot;content&quot;:null,&quot;handler&quot;:&quot;USER&quot;,&quot;msg&quot;:&quot;验证码无效&quot;,&quot;shardingId&quot;:&quot;&quot;,&quot;status&quot;:&quot;BASE_ERROR&quot;,&quot;uid&quot;:&quot;6e1c943b-cc1f-41ea-8ebd-b5d06ddae5c11741928800889&quot;,&quot;version&quot;:&quot;101&quot;,&quot;zeusId&quot;:&quot;luckycapiproxy-0ade7194-483869-687159&quot;&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/default-index/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/default-index/page/11/">11</a><a class="extend next" rel="next" href="/default-index/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bileton"
      src="/images/android.svg">
  <p class="site-author-name" itemprop="name">Bileton</p>
  <div class="site-description" itemprop="description">路漫漫其修远夕！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">104</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">36</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">96</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bileton</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">887k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">13:26</span>
</div>


<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("01/01/2024 00:00:00"); //修改为你的网站开始运行的时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
