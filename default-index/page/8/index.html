<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/wxlog.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/wxlog.jpg">
  <link rel="mask-icon" href="/images/wxlog.jpg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="路漫漫其修远夕！">
<meta property="og:type" content="website">
<meta property="og:title" content="白乐天">
<meta property="og:url" content="http://example.com/default-index/page/8/index.html">
<meta property="og:site_name" content="白乐天">
<meta property="og:description" content="路漫漫其修远夕！">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Bileton">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/default-index/page/8/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>白乐天</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">白乐天</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">道阻且长，行则将至。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">93</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">35</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">101</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/26/%E8%A7%81%E5%A4%9A%E8%AF%86%E5%B9%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/26/%E8%A7%81%E5%A4%9A%E8%AF%86%E5%B9%BF/" class="post-title-link" itemprop="url">见多识广</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-26 21:19:27" itemprop="dateCreated datePublished" datetime="2024-12-26T21:19:27+08:00">2024-12-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-31 16:52:45" itemprop="dateModified" datetime="2025-03-31T16:52:45+08:00">2025-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%A7%81%E5%A4%9A%E8%AF%86%E5%B9%BF/" itemprop="url" rel="index"><span itemprop="name">见多识广</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="AIGC"><a href="#AIGC" class="headerlink" title="AIGC"></a>AIGC</h1><p>人工智能生成内容（Artificial Intelligence Generated Content），是指由人工智能（AI）技术创建、生成的各种内容，涵盖了文本、图像、视频、音频、代码等多种形式。</p>
<h1 id="LLM"><a href="#LLM" class="headerlink" title="LLM"></a>LLM</h1><p>大预言模型（Large Language Model），是指一种基于深度学习技术，尤其是通过神经网络训练而成的自然语言处理模型。</p>
<h1 id="HCI"><a href="#HCI" class="headerlink" title="HCI"></a>HCI</h1><p>人机交互（Human-Computer Interaction），是指人与计算机之间的交互过程和相关技术研究领域。</p>
<h1 id="RPC"><a href="#RPC" class="headerlink" title="RPC"></a>RPC</h1><p>远程过程调用（Remote Procedure Call），RPC 是一种计算机通信协议，允许程序在不同的地址空间（例如不同的计算机或同一台计算机的不同进程）之间调用函数或子程序，就像在本地调用一样，而无需了解底层的网络通信细节。</p>
<h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><p>攻防兼备（Attack With Defence）。</p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><p>二进制漏洞挖掘与利用</p>
<h1 id="ABI"><a href="#ABI" class="headerlink" title="ABI"></a>ABI</h1><p>应用程序二进制接口（Application Binary Interface），它定义了程序在运行时的二进制接口。ABI 主要用于描述操作系统和硬件平台如何协同工作，以及编译后的程序如何与系统或其他程序交互。</p>
<ul>
<li><p><strong>Linux 上的 x86_64 ABI</strong>：<br>定义了 64 位 Linux 系统上如何调用函数，参数如何传递。</p>
</li>
<li><p><strong>Android NDK 中的 ABI</strong>：</p>
<p>Android 平台支持多种 ABI，比如：</p>
<ul>
<li><code>armeabi-v7a</code>（32 位 ARM 架构）</li>
<li><code>arm64-v8a</code>（64 位 ARM 架构）</li>
<li><code>x86</code> 和 <code>x86_64</code>（Intel 架构）</li>
</ul>
<p>这些 ABI 直接决定了编译出来的二进制程序是否能在目标设备上运行。</p>
</li>
</ul>
<h1 id="Protobuf"><a href="#Protobuf" class="headerlink" title="Protobuf"></a>Protobuf</h1><p>Protocol Buffers（简称 <strong>protobuf</strong>）是 Google 开发的一种<strong>跨语言、跨平台、高效的结构化数据序列化机制</strong>，用于将结构化数据转换为紧凑的二进制格式，支持数据存储、网络通信等场景。</p>
<h1 id="原码反码补码"><a href="#原码反码补码" class="headerlink" title="原码反码补码"></a>原码反码补码</h1><h2 id="原码"><a href="#原码" class="headerlink" title="原码"></a>原码</h2><p>原码是最直观的数值表示法，它直接反映了数字的绝对值和符号。</p>
<ul>
<li><p>最高位（最左位）表示符号位：0表示正数，1表示负数</p>
</li>
<li><p>其余位表示数值的绝对值</p>
</li>
</ul>
<p><strong>示例：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+43 的原码：0 0101011（0 + 43的二进制）</span><br><span class="line">-43 的原码：1 0101011（1 + 43的二进制）</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong></p>
<ul>
<li><p>加法规则：不能直接相加，需要根据符号位判断是做加法还是减法</p>
</li>
<li><p>0的表示：+0 (00000000) 和 -0 (10000000) 是不同的表示</p>
</li>
</ul>
<h2 id="反码"><a href="#反码" class="headerlink" title="反码"></a>反码</h2><p>反码是对原码的一种改进，使运算更加便捷。</p>
<p><strong>反码表示规则：</strong></p>
<ul>
<li><p>正数的反码等于其原码</p>
</li>
<li><p>负数的反码是其原码除符号位外，按位取反（0变1，1变0）</p>
</li>
</ul>
<p><strong>示例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+43 的反码：0 0101011（与原码相同）</span><br><span class="line">-43 的反码：1 1010100（符号位不变，其余位取反）</span><br></pre></td></tr></table></figure>

<p><strong>反码的优点</strong></p>
<p>简化了减法操作：A - B 可以通过 A + (-B) 的反码实现</p>
<p>部分改善加法运算：符号不同的加法变得更容易</p>
<p><strong>反码的问题</strong></p>
<p>零仍有两种表示：+0 (00000000) 和 -0 (11111111)</p>
<p>加法需要”端进位回卷”：即末位进位需要加到最低位</p>
<h2 id="补码"><a href="#补码" class="headerlink" title="补码"></a>补码</h2><p>补码是现代计算机普遍采用的表示方式，解决了反码的问题。</p>
<p><strong>补码表示规则</strong></p>
<ul>
<li><p>正数的补码等于其原码</p>
</li>
<li><p>负数的补码等于其反码加1，或者等于”模-绝对值”（模是2的n次方，n是位数）</p>
</li>
</ul>
<p><strong>示例</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+43 的补码：0 0101011（与原码相同）</span><br><span class="line">-43 的补码：1 1010101（反码加1）</span><br></pre></td></tr></table></figure>



<p>示例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">-1</span><br><span class="line">原码：10000001 （81）</span><br><span class="line">反码：11111110</span><br><span class="line">补码：11111111 （FF）</span><br><span class="line"></span><br><span class="line">-5</span><br><span class="line">原码：10000101 （85）</span><br><span class="line">反码：11111010</span><br><span class="line">补码：11111011 （FB）</span><br><span class="line"></span><br><span class="line">-64</span><br><span class="line">原码：11000000 （B0）</span><br><span class="line">反码：10111111</span><br><span class="line">补码：11000000 （B0）</span><br><span class="line"></span><br><span class="line">-127</span><br><span class="line">原码：11111111 （FF）</span><br><span class="line">反码：10000000</span><br><span class="line">补码：10000001 （81）</span><br><span class="line"></span><br><span class="line">-128</span><br><span class="line">原码：无</span><br><span class="line">反码：无</span><br><span class="line">补码：10000000 （80）</span><br></pre></td></tr></table></figure>

<h1 id="XAPK"><a href="#XAPK" class="headerlink" title="XAPK"></a>XAPK</h1><p>XAPK是一种专为Android操作系统设计的应用程序包文件格式,全称是”Extended Android Package”。它与常见的APK(Android Package)文件类似,但功能更强大,旨在解决大型应用程序或游戏的安装需求，通常以”.xapk”为文件扩展名。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>使用np管理器安装</p>
<p>使用adb install-multiple命令安装</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/24/VSCode%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/24/VSCode%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" class="post-title-link" itemprop="url">VSCode使用指南</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-24 16:06:41" itemprop="dateCreated datePublished" datetime="2024-12-24T16:06:41+08:00">2024-12-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-27 00:18:47" itemprop="dateModified" datetime="2025-02-27T00:18:47+08:00">2025-02-27</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%AB%98%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7%E5%90%88%E9%9B%86/" itemprop="url" rel="index"><span itemprop="name">高效率工具合集</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>533</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="提高工作效率"><a href="#提高工作效率" class="headerlink" title="提高工作效率"></a>提高工作效率</h1><h2 id="自动保存"><a href="#自动保存" class="headerlink" title="自动保存"></a>自动保存</h2><p>打开设置搜索<code>Auto Save</code>，将选项改为<code>afterDelay</code></p>
<h2 id="鼠标滚轮缩放"><a href="#鼠标滚轮缩放" class="headerlink" title="鼠标滚轮缩放"></a>鼠标滚轮缩放</h2><p>打开设置搜索<code>Mouse Wheel Zoom</code>，勾选相应的选项即可。</p>
<h1 id="自定义背景"><a href="#自定义背景" class="headerlink" title="自定义背景"></a>自定义背景</h1><p>安装插件<code>background</code></p>
<p>打开设置，搜索<code>background</code>，找到<code>Background: Fullscreen</code>，进行编辑</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;background.fullscreen&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;images&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;file:///C:/Users/blttttt/Desktop/shuimo.png&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;opacity&quot;</span><span class="punctuation">:</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cover&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;position&quot;</span><span class="punctuation">:</span> <span class="string">&quot;center&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;interval&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;random&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;workbench.colorTheme&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Default High Contrast&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h1><h2 id="Ctrl-B"><a href="#Ctrl-B" class="headerlink" title="Ctrl+B"></a>Ctrl+B</h2><p>切换侧边栏的显示&#x2F;隐藏状态</p>
<h1 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h1><h2 id="C-C"><a href="#C-C" class="headerlink" title="C&#x2F;C++"></a>C&#x2F;C++</h2><h2 id="Code-Runner"><a href="#Code-Runner" class="headerlink" title="Code Runner"></a>Code Runner</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/23/HTML/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/23/HTML/" class="post-title-link" itemprop="url">HTML</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-23 12:02:23" itemprop="dateCreated datePublished" datetime="2024-12-23T12:02:23+08:00">2024-12-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-06 21:27:35" itemprop="dateModified" datetime="2025-02-06T21:27:35+08:00">2025-02-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h1><h2 id="安装VSCode"><a href="#安装VSCode" class="headerlink" title="安装VSCode"></a>安装VSCode</h2><p><code>VSCode</code>是一个文本编辑器，使用它来编辑<code>HTML</code>代码。</p>
<h3 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h3><ul>
<li><p><strong>open in browser</strong></p>
<p>右键点击 HTML 文件，通过插件直接在浏览器中打开HTML文件。</p>
<p>快捷键：<code>Alt+B</code></p>
</li>
</ul>
<h2 id="安装谷歌浏览器"><a href="#安装谷歌浏览器" class="headerlink" title="安装谷歌浏览器"></a>安装谷歌浏览器</h2><p>通过浏览器预览和调试<code>HTML</code>文件。</p>
<h1 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h1><p>HTML——HyperText Markup Language（超文本标记语言）</p>
<ul>
<li>超文本——链接</li>
<li>标记——标签</li>
</ul>
<h2 id="标签语法"><a href="#标签语法" class="headerlink" title="标签语法"></a>标签语法</h2><ul>
<li>标签成对出现，中间包裹内容</li>
<li><code>&lt;&gt;</code>存放标签名</li>
<li>结束标签的标签名前需要加<code>/</code></li>
</ul>
<h2 id="HTML的基本结构"><a href="#HTML的基本结构" class="headerlink" title="HTML的基本结构"></a>HTML的基本结构</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>网页标题<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        网页主体</span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>html</code>：整个网页</li>
<li><code>head</code>：网页头部</li>
<li><code>body</code>：网页主体</li>
<li><code>title</code>：网页标题</li>
</ul>
<p><strong>VSCode中生成HTML基本结构的快捷方式</strong></p>
<ul>
<li><p>英文状态下的<code>!</code>加上<code>Enter</code>或<code>Tab</code>键</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="标签之间的关系"><a href="#标签之间的关系" class="headerlink" title="标签之间的关系"></a>标签之间的关系</h2><ul>
<li><strong>嵌套</strong></li>
<li><strong>并列</strong></li>
</ul>
<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- xxx --&gt;</span></span><br></pre></td></tr></table></figure>

<p>注释标签可以通过快捷键<code>Ctrl+/</code>生成</p>
<h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是一级标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是二级标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是三级标题<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>这是四级标题<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span>这是五级标题<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span>这是六级标题<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果：段落独占一行，段落之间有间隙。</p>
<h3 id="换行和水平线"><a href="#换行和水平线" class="headerlink" title="换行和水平线"></a>换行和水平线</h3><p>换行和水平线标签都是单标签。</p>
<ul>
<li><p><strong>换行</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>水平线</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="文本格式标签"><a href="#文本格式标签" class="headerlink" title="文本格式标签"></a>文本格式标签</h3><ul>
<li><p><strong>加粗</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span>这是加粗的内容<span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span>这是加粗的内容<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>倾斜</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span>这是倾斜的内容<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span>这是倾斜的内容<span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>下划线</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ins</span>&gt;</span>这是添加下划线的内容<span class="tag">&lt;/<span class="name">ins</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">u</span>&gt;</span>这是添加下划线的内容<span class="tag">&lt;/<span class="name">u</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>删除线</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">del</span>&gt;</span>这是添加删除线的内容<span class="tag">&lt;/<span class="name">del</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">s</span>&gt;</span>这是添加删除线的内容<span class="tag">&lt;/<span class="name">s</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="图像标签"><a href="#图像标签" class="headerlink" title="图像标签"></a>图像标签</h3><p><strong>基本语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;图片的路径&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;替代文本&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"># src: 必需属性，用于指定图片的路径，可以是相对路径或绝对路径。</span><br><span class="line"># alt: 可选属性，用于在图片无法加载时显示替代文本。</span><br></pre></td></tr></table></figure>

<p><strong>常用属性</strong></p>
<ul>
<li><p><code>width</code>和<code>height</code></p>
<p>用于设置图片的宽度和高度，可以是像素值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;example.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200&quot;</span> <span class="attr">height</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>title</code></p>
<p>为图片提供提示文本，当鼠标悬停在图片上时显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;example.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">title</span>=<span class="string">&quot;这是示例图片&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><code>loading</code></p>
<p>控制图片的加载方式，可选值有：</p>
<ul>
<li><p><code>lazy</code>（懒加载，仅当用户滚动到图片时才加载）</p>
</li>
<li><p><code>eager</code>（默认行为，立即加载）</p>
</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;example.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">loading</span>=<span class="string">&quot;lazy&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="超链接标签"><a href="#超链接标签" class="headerlink" title="超链接标签"></a>超链接标签</h3><p>超链接可以用于从一个页面跳转到另一个页面，也可以跳转到同一页面的特定位置、下载资源或触发其他行为。</p>
<p><strong>基本语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;链接地址&quot;</span> &gt;</span>链接文本或内容<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># href：必须属性，指定超链接的目标地址。</span><br><span class="line"># 链接文本或内容：用户点击的内容，可以是文字、图片或其他元素。</span><br></pre></td></tr></table></figure>

<p><strong>常用属性</strong></p>
<ul>
<li><p><strong>target</strong></p>
<p>定义链接的打开方式。</p>
<ul>
<li><code>_self</code>：在当前窗口打开（默认值）。</li>
<li><code>_blank</code>：在新窗口或标签页打开。</li>
</ul>
</li>
<li><p><strong>title</strong></p>
<p>提供额外信息，鼠标悬停时显示提示文本。</p>
</li>
<li><p><strong>download</strong></p>
<p>提供下载功能，将链接目标作为文件下载。</p>
</li>
</ul>
<p><strong>注意事项</strong></p>
<p><code>href</code> 属性不能为空：如果未指定值，链接会变为无效。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>点击无效链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="音频标签"><a href="#音频标签" class="headerlink" title="音频标签"></a>音频标签</h3><p>用于在网页中嵌入音频文件。</p>
<p><strong>基本语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;audio.mp3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># src： 指定音频文件的路径。</span><br></pre></td></tr></table></figure>

<p><strong>常用属性</strong></p>
<ul>
<li><p><strong>controls</strong></p>
<p>添加音频播放器控件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;audio.mp3&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>autoplay</strong></p>
<p>自动播放（页面加载完成后）。</p>
<p>为了防止干扰用户体验，大多数浏览器会禁止自动播放，除非静音或用户交互后允许。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;audio.mp3&quot;</span> <span class="attr">autoplay</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>loop</strong></p>
<p>循环播放。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;audio.mp3&quot;</span> <span class="attr">loop</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="视频标签"><a href="#视频标签" class="headerlink" title="视频标签"></a>视频标签</h3><p>用于在网页中嵌入视频文件。</p>
<p><strong>基本语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;video.mp4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># src：指定视频文件的路径。</span><br></pre></td></tr></table></figure>

<p><strong>常用属性</strong></p>
<ul>
<li><p><strong>controls</strong></p>
<p>显示视频控件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;video.mp4&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>loop</strong></p>
<p>循环播放。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;video.mp4&quot;</span> <span class="attr">loop</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>muted</strong></p>
<p>默认静音播放。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;video.mp4&quot;</span> <span class="attr">muted</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>autoplay</strong></p>
<p>自动播放（页面加载完成后）。</p>
<p>注意：大多数浏览器要求视频自动播放时必须静音。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">src</span>=<span class="string">&quot;video.mp4&quot;</span> <span class="attr">muted</span> <span class="attr">autoplay</span>&gt;</span><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="列表标签"><a href="#列表标签" class="headerlink" title="列表标签"></a>列表标签</h2><h3 id="无序列表"><a href="#无序列表" class="headerlink" title="无序列表"></a>无序列表</h3><p>使用<code>&lt;ul&gt;</code>标签定义无序列表，使用<code>&lt;li&gt;</code>标签定义每个列表项。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>苹果<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>香蕉<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>橙子<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="有序列表"><a href="#有序列表" class="headerlink" title="有序列表"></a>有序列表</h3><p>使用<code>&lt;ol&gt;</code>标签定义有序列表，使用<code>&lt;li&gt;</code>标签定义每个列表项。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>语文<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>数学<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span>英语<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>修改序号样式</strong></p>
<p>可以通过<code>type</code>属性修改有序列表的样式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type=&quot;1&quot;：数字（默认）</span><br><span class="line">type=&quot;A&quot;：大写字母</span><br><span class="line">type=&quot;a&quot;：小写字母</span><br><span class="line">type=&quot;I&quot;：大写罗马数字</span><br><span class="line">type=&quot;i&quot;：小写罗马数字</span><br></pre></td></tr></table></figure>

<h3 id="定义列表"><a href="#定义列表" class="headerlink" title="定义列表"></a>定义列表</h3><p>使用 <code>&lt;dl&gt;</code>标签定义列表，使用<code>&lt;dt&gt;</code>标签定义标题，使用<code>&lt;dd&gt;</code>标签定义描述。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>HTML<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>超文本标记语言<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>CSS<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>层叠样式表<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>JavaScript<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>一种脚本语言，用于开发动态交互的网页。<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>注意</strong></p>
<ul>
<li><code>&lt;dl&gt;</code>里面只能包含<code>&lt;dl&gt;</code>和<code>&lt;dd&gt;</code>。</li>
<li><code>&lt;dl&gt;</code>和<code>&lt;dd&gt;</code>里面可以包含任意内容。</li>
</ul>
<h2 id="表格标签"><a href="#表格标签" class="headerlink" title="表格标签"></a>表格标签</h2><p><strong>基本表格结构</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">th</span>&gt;</span>职业<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>25<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>工程师<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>30<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>设计师<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;table&gt;</code>定义表格，<code>&lt;tr&gt;</code>定义行，<code>th</code>定义表头单元格，<code>&lt;td&gt;</code>定义数据单元格。</p>
<p>在网页中，表格默认没有边框线，使用<strong>border</strong>属性可以为表格添加边框线。</p>
<p><strong>表格结构标签</strong></p>
<ul>
<li><code>&lt;thead&gt;</code>：定义表格头部。</li>
<li><code>&lt;tbody&gt;</code>：定义表格主体。</li>
<li><code>&lt;tfoot&gt;</code>：定义表格尾部。</li>
</ul>
<h3 id="合并单元格"><a href="#合并单元格" class="headerlink" title="合并单元格"></a>合并单元格</h3><p><strong>合并行</strong>（纵向合并）</p>
<p>使用 <code>rowspan</code> 属性，合并的单元格数由 <code>rowspan</code> 的值决定。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>成绩<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>李华<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>19<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>97<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>李明<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>18<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;td&gt;97&lt;/td&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/23/HTML/1.jpg"></p>
<p><strong>合并列</strong>（横向合并）</p>
<p>使用<code>colspan</code>属性，合并的单元格数由 <code>colspan</code> 的值决定。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>姓名<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>年龄<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">th</span>&gt;</span>成绩<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>李华<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>19<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">rowspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>97<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>李明<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>18<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;td&gt;97&lt;/td&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>总结<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span> <span class="attr">colspan</span>=<span class="string">&quot;2&quot;</span>&gt;</span>优秀<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/23/HTML/2.jpg"></p>
<h2 id="表单"><a href="#表单" class="headerlink" title="表单"></a>表单</h2><h3 id="输入框"><a href="#输入框" class="headerlink" title="输入框"></a>输入框</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="type属性"><a href="#type属性" class="headerlink" title="type属性"></a>type属性</h4><p>通过<code>type</code>属性定义输入框的类型</p>
<ul>
<li><p><strong>text</strong></p>
<p>文本输入框 (<code>type=&quot;text&quot;</code>)</p>
</li>
<li><p><strong>password</strong></p>
<p>密码输入框 (<code>type=&quot;password&quot;</code>)</p>
<p>输入的内容会被掩盖（通常显示为星号或圆点）。</p>
</li>
<li><p><strong>radio</strong></p>
<p>单选按钮 (<code>type=&quot;radio&quot;</code>)</p>
<p>同一组单选按钮的 <code>name</code> 必须相同，用户只能选择一个。</p>
</li>
<li><p><strong>checkbox</strong></p>
<p>复选框 (<code>type=&quot;checkbox&quot;</code>)</p>
</li>
<li><p><strong>file</strong></p>
<p>文件上传框 (<code>type=&quot;file&quot;</code>)</p>
</li>
</ul>
<h4 id="placeholder属性"><a href="#placeholder属性" class="headerlink" title="placeholder属性"></a>placeholder属性</h4><p>通过<code>placeholder</code>属性作为输入框的占位提示信息，用户未输入时显示。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="name属性"><a href="#name属性" class="headerlink" title="name属性"></a>name属性</h4><p>主要用于标识表单字段的名称，在表单提交时，<code>name</code> 属性的值会作为键，输入的值作为对应的值提交。</p>
<h4 id="checked属性"><a href="#checked属性" class="headerlink" title="checked属性"></a>checked属性</h4><p><code>checked</code> 属性是 HTML 表单元素中专门用于 <strong>单选按钮（<code>&lt;input type=&quot;radio&quot;&gt;</code>）</strong> 和 <strong>复选框（<code>&lt;input type=&quot;checkbox&quot;&gt;</code>）</strong> 的布尔属性。它用来预先设置某个选项为“选中”状态。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;group_name&quot;</span> <span class="attr">checked</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;field_name&quot;</span> <span class="attr">checked</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="multiple属性"><a href="#multiple属性" class="headerlink" title="multiple属性"></a>multiple属性</h4><p><code>multiple</code> 属性允许用户在某些输入元素中选择多个值。它通常用于文件上传、选择框和电子邮件地址输入。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;files&quot;</span> <span class="attr">multiple</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="下拉菜单"><a href="#下拉菜单" class="headerlink" title="下拉菜单"></a>下拉菜单</h3><p>使用<code>&lt;select&gt;</code>定义下拉菜单，使用<code>&lt;option&gt;</code>定义下拉菜单中的每个选项，在 <code>&lt;option&gt;</code> 中添加 <code>selected</code> 属性可以设置默认选中值，如果未设置则默认第一个选项是默认选中值。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">name</span>=<span class="string">&quot;field_name&quot;</span> <span class="attr">id</span>=<span class="string">&quot;field_id&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;option1&quot;</span>&gt;</span>选项1<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;option2&quot;</span>&gt;</span>选项2<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;option3&quot;</span>&gt;</span>选项3<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="文本域标签"><a href="#文本域标签" class="headerlink" title="文本域标签"></a>文本域标签</h3><p>文本域标签用于创建多行的文本输入框，用户可以在其中输入较长的文本内容，如留言、评论等。</p>
<p>使用<code>&lt;textarea&gt;</code>定义文本域，标签之间的内容是默认显示的初始文本。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">&quot;field_name&quot;</span> <span class="attr">id</span>=<span class="string">&quot;field_id&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;行数&quot;</span> <span class="attr">cols</span>=<span class="string">&quot;列数&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="label标签"><a href="#label标签" class="headerlink" title="label标签"></a>label标签</h3><p><code>&lt;label&gt;</code> 标签用于为 HTML 表单元素定义标签。它可以通过 <code>for</code> 属性绑定到一个表单控件，或者直接将表单控件嵌套在 <code>&lt;label&gt;</code> 标签内。</p>
<p><strong>基本语法</strong></p>
<ul>
<li><p><strong>使用for属性绑定控件</strong></p>
<p><code>for</code> 属性的值需要与目标表单控件的 <code>id</code> 一致。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;username&quot;</span>&gt;</span>用户名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;username&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>嵌套控件</strong></p>
<p>直接将表单控件嵌套在 <code>&lt;label&gt;</code> 标签内。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">  密码：</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="按钮"><a href="#按钮" class="headerlink" title="按钮"></a>按钮</h3><p>按钮主要用于用户交互，可以触发表单提交、运行 JavaScript 脚本，或者执行其他操作。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>普通按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>常用属性</strong></p>
<ul>
<li><p><strong>button</strong></p>
<p>普通按钮，默认没有功能，配合JavaScript使用。</p>
</li>
<li><p><strong>submit</strong></p>
<p>点击后提交数据到后台。</p>
</li>
<li><p><strong>reset</strong></p>
<p>重置按钮，点击后将表单控件恢复默认值。</p>
</li>
</ul>
<h3 id="form标签"><a href="#form标签" class="headerlink" title="form标签"></a>form标签</h3><p><code>&lt;form&gt;</code> 标签是用于创建 HTML 表单的容器。表单用于收集用户输入，并通过提交将数据发送到服务器进行处理。</p>
<p><strong>基本语法</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;提交地址&quot;</span> <span class="attr">method</span>=<span class="string">&quot;请求方法&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 表单控件，例如文本框、按钮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>常用属性</strong></p>
<ul>
<li><p><strong>action</strong></p>
<p>表单提交时的目标 URL，表示数据提交到的服务器地址。</p>
</li>
<li><p><strong>method</strong></p>
<p>表单数据提交的方法，常用值为 <code>GET</code> 和 <code>POST</code>。</p>
</li>
</ul>
<h2 id="布局标签"><a href="#布局标签" class="headerlink" title="布局标签"></a>布局标签</h2><h3 id="div标签"><a href="#div标签" class="headerlink" title="div标签"></a>div标签</h3><p>通用的块级容器，用于分组 HTML 元素，没有语义，占据一行。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  这是一个 div 容器。</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="span标签"><a href="#span标签" class="headerlink" title="span标签"></a>span标签</h3><p>通用的行内容器，用于分组文本或其他行内元素，没有语义，不会独占一行。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  这是一个<span class="tag">&lt;<span class="name">span</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">span</span>&gt;</span> 的单词。</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="字符实体"><a href="#字符实体" class="headerlink" title="字符实体"></a>字符实体</h2><table>
<thead>
<tr>
<th>显示结果</th>
<th>描述</th>
<th>实体名称</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td>空格</td>
<td><code>&amp;nbsp;</code></td>
</tr>
<tr>
<td>&lt;</td>
<td>小于号</td>
<td><code>&amp;lt;</code></td>
</tr>
<tr>
<td>&gt;</td>
<td>大于号</td>
<td><code>&amp;gt;</code></td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">唯品会设备注册及搜索接口逆向分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-23 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-23T00:00:00+08:00">2024-12-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-25 13:54:21" itemprop="dateModified" datetime="2025-02-25T13:54:21+08:00">2025-02-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>55k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>50 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.achievo.vipshop</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/appdata.jpg"></p>
<h1 id="设备注册"><a href="#设备注册" class="headerlink" title="设备注册"></a>设备注册</h1><p>抓包找到有关设备注册的接口</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/device_reg.jpg" alt="device_reg"></p>
<p>测试一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;okhttp/4.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;authorization&quot;</span>:<span class="string">&quot;OAuth api_sign=fee2a0810c0b9637b6aa0f64b2d91f172dc4e397&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>:<span class="string">&quot;achievo_ad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>:<span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_token&quot;</span>:<span class="string">&quot;b3aad8e2-2840-39a5-8b51-e5b1c5b16bad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>:<span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manufacturer&quot;</span>:<span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device&quot;</span>:<span class="string">&quot;Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os_version&quot;</span>:<span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel&quot;</span>:<span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipruid&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regPlat&quot;</span>:<span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regid&quot;</span>:<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>:<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>:<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mp.appvipshop.com/apns/device_reg&quot;</span></span><br><span class="line">response = requests.get(url,headers=headers,params=parameters)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="number">200</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;ok&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;注册成功&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>参数中<code>device_token</code>是变动的，对其进行逆向</p>
<p>反编译app搜索<code>device_token</code></p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/device_token.jpg" alt="device_token"></p>
<h2 id="of"><a href="#of" class="headerlink" title="of"></a>of</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/of.jpg" alt="device_token"></p>
<h2 id="l"><a href="#l" class="headerlink" title="l"></a>l</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/l.jpg" alt="device_token"></p>
<h2 id="a"><a href="#a" class="headerlink" title="a"></a>a</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/a.jpg" alt="device_token"></p>
<h2 id="getMid"><a href="#getMid" class="headerlink" title="getMid"></a>getMid</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getMid.jpg" alt="device_token"></p>
<p>MidProvider是一个接口，Injector是静态内部类，MidProvider接口定义两个方法<code>String getMid()</code>和<code>String getMidOnly()</code></p>
<h2 id="找MidProvider接口的实现类"><a href="#找MidProvider接口的实现类" class="headerlink" title="找MidProvider接口的实现类"></a>找MidProvider接口的实现类</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/vipmidmanager.jpg" alt="device_token"></p>
<h2 id="VipMidManager"><a href="#VipMidManager" class="headerlink" title="VipMidManager"></a>VipMidManager</h2><p>在vipMidManager类里面找getMid方法，发现jadx并不能反编译这个函数，使用jeb反编译。</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/19.jpg" alt="device_token"></p>
<p>这个方法的解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">getMid()方法根据一些条件生成或获取一个 MID，应该是设备唯一标识符。</span><br><span class="line">stringBuilder0用于构建字符串</span><br><span class="line">application0是当前应用的 Application 实例</span><br><span class="line">s为从 SharedPreferences（应用的配置文件）中获取键为 &quot;VIPS_MID&quot; 的值，假设这个值表示设备的唯一标识符。</span><br><span class="line">判断s是否有效，如果无效，设置 stringBuilder0 为 null，创建一个新的 StringBuilder对象，构造日志信息。</span><br><span class="line">调用 DeviceUuidFactory.getDeviceUuid(application0) 获取设备的唯一标识符（UUID）</span><br><span class="line">将 s 设置为 UUID 的字符串形式，并记录日志信息 | create by androidId。</span><br><span class="line">生成新的 MID：</span><br><span class="line">生成一个新的随机 UUID 并将其赋值给 s ， 同时更新日志，记录生成方式为 | create by uuid。</span><br></pre></td></tr></table></figure>

<h2 id="生成uuid"><a href="#生成uuid" class="headerlink" title="生成uuid"></a>生成uuid</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">random_uuid = uuid.uuid4()</span><br><span class="line"><span class="built_in">print</span>(random_uuid)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br><span class="line">85acb30b-3b28-<span class="number">4975</span>-b8cd-2bb53f08b472</span><br></pre></td></tr></table></figure>

<h2 id="设备注册逆向"><a href="#设备注册逆向" class="headerlink" title="设备注册逆向"></a>设备注册逆向</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line">device_token = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;okhttp/4.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;authorization&quot;</span>:<span class="string">&quot;OAuth api_sign=fee2a0810c0b9637b6aa0f64b2d91f172dc4e397&quot;</span>,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>:<span class="string">&quot;achievo_ad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>:<span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_token&quot;</span>:device_token,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>:<span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manufacturer&quot;</span>:<span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device&quot;</span>:<span class="string">&quot;Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os_version&quot;</span>:<span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel&quot;</span>:<span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipruid&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regPlat&quot;</span>:<span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regid&quot;</span>:<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>:<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>:<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mp.appvipshop.com/apns/device_reg&quot;</span></span><br><span class="line">response = requests.get(url,headers=headers,params=parameters)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="number">200</span></span><br><span class="line">&#123;<span class="string">&quot;result&quot;</span>:<span class="string">&quot;ok&quot;</span>,<span class="string">&quot;msg&quot;</span>:<span class="string">&quot;注册成功&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h1 id="参数api-sign"><a href="#参数api-sign" class="headerlink" title="参数api_sign"></a>参数api_sign</h1><p>分析数据包，找到Authorization参数的api_sign</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/image-20241217095807281.png" alt="image-20241217095807281"></p>
<h1 id="jadx反编译"><a href="#jadx反编译" class="headerlink" title="jadx反编译"></a>jadx反编译</h1><p>文本搜索api_sign</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/Snipaste_2024-12-17_10-06-59.jpg" alt="Snipaste_2024-12-17_10-06-59"></p>
<p>追踪函数</p>
<h2 id="getApiSign"><a href="#getApiSign" class="headerlink" title="getApiSign"></a>getApiSign</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getapisign.jpg" alt="getapisign"></p>
<p>分析，<code>getApiSign</code> 函数用于为网络请求生成包含 API 签名的授权头。</p>
<p>猜测<code>VCSPCommonsConfig.getIAppInfo().getUserTokenSecret()</code> 的作用是从应用程序的配置中获取当前用户的令牌密钥，该密钥通常用于生成 API 签名或进行身份验证。</p>
<h2 id="apisign"><a href="#apisign" class="headerlink" title="apisign"></a>apisign</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/apisign.jpg" alt="apisign"></p>
<p>调用 <code>VCSPSecurityConfig.getMapParamsSign(context, treeMap, str, false)</code> 方法生成签名</p>
<h3 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">VCSPSecurityBasicService</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.security.api.VCSPSecurityBasicService&quot;</span>);</span><br><span class="line">        <span class="title class_">VCSPSecurityBasicService</span>[<span class="string">&quot;apiSign&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">context, treeMap, str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`VCSPSecurityBasicService.apiSign is called!`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;context:&quot;</span>,context);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;treeMap:&quot;</span>,treeMap);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str:&quot;</span>,str);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;apiSign&quot;</span>](context, treeMap, str);                                  </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`VCSPSecurityBasicService.apiSign result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_function</span>()</span><br></pre></td></tr></table></figure>

<h3 id="hook结果"><a href="#hook结果" class="headerlink" title="hook结果"></a>hook结果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">VCSPSecurityBasicService.apiSign is called!</span><br><span class="line">context: com.achievo.vipshop.common.VipApplicationLike@41bfc24</span><br><span class="line">treeMap: &#123;activity=null, activity_endtime=null, activity_id=7660011, activity_param=&#123;&quot;page_info&quot;:&#123;&quot;source_from&quot;:&#123;&quot;ffp&quot;:&quot;-99&quot;,&quot;s&quot;:&quot;9&quot;,&quot;fp&quot;:&#123;&quot;ot&quot;:&quot;23&quot;,&quot;chi&quot;:&quot;1024&quot;,&quot;f&quot;:&quot;1&quot;,&quot;tsf&quot;:&quot;0&quot;,&quot;pi&quot;:&quot;20180930001&quot;,&quot;page&quot;:&quot;page_channel&quot;,&quot;cn&quot;:&quot;推荐&quot;&#125;,&quot;tp&quot;:&#123;&quot;pi&quot;:&quot;裤子男款&quot;,&quot;page&quot;:&quot;page_te_commodity_search&quot;&#125;,&quot;sp&quot;:&#123;&quot;ot&quot;:&quot;s93&quot;,&quot;of&quot;:&quot;sf1&quot;,&quot;oi&quot;:&quot;裤子男款&quot;,&quot;page&quot;:&quot;page_te_globle_classify_search&quot;&#125;&#125;,&quot;page_id&quot;:&quot;page_commodity_detail_1734423751094&quot;,&quot;page_propety&quot;:&#123;&quot;sale_id&quot;:&quot;1711235467&quot;,&quot;detailStatus&quot;:&quot;0&quot;,&quot;goods_rank&quot;:&quot;1&quot;,&quot;banStatus&quot;:&quot;-99&quot;,&quot;mr&quot;:&quot;-6017890654677737204&quot;,&quot;scene_entry_id&quot;:&quot;-99&quot;,&quot;refer_page_id&quot;:&quot;page_te_commodity_search_1734423543145&quot;,&quot;goods_id&quot;:&quot;6921055391784126923&quot;,&quot;isPreSale&quot;:&quot;0&quot;,&quot;store&quot;:&quot;0&quot;,&quot;type&quot;:&quot;-99&quot;,&quot;direct_buy&quot;:&quot;-99&quot;,&quot;brand_id&quot;:&quot;1711235467&quot;,&quot;has_color&quot;:&quot;1&quot;,&quot;isBgToFront&quot;:&quot;0&quot;,&quot;buy_mode_scene&quot;:&quot;-99&quot;,&quot;module_name&quot;:&quot;com.achievo.vipshop.productdetail&quot;,&quot;with_image&quot;:&quot;0&quot;,&quot;sr&quot;:&quot;-6017890015095286044&quot;,&quot;is_back_page&quot;:&quot;0&quot;&#125;,&quot;page&quot;:&quot;page_commodity_detail&quot;&#125;,&quot;biz_data&quot;:&#123;&quot;sequence&quot;:&quot;-99&quot;,&quot;target_type&quot;:&quot;1&quot;,&quot;target_id&quot;:&quot;9e8b047b52d0&quot;&#125;&#125;, activity_propety=null, activity_starttime=1734423752401, app_name=shop_android, app_version=9.39.4, channel=1, deeplink_cps=, face_flag=0_1, fdc_area_id=104101113, local_time=1734423856870, location=104101, mid=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad, other_cps=, page_id=page_commodity_detail_1734423751094, repeat=0, service=mobile.activityinfo.logger, session_id=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734423526867, skey=6692c461c3810ab150c9a980d0c275ec, status=, status_descrit=null, user_class=A1, user_group=20460_【23年新客首页】安卓-5.23-[快应用-独立首页]-[顶部导航-测试-18], user_label=3105,310505, userid=null, vipruid=null, warehouse=VIP_HZ&#125;</span><br><span class="line">str: null</span><br><span class="line">VCSPSecurityBasicService.apiSign result=2ba1c5746ce498722dc8eb444f7170ef7319f848</span><br></pre></td></tr></table></figure>



<h2 id="getMapParamsSign"><a href="#getMapParamsSign" class="headerlink" title="getMapParamsSign"></a>getMapParamsSign</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getMapParamsSign.jpg" alt="getMapParamsSign"></p>
<p><code>getMapParamsSign</code> 函数用于生成 API 请求的签名</p>
<p>调用 <code>getSignHash(context, treeMap, str2, z10)</code> 方法，生成签名并返回。</p>
<h2 id="getSignHash"><a href="#getSignHash" class="headerlink" title="getSignHash"></a>getSignHash</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/getSignHash.jpg" alt="getSignHash"></p>
<p>调用 <code>gs(context.getApplicationContext(), map, str, z10)</code> 来生成签名哈希值。</p>
<h2 id="gs"><a href="#gs" class="headerlink" title="gs"></a>gs</h2><p>这里jadx不能正常反编译gs函数，使用jeb进行反编译</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/gs.jpg" alt="gs"></p>
<p>调用 <code>VCSPSecurityConfig.initInstance()</code> 方法进行初始化。</p>
<p>通过反射获取 <code>clazz</code> 对应的类中名为 <code>&quot;gs&quot;</code> 的方法，该方法接受 <code>Context</code>、<code>Map</code>、<code>String</code> 和 <code>boolean</code> 类型的参数。</p>
<p>使用反射调用获取到的 <code>gsMethod</code> 方法，传入参数 <code>context0</code>、<code>map0</code>、<code>s</code> 和 <code>z</code>，并将结果转换为 <code>String</code> 类型返回。</p>
<h2 id="initInstance"><a href="#initInstance" class="headerlink" title="initInstance"></a>initInstance</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/instance.jpg"></p>
<p>初始化 <code>VCSPSecurityConfig</code> 类的静态成员 <code>clazz</code> 和 <code>object</code>。</p>
<p><strong><code>clazz = KeyInfo.class</code></strong></p>
<h2 id="KeyInfo-gs"><a href="#KeyInfo-gs" class="headerlink" title="KeyInfo.gs"></a>KeyInfo.gs</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">gs</span><span class="params">(Context context, Map&lt;String, String&gt; map, String str, <span class="type">boolean</span> z10)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> gsNav(context, map, str, z10);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable th2) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;KI gs: &quot;</span> + th2.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable unused) &#123;</span><br><span class="line">        SoLoader.load(context, LibName);</span><br><span class="line">        <span class="keyword">return</span> gsNav(context, map, str, z10);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用 <code>gsNav(context, map, str, z10)</code> 来生成签名。</p>
<h2 id="gsNav"><a href="#gsNav" class="headerlink" title="gsNav"></a>gsNav</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">native</span> String <span class="title function_">gsNav</span><span class="params">(Context context, Map&lt;String, String&gt; map, String str, <span class="type">boolean</span> z10)</span>;</span><br></pre></td></tr></table></figure>

<p>这是一个native方法</p>
<h2 id="so"><a href="#so" class="headerlink" title="so"></a>so</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">&quot;keyinfo&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span>(Throwable throwable0) &#123;</span><br><span class="line">        throwable0.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="hook-gsNav"><a href="#hook-gsNav" class="headerlink" title="hook gsNav"></a>hook gsNav</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">printMap</span>(<span class="params">param_map</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">HashMap</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.TreeMap&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> arg_map = <span class="title class_">Java</span>.<span class="title function_">cast</span>(param_map,<span class="title class_">HashMap</span>);</span><br><span class="line">    <span class="keyword">return</span> arg_map.<span class="title function_">toString</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_gsNav</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="title class_">KeyInfo</span>[<span class="string">&quot;gsNav&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">context, map, str, z10</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked gsNav----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.gsNav is called: context=<span class="subst">$&#123;context&#125;</span>, map=<span class="subst">$&#123;map&#125;</span>, str=<span class="subst">$&#123;str&#125;</span>, z10=<span class="subst">$&#123;z10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;gsNav map:&quot;</span>,<span class="title function_">printMap</span>(map))</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;gsNav&quot;</span>](context, map, str, z10);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.gsNav result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_gsNav</span>()</span><br></pre></td></tr></table></figure>

<p><strong>结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">----hooked gsNav----</span><br><span class="line">KeyInfo.gsNav is called: context=com.achievo.vipshop.common.VipApplicationLike@478a323, map=[object Object], str=null, z10=false</span><br><span class="line">gsNav map: &#123;activity=lightart_click, activity_endtime=null, activity_propety=&#123;&quot;obj_data&quot;:&quot;sub_sn=1&amp;id=2085883&amp;code=10052420&amp;slotId=4&amp;source=pcmp&amp;slot_type=84&quot;,&quot;hole_type&quot;:&quot;pcmp&quot;,&quot;obj_id&quot;:&quot;336&quot;,&quot;unique_id&quot;:&quot;10052420:7:2085883&quot;,&quot;content_id&quot;:&quot;mst_100056642&quot;,&quot;content_sn&quot;:&quot;1&quot;,&quot;mr&quot;:&quot;-6009657029902736963&quot;,&quot;hole_id&quot;:&quot;2085883&quot;,&quot;operation_code&quot;:&quot;10052420&quot;,&quot;biz_data&quot;:&quot;tt=url&amp;ti=mst_100056642&quot;,&quot;obj_location&quot;:&quot;3:&quot;,&quot;content_type&quot;:&quot;mst&quot;,&quot;ext_data&quot;:&quot;code=10052420&amp;layout_id=52921&amp;slotType=84&amp;slotAbtestId=4218&amp;goodsId=6920749529361397578&amp;floorId=2085883&amp;slotPoolId=53109357&amp;m_name=AA%E7%89%88C%E4%BD%8D&amp;material=108&amp;brandSn=10000542&amp;product_id=6920749529361397578&amp;recommendImageId=f70c02f25aa57695679&amp;menu_code=20180930001&amp;slotId=4&amp;nodeId=1&quot;,&quot;obj_type&quot;:&quot;5&quot;,&quot;page&quot;:&quot;page_channel&quot;,&quot;cache_data&quot;:&quot;0&quot;&#125;, activity_starttime=1734846844455, app_name=shop_android, app_version=9.39.4, channel=1, deeplink_cps=, face_flag=0_1, fdc_area_id=104101113, local_time=1734846955236, location=104101, mid=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad, other_cps=, page_id=page_channel_1734846541245, repeat=0, service=mobile.activityinfo.logger, session_id=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734845336928, skey=6692c461c3810ab150c9a980d0c275ec, status=, status_descrit=null, user_class=A1, user_group=20460_【23年新客首页】安卓-5.23-[快应用-独立首页]-[顶部导航-测试-18], user_label=3105,310505, userid=null, vipruid=null, warehouse=VIP_HZ&#125;</span><br><span class="line">KeyInfo.gsNav result=0aff60c1b478fdafc0ea9700cdd80d1ae4c46f7d</span><br><span class="line">----hooked over!----</span><br></pre></td></tr></table></figure>

<h1 id="分析so"><a href="#分析so" class="headerlink" title="分析so"></a>分析so</h1><p>导出函数中找gsNav</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/exports.jpg"></p>
<h2 id="Java-com-vip-vcsp-KeyInfo-gsNav"><a href="#Java-com-vip-vcsp-KeyInfo-gsNav" class="headerlink" title="Java_com_vip_vcsp_KeyInfo_gsNav"></a>Java_com_vip_vcsp_KeyInfo_gsNav</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Java_com_vip_vcsp_KeyInfo_gsNav</span><span class="params">(</span></span><br><span class="line"><span class="params">        __int64 a1,</span></span><br><span class="line"><span class="params">        __int64 a2,</span></span><br><span class="line"><span class="params">        __int64 a3,</span></span><br><span class="line"><span class="params">        __int64 a4,</span></span><br><span class="line"><span class="params">        __int64 a5,</span></span><br><span class="line"><span class="params">        <span class="type">unsigned</span> <span class="type">int</span> a6)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v11; <span class="comment">// x20</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)Utils_ima(a1, a2, a3) )</span><br><span class="line">    v11 = Functions_gs(a1, a2, a4, a5, a6);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    v11 = <span class="number">0LL</span>;</span><br><span class="line">  Utils_checkJniException(a1);</span><br><span class="line">  <span class="keyword">return</span> v11;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Functions-gs"><a href="#Functions-gs" class="headerlink" title="Functions_gs"></a>Functions_gs</h2><p>关键代码</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/functions_gs.jpg"></p>
<h2 id="getByteHash"><a href="#getByteHash" class="headerlink" title="getByteHash"></a>getByteHash</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> *__fastcall <span class="title function_">getByteHash</span><span class="params">(JNIEnv *a1, jobject a2, __int64 a3, <span class="type">unsigned</span> <span class="type">int</span> a4, <span class="type">char</span> *a5)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 i; <span class="comment">// x20</span></span><br><span class="line">  _OWORD v10[<span class="number">4</span>]; <span class="comment">// [xsp+0h] [xbp-E0h] BYREF</span></span><br><span class="line">  _BYTE v11[<span class="number">104</span>]; <span class="comment">// [xsp+40h] [xbp-A0h] BYREF</span></span><br><span class="line">  __int64 v12; <span class="comment">// [xsp+A8h] [xbp-38h]</span></span><br><span class="line"></span><br><span class="line">  v12 = *(_QWORD *)(_ReadStatusReg(ARM64_SYSREG(<span class="number">3</span>, <span class="number">3</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">2</span>)) + <span class="number">40</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !a3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">  SHA1Reset(v11);</span><br><span class="line">  SHA1Input(v11, a3, a4);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)SHA1Result(v11) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0LL</span>; i != <span class="number">20</span>; i += <span class="number">4LL</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">memset</span>(v10, <span class="number">0</span>, <span class="keyword">sizeof</span>(v10));</span><br><span class="line">      sub_F2328(v10);</span><br><span class="line">      <span class="built_in">strcat</span>(a5, (<span class="type">const</span> <span class="type">char</span> *)v10);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> a5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里看出这是SHA1算法</p>
<h2 id="hook-getByteHash"><a href="#hook-getByteHash" class="headerlink" title="hook getByteHash"></a>hook getByteHash</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libkeyinfo.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> functionaddr = soAddr.<span class="title function_">add</span>(<span class="number">0xF2260</span>)</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionaddr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">2</span>],&#123;length : args[<span class="number">3</span>].<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">4</span>]));</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,<span class="title function_">hexdump</span>(ret))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_native</span>()</span><br></pre></td></tr></table></figure>

<h3 id="示例一个hook结果"><a href="#示例一个hook结果" class="headerlink" title="示例一个hook结果"></a>示例一个hook结果</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">arg2              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">71fb5bdf50  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">71fb5bdf60  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">71fb5bdf70  65 66 66 63 38 31 33 35 31 39 36 61 63 30 35 64  effc8135196ac05d</span><br><span class="line">71fb5bdf80  63 64 36 39 64 35 36 39 32 66 32 31 37 34 33 33  cd69d5692f217433</span><br><span class="line">71fb5bdf90  30 39 62 31 38 62 36 63                          09b18b6c</span><br><span class="line">arg3 0x48</span><br><span class="line">arg4              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">71fb5be050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be0a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">71fb5be050  36 61 38 35 66 30 38 65 35 37 66 37 30 38 35 38  6a85f08e57f70858</span><br><span class="line">71fb5be060  33 35 37 32 35 33 61 37 32 34 34 62 33 32 63 65  357253a7244b32ce</span><br><span class="line">71fb5be070  62 36 33 39 62 62 66 39 00 00 00 00 00 00 00 00  b639bbf9........</span><br><span class="line">71fb5be080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">71fb5be090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br></pre></td></tr></table></figure>

<p>如下验证了这是一个标准的SHA1算法</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/tttt.jpg" alt="tttt"></p>
<h3 id="升级一下脚本继续hook"><a href="#升级一下脚本继续hook" class="headerlink" title="升级一下脚本继续hook"></a>升级一下脚本继续hook</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libkeyinfo.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> functionaddr = soAddr.<span class="title function_">add</span>(<span class="number">0xF2260</span>)  </span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionaddr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked getByteHash----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">2</span>],&#123;length : args[<span class="number">3</span>].<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3:&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">4</span>]));</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg2</span> = args[<span class="number">2</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg3</span> = args[<span class="number">3</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg4</span> = args[<span class="number">4</span>];</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg2:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg2</span>,&#123;length : <span class="variable language_">this</span>.<span class="property">arg3</span>.<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg3:&quot;</span>,<span class="variable language_">this</span>.<span class="property">arg3</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg4:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg4</span>));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,<span class="title function_">hexdump</span>(ret));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_native</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">724c411400  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">724c411410  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">724c411420  61 63 74 69 76 69 74 79 3d 61 63 74 69 76 65 5f  activity=active_</span><br><span class="line">724c411430  74 65 5f 64 79 6e 61 6d 69 63 5f 72 65 73 26 61  te_dynamic_res&amp;a</span><br><span class="line">724c411440  63 74 69 76 69 74 79 5f 65 6e 64 74 69 6d 65 3d  ctivity_endtime=</span><br><span class="line">724c411450  6e 75 6c 6c 26 61 63 74 69 76 69 74 79 5f 70 72  null&amp;activity_pr</span><br><span class="line">724c411460  6f 70 65 74 79 3d 7b 22 61 63 74 69 76 69 74 79  opety=&#123;&quot;activity</span><br><span class="line">724c411470  5f 6e 61 6d 65 22 3a 22 22 2c 22 64 65 70 65 6e  _name&quot;:&quot;&quot;,&quot;depen</span><br><span class="line">724c411480  64 5f 73 74 61 74 75 73 22 3a 2d 31 2c 22 6d 6f  d_status&quot;:-1,&quot;mo</span><br><span class="line">724c411490  64 75 6c 65 22 3a 22 73 6d 61 72 74 52 6f 75 74  dule&quot;:&quot;smartRout</span><br><span class="line">724c4114a0  65 22 2c 22 6d 61 74 63 68 22 3a 31 2c 22 69 73  e&quot;,&quot;match&quot;:1,&quot;is</span><br><span class="line">724c4114b0  5f 64 65 62 75 67 22 3a 22 30 22 2c 22 61 70 6b  _debug&quot;:&quot;0&quot;,&quot;apk</span><br><span class="line">724c4114c0  5f 74 79 70 65 22 3a 22 31 22 2c 22 73 63 65 6e  _type&quot;:&quot;1&quot;,&quot;scen</span><br><span class="line">724c4114d0  65 22 3a 22 61 70 69 22 2c 22 69 73 5f 6d 61 69  e&quot;:&quot;api&quot;,&quot;is_mai</span><br><span class="line">724c4114e0  6e 5f 70 72 6f 63 65 73 73 22 3a 31 2c 22 66 61  n_process&quot;:1,&quot;fa</span><br><span class="line">724c4114f0  69 6c 5f 62 61 63 6b 22 3a 30 2c 22 65 76 65 6e  il_back&quot;:0,&quot;even</span><br><span class="line">724c411500  74 5f 69 64 22 3a 30 2c 22 68 61 73 5f 6d 6f 64  t_id&quot;:0,&quot;has_mod</span><br><span class="line">724c411510  75 6c 65 22 3a 30 2c 22 72 65 6d 6f 76 65 5f 73  ule&quot;:0,&quot;remove_s</span><br><span class="line">724c411520  6f 22 3a 22 30 22 2c 22 61 63 74 69 6f 6e 22 3a  o&quot;:&quot;0&quot;,&quot;action&quot;:</span><br><span class="line">724c411530  22 72 65 73 5f 73 63 65 6e 65 22 2c 22 73 74 61  &quot;res_scene&quot;,&quot;sta</span><br><span class="line">724c411540  74 75 73 22 3a 30 7d 26 61 63 74 69 76 69 74 79  tus&quot;:0&#125;&amp;activity</span><br><span class="line">724c411550  5f 73 74 61 72 74 74 69 6d 65 3d 31 37 33 34 38  _starttime=17348</span><br><span class="line">724c411560  34 37 33 37 31 36 36 38 26 61 70 70 5f 6e 61 6d  47371668&amp;app_nam</span><br><span class="line">724c411570  65 3d 73 68 6f 70 5f 61 6e 64 72 6f 69 64 26 61  e=shop_android&amp;a</span><br><span class="line">724c411580  70 70 5f 76 65 72 73 69 6f 6e 3d 39 2e 33 39 2e  pp_version=9.39.</span><br><span class="line">724c411590  34 26 63 68 61 6e 6e 65 6c 3d 31 26 64 65 65 70  4&amp;channel=1&amp;deep</span><br><span class="line">724c4115a0  6c 69 6e 6b 5f 63 70 73 3d 26 66 61 63 65 5f 66  link_cps=&amp;face_f</span><br><span class="line">724c4115b0  6c 61 67 3d 30 5f 31 26 66 64 63 5f 61 72 65 61  lag=0_1&amp;fdc_area</span><br><span class="line">724c4115c0  5f 69 64 3d 31 30 34 31 30 31 31 31 33 26 6c 6f  _id=104101113&amp;lo</span><br><span class="line">724c4115d0  63 61 6c 5f 74 69 6d 65 3d 31 37 33 34 38 34 37  cal_time=1734847</span><br><span class="line">724c4115e0  33 37 31 36 36 38 26 6c 6f 63 61 74 69 6f 6e 3d  371668&amp;location=</span><br><span class="line">724c4115f0  31 30 34 31 30 31 26 6d 69 64 3d 62 33 61 61 64  104101&amp;mid=b3aad</span><br><span class="line">724c411600  38 65 32 2d 32 38 34 30 2d 33 39 61 35 2d 38 62  8e2-2840-39a5-8b</span><br><span class="line">724c411610  35 31 2d 65 35 62 31 63 35 62 31 36 62 61 64 26  51-e5b1c5b16bad&amp;</span><br><span class="line">724c411620  6f 74 68 65 72 5f 63 70 73 3d 26 70 61 67 65 5f  other_cps=&amp;page_</span><br><span class="line">724c411630  69 64 3d 70 61 67 65 5f 74 65 5f 6c 6f 64 69 6e  id=page_te_lodin</span><br><span class="line">724c411640  67 5f 61 63 74 69 76 69 74 79 5f 31 37 33 34 38  g_activity_17348</span><br><span class="line">724c411650  34 37 33 37 31 34 30 31 26 72 65 70 65 61 74 3d  47371401&amp;repeat=</span><br><span class="line">724c411660  30 26 73 65 72 76 69 63 65 3d 6d 6f 62 69 6c 65  0&amp;service=mobile</span><br><span class="line">724c411670  2e 61 63 74 69 76 69 74 79 69 6e 66 6f 2e 6c 6f  .activityinfo.lo</span><br><span class="line">724c411680  67 67 65 72 26 73 65 73 73 69 6f 6e 5f 69 64 3d  gger&amp;session_id=</span><br><span class="line">724c411690  62 33 61 61 64 38 65 32 2d 32 38 34 30 2d 33 39  b3aad8e2-2840-39</span><br><span class="line">724c4116a0  61 35 2d 38 62 35 31 2d 65 35 62 31 63 35 62 31  a5-8b51-e5b1c5b1</span><br><span class="line">724c4116b0  36 62 61 64 5f 73 68 6f 70 5f 61 6e 64 72 6f 69  6bad_shop_androi</span><br><span class="line">724c4116c0  64 5f 31 37 33 34 38 34 37 33 37 31 33 33 35 26  d_1734847371335&amp;</span><br><span class="line">724c4116d0  73 6b 65 79 3d 36 36 39 32 63 34 36 31 63 33 38  skey=6692c461c38</span><br><span class="line">724c4116e0  31 30 61 62 31 35 30 63 39 61 39 38 30 64 30 63  10ab150c9a980d0c</span><br><span class="line">724c4116f0  32 37 35 65 63 26 73 74 61 74 75 73 3d 26 73 74  275ec&amp;status=&amp;st</span><br><span class="line">724c411700  61 74 75 73 5f 64 65 73 63 72 69 74 3d 6e 75 6c  atus_descrit=nul</span><br><span class="line">724c411710  6c 26 75 73 65 72 5f 63 6c 61 73 73 3d 41 31 26  l&amp;user_class=A1&amp;</span><br><span class="line">724c411720  75 73 65 72 5f 67 72 6f 75 70 3d 32 30 34 36 30  user_group=20460</span><br><span class="line">724c411730  5f e3 80 90 32 33 e5 b9 b4 e6 96 b0 e5 ae a2 e9  _...23..........</span><br><span class="line">724c411740  a6 96 e9 a1 b5 e3 80 91 e5 ae 89 e5 8d 93 2d 35  ..............-5</span><br><span class="line">724c411750  2e 32 33 2d 5b e5 bf ab e5 ba 94 e7 94 a8 2d e7  .23-[.........-.</span><br><span class="line">724c411760  8b ac e7 ab 8b e9 a6 96 e9 a1 b5 5d 2d 5b e9 a1  ...........]-[..</span><br><span class="line">724c411770  b6 e9 83 a8 e5 af bc e8 88 aa 2d e6 b5 8b e8 af  ..........-.....</span><br><span class="line">724c411780  95 2d 31 38 5d 26 75 73 65 72 5f 6c 61 62 65 6c  .-18]&amp;user_label</span><br><span class="line">724c411790  3d 33 31 30 35 2c 33 31 30 35 30 35 26 75 73 65  =3105,310505&amp;use</span><br><span class="line">724c4117a0  72 69 64 3d 6e 75 6c 6c 26 76 69 70 72 75 69 64  rid=null&amp;vipruid</span><br><span class="line">724c4117b0  3d 6e 75 6c 6c 26 77 61 72 65 68 6f 75 73 65 3d  =null&amp;warehouse=</span><br><span class="line">724c4117c0  56 49 50 5f 48 5a                                VIP_HZ</span><br><span class="line">arg3: 0x3c6</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40b0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">724c411400  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">724c411410  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">724c411420  61 63 74 69 76 69 74 79 3d 61 63 74 69 76 65 5f  activity=active_</span><br><span class="line">724c411430  74 65 5f 64 79 6e 61 6d 69 63 5f 72 65 73 26 61  te_dynamic_res&amp;a</span><br><span class="line">724c411440  63 74 69 76 69 74 79 5f 65 6e 64 74 69 6d 65 3d  ctivity_endtime=</span><br><span class="line">724c411450  6e 75 6c 6c 26 61 63 74 69 76 69 74 79 5f 70 72  null&amp;activity_pr</span><br><span class="line">724c411460  6f 70 65 74 79 3d 7b 22 61 63 74 69 76 69 74 79  opety=&#123;&quot;activity</span><br><span class="line">724c411470  5f 6e 61 6d 65 22 3a 22 22 2c 22 64 65 70 65 6e  _name&quot;:&quot;&quot;,&quot;depen</span><br><span class="line">724c411480  64 5f 73 74 61 74 75 73 22 3a 2d 31 2c 22 6d 6f  d_status&quot;:-1,&quot;mo</span><br><span class="line">724c411490  64 75 6c 65 22 3a 22 73 6d 61 72 74 52 6f 75 74  dule&quot;:&quot;smartRout</span><br><span class="line">724c4114a0  65 22 2c 22 6d 61 74 63 68 22 3a 31 2c 22 69 73  e&quot;,&quot;match&quot;:1,&quot;is</span><br><span class="line">724c4114b0  5f 64 65 62 75 67 22 3a 22 30 22 2c 22 61 70 6b  _debug&quot;:&quot;0&quot;,&quot;apk</span><br><span class="line">724c4114c0  5f 74 79 70 65 22 3a 22 31 22 2c 22 73 63 65 6e  _type&quot;:&quot;1&quot;,&quot;scen</span><br><span class="line">724c4114d0  65 22 3a 22 61 70 69 22 2c 22 69 73 5f 6d 61 69  e&quot;:&quot;api&quot;,&quot;is_mai</span><br><span class="line">724c4114e0  6e 5f 70 72 6f 63 65 73 73 22 3a 31 2c 22 66 61  n_process&quot;:1,&quot;fa</span><br><span class="line">724c4114f0  69 6c 5f 62 61 63 6b 22 3a 30 2c 22 65 76 65 6e  il_back&quot;:0,&quot;even</span><br><span class="line">724c411500  74 5f 69 64 22 3a 30 2c 22 68 61 73 5f 6d 6f 64  t_id&quot;:0,&quot;has_mod</span><br><span class="line">724c411510  75 6c 65 22 3a 30 2c 22 72 65 6d 6f 76 65 5f 73  ule&quot;:0,&quot;remove_s</span><br><span class="line">724c411520  6f 22 3a 22 30 22 2c 22 61 63 74 69 6f 6e 22 3a  o&quot;:&quot;0&quot;,&quot;action&quot;:</span><br><span class="line">724c411530  22 72 65 73 5f 73 63 65 6e 65 22 2c 22 73 74 61  &quot;res_scene&quot;,&quot;sta</span><br><span class="line">724c411540  74 75 73 22 3a 30 7d 26 61 63 74 69 76 69 74 79  tus&quot;:0&#125;&amp;activity</span><br><span class="line">724c411550  5f 73 74 61 72 74 74 69 6d 65 3d 31 37 33 34 38  _starttime=17348</span><br><span class="line">724c411560  34 37 33 37 31 36 36 38 26 61 70 70 5f 6e 61 6d  47371668&amp;app_nam</span><br><span class="line">724c411570  65 3d 73 68 6f 70 5f 61 6e 64 72 6f 69 64 26 61  e=shop_android&amp;a</span><br><span class="line">724c411580  70 70 5f 76 65 72 73 69 6f 6e 3d 39 2e 33 39 2e  pp_version=9.39.</span><br><span class="line">724c411590  34 26 63 68 61 6e 6e 65 6c 3d 31 26 64 65 65 70  4&amp;channel=1&amp;deep</span><br><span class="line">724c4115a0  6c 69 6e 6b 5f 63 70 73 3d 26 66 61 63 65 5f 66  link_cps=&amp;face_f</span><br><span class="line">724c4115b0  6c 61 67 3d 30 5f 31 26 66 64 63 5f 61 72 65 61  lag=0_1&amp;fdc_area</span><br><span class="line">724c4115c0  5f 69 64 3d 31 30 34 31 30 31 31 31 33 26 6c 6f  _id=104101113&amp;lo</span><br><span class="line">724c4115d0  63 61 6c 5f 74 69 6d 65 3d 31 37 33 34 38 34 37  cal_time=1734847</span><br><span class="line">724c4115e0  33 37 31 36 36 38 26 6c 6f 63 61 74 69 6f 6e 3d  371668&amp;location=</span><br><span class="line">724c4115f0  31 30 34 31 30 31 26 6d 69 64 3d 62 33 61 61 64  104101&amp;mid=b3aad</span><br><span class="line">724c411600  38 65 32 2d 32 38 34 30 2d 33 39 61 35 2d 38 62  8e2-2840-39a5-8b</span><br><span class="line">724c411610  35 31 2d 65 35 62 31 63 35 62 31 36 62 61 64 26  51-e5b1c5b16bad&amp;</span><br><span class="line">724c411620  6f 74 68 65 72 5f 63 70 73 3d 26 70 61 67 65 5f  other_cps=&amp;page_</span><br><span class="line">724c411630  69 64 3d 70 61 67 65 5f 74 65 5f 6c 6f 64 69 6e  id=page_te_lodin</span><br><span class="line">724c411640  67 5f 61 63 74 69 76 69 74 79 5f 31 37 33 34 38  g_activity_17348</span><br><span class="line">724c411650  34 37 33 37 31 34 30 31 26 72 65 70 65 61 74 3d  47371401&amp;repeat=</span><br><span class="line">724c411660  30 26 73 65 72 76 69 63 65 3d 6d 6f 62 69 6c 65  0&amp;service=mobile</span><br><span class="line">724c411670  2e 61 63 74 69 76 69 74 79 69 6e 66 6f 2e 6c 6f  .activityinfo.lo</span><br><span class="line">724c411680  67 67 65 72 26 73 65 73 73 69 6f 6e 5f 69 64 3d  gger&amp;session_id=</span><br><span class="line">724c411690  62 33 61 61 64 38 65 32 2d 32 38 34 30 2d 33 39  b3aad8e2-2840-39</span><br><span class="line">724c4116a0  61 35 2d 38 62 35 31 2d 65 35 62 31 63 35 62 31  a5-8b51-e5b1c5b1</span><br><span class="line">724c4116b0  36 62 61 64 5f 73 68 6f 70 5f 61 6e 64 72 6f 69  6bad_shop_androi</span><br><span class="line">724c4116c0  64 5f 31 37 33 34 38 34 37 33 37 31 33 33 35 26  d_1734847371335&amp;</span><br><span class="line">724c4116d0  73 6b 65 79 3d 36 36 39 32 63 34 36 31 63 33 38  skey=6692c461c38</span><br><span class="line">724c4116e0  31 30 61 62 31 35 30 63 39 61 39 38 30 64 30 63  10ab150c9a980d0c</span><br><span class="line">724c4116f0  32 37 35 65 63 26 73 74 61 74 75 73 3d 26 73 74  275ec&amp;status=&amp;st</span><br><span class="line">724c411700  61 74 75 73 5f 64 65 73 63 72 69 74 3d 6e 75 6c  atus_descrit=nul</span><br><span class="line">724c411710  6c 26 75 73 65 72 5f 63 6c 61 73 73 3d 41 31 26  l&amp;user_class=A1&amp;</span><br><span class="line">724c411720  75 73 65 72 5f 67 72 6f 75 70 3d 32 30 34 36 30  user_group=20460</span><br><span class="line">724c411730  5f e3 80 90 32 33 e5 b9 b4 e6 96 b0 e5 ae a2 e9  _...23..........</span><br><span class="line">724c411740  a6 96 e9 a1 b5 e3 80 91 e5 ae 89 e5 8d 93 2d 35  ..............-5</span><br><span class="line">724c411750  2e 32 33 2d 5b e5 bf ab e5 ba 94 e7 94 a8 2d e7  .23-[.........-.</span><br><span class="line">724c411760  8b ac e7 ab 8b e9 a6 96 e9 a1 b5 5d 2d 5b e9 a1  ...........]-[..</span><br><span class="line">724c411770  b6 e9 83 a8 e5 af bc e8 88 aa 2d e6 b5 8b e8 af  ..........-.....</span><br><span class="line">724c411780  95 2d 31 38 5d 26 75 73 65 72 5f 6c 61 62 65 6c  .-18]&amp;user_label</span><br><span class="line">724c411790  3d 33 31 30 35 2c 33 31 30 35 30 35 26 75 73 65  =3105,310505&amp;use</span><br><span class="line">724c4117a0  72 69 64 3d 6e 75 6c 6c 26 76 69 70 72 75 69 64  rid=null&amp;vipruid</span><br><span class="line">724c4117b0  3d 6e 75 6c 6c 26 77 61 72 65 68 6f 75 73 65 3d  =null&amp;warehouse=</span><br><span class="line">724c4117c0  56 49 50 5f 48 5a                                VIP_HZ</span><br><span class="line">ret_arg3: 0x3c6</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e4060  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e4070  64 66 36 66 62 65 36 31 00 00 00 00 00 00 00 00  df6fbe61........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e4060  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e4070  64 66 36 66 62 65 36 31 00 00 00 00 00 00 00 00  df6fbe61........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e3f50  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">72342e3f60  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">72342e3f70  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e3f80  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e3f90  64 66 36 66 62 65 36 31                          df6fbe61</span><br><span class="line">arg3: 0x48</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4060  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4070  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e40a0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e3f50  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">72342e3f60  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">72342e3f70  32 31 63 34 63 31 31 63 35 30 36 33 37 64 34 33  21c4c11c50637d43</span><br><span class="line">72342e3f80  31 36 65 63 63 31 62 62 66 37 65 36 61 34 61 62  16ecc1bbf7e6a4ab</span><br><span class="line">72342e3f90  64 66 36 66 62 65 36 31                          df6fbe61</span><br><span class="line">ret_arg3: 0x48</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 33 37 66 32 64 66 62 33 34 64 38 38 34 36 63  237f2dfb34d8846c</span><br><span class="line">72342e4060  61 37 66 31 31 30 37 31 35 38 33 66 62 33 61 66  a7f11071583fb3af</span><br><span class="line">72342e4070  35 66 39 38 62 39 66 65 00 00 00 00 00 00 00 00  5f98b9fe........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">72342e4050  32 33 37 66 32 64 66 62 33 34 64 38 38 34 36 63  237f2dfb34d8846c</span><br><span class="line">72342e4060  61 37 66 31 31 30 37 31 35 38 33 66 62 33 61 66  a7f11071583fb3af</span><br><span class="line">72342e4070  35 66 39 38 62 39 66 65 00 00 00 00 00 00 00 00  5f98b9fe........</span><br><span class="line">72342e4080  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">72342e4090  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br></pre></td></tr></table></figure>

<h3 id="主动调用gsNav方法，来观察getByteHash的输出结果"><a href="#主动调用gsNav方法，来观察getByteHash的输出结果" class="headerlink" title="主动调用gsNav方法，来观察getByteHash的输出结果"></a>主动调用gsNav方法，来观察getByteHash的输出结果</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">call_gsNav</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----call gsNav----&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> currentApplication = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>();</span><br><span class="line">        <span class="keyword">var</span> context = currentApplication.<span class="title function_">getApplicationContext</span>();</span><br><span class="line">        <span class="keyword">var</span> map = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.util.TreeMap&quot;</span>).$new();</span><br><span class="line">        map.<span class="title function_">put</span>(<span class="string">&quot;api_key&quot;</span>,<span class="string">&quot;bileton&quot;</span>)</span><br><span class="line">        map.<span class="title function_">put</span>(<span class="string">&quot;app_name&quot;</span>,<span class="string">&quot;shop_android&quot;</span>)</span><br><span class="line">        <span class="keyword">var</span> string = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">var</span> boolean = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> result = <span class="title class_">KeyInfo</span>.<span class="title function_">gsNav</span>(context,map,string,boolean)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;call gsNav result:&quot;</span>,result)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----call gsNav over----&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libkeyinfo.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> functionaddr = soAddr.<span class="title function_">add</span>(<span class="number">0xF2260</span>)  </span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionaddr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked getByteHash----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg2:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">2</span>],&#123;length : args[<span class="number">3</span>].<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg3:&quot;</span>,args[<span class="number">3</span>]);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg4:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">4</span>]));</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg2</span> = args[<span class="number">2</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg3</span> = args[<span class="number">3</span>];</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">arg4</span> = args[<span class="number">4</span>];</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg2:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg2</span>,&#123;length : <span class="variable language_">this</span>.<span class="property">arg3</span>.<span class="title function_">toInt32</span>()&#125;));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg3:&quot;</span>,<span class="variable language_">this</span>.<span class="property">arg3</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret_arg4:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">arg4</span>));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,<span class="title function_">hexdump</span>(ret));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">hook_native</span>();</span><br><span class="line">    <span class="title function_">call_gsNav</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br></pre></td><td class="code"><pre><span class="line">----call gsNav----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d0246f580  30 82 02 5f 30 82 01 c8 a0 03 02 01 02 02 04 4e  0.._0..........N</span><br><span class="line">7d0246f590  77 18 86 30 0d 06 09 2a 86 48 86 f7 0d 01 01 05  w..0...*.H......</span><br><span class="line">7d0246f5a0  05 00 30 73 31 0b 30 09 06 03 55 04 06 13 02 63  ..0s1.0...U....c</span><br><span class="line">7d0246f5b0  6e 31 12 30 10 06 03 55 04 08 13 09 67 75 61 6e  n1.0...U....guan</span><br><span class="line">7d0246f5c0  67 64 6f 6e 67 31 12 30 10 06 03 55 04 07 13 09  gdong1.0...U....</span><br><span class="line">7d0246f5d0  67 75 61 6e 67 7a 68 6f 75 31 10 30 0e 06 03 55  guangzhou1.0...U</span><br><span class="line">7d0246f5e0  04 0a 13 07 76 69 70 73 68 6f 70 31 18 30 16 06  ....vipshop1.0..</span><br><span class="line">7d0246f5f0  03 55 04 0b 13 0f 77 77 77 2e 76 69 70 73 68 6f  .U....www.vipsho</span><br><span class="line">7d0246f600  70 2e 63 6f 6d 31 10 30 0e 06 03 55 04 03 13 07  p.com1.0...U....</span><br><span class="line">7d0246f610  76 69 70 73 68 6f 70 30 20 17 0d 31 31 30 39 31  vipshop0 ..11091</span><br><span class="line">7d0246f620  39 31 30 32 35 31 30 5a 18 0f 32 32 38 35 30 37  9102510Z..228507</span><br><span class="line">7d0246f630  30 34 31 30 32 35 31 30 5a 30 73 31 0b 30 09 06  04102510Z0s1.0..</span><br><span class="line">7d0246f640  03 55 04 06 13 02 63 6e 31 12 30 10 06 03 55 04  .U....cn1.0...U.</span><br><span class="line">7d0246f650  08 13 09 67 75 61 6e 67 64 6f 6e 67 31 12 30 10  ...guangdong1.0.</span><br><span class="line">7d0246f660  06 03 55 04 07 13 09 67 75 61 6e 67 7a 68 6f 75  ..U....guangzhou</span><br><span class="line">7d0246f670  31 10 30 0e 06 03 55 04 0a 13 07 76 69 70 73 68  1.0...U....vipsh</span><br><span class="line">7d0246f680  6f 70 31 18 30 16 06 03 55 04 0b 13 0f 77 77 77  op1.0...U....www</span><br><span class="line">7d0246f690  2e 76 69 70 73 68 6f 70 2e 63 6f 6d 31 10 30 0e  .vipshop.com1.0.</span><br><span class="line">7d0246f6a0  06 03 55 04 03 13 07 76 69 70 73 68 6f 70 30 81  ..U....vipshop0.</span><br><span class="line">7d0246f6b0  9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00  .0...*.H........</span><br><span class="line">7d0246f6c0  03 81 8d 00 30 81 89 02 81 81 00 93 34 83 f8 c0  ....0.......4...</span><br><span class="line">7d0246f6d0  1a 56 74 4a a3 a0 54 73 95 ca c4 22 ea 07 ae a0  .VtJ..Ts...&quot;....</span><br><span class="line">7d0246f6e0  3f 38 45 90 c1 fc bb eb d3 0c 71 39 5e a8 b6 bd  ?8E.......q9^...</span><br><span class="line">7d0246f6f0  1a 1b 04 84 47 49 0e 4b af 36 5a 4b 49 72 6f 35  ....GI.K.6ZKIro5</span><br><span class="line">7d0246f700  4e 57 96 35 f5 40 7e 63 86 57 49 2f 6c af 66 5c  NW.5.@~c.WI/l.f\</span><br><span class="line">7d0246f710  27 18 11 8c cc ba d9 2f 1f fc ab 62 3c c7 ca 9e  &#x27;....../...b&lt;...</span><br><span class="line">7d0246f720  a8 ca 9a d5 8c 47 ab 21 05 ba 7c 7c 6d 6f fe 46  .....G.!..||mo.F</span><br><span class="line">7d0246f730  6d 7e 94 06 bb f0 28 cb 9b b5 43 3a 74 cb 85 47  m~....(...C:t..G</span><br><span class="line">7d0246f740  d1 b6 de de f8 84 56 a1 67 9d 3d 02 03 01 00 01  ......V.g.=.....</span><br><span class="line">7d0246f750  30 0d 06 09 2a 86 48 86 f7 0d 01 01 05 05 00 03  0...*.H.........</span><br><span class="line">7d0246f760  81 81 00 17 fd cc f7 dd 2f 1a 42 80 92 89 a2 15  ......../.B.....</span><br><span class="line">7d0246f770  9b 64 aa 5a b0 57 91 35 88 18 37 74 3b ca 21 18  .d.Z.W.5..7t;.!.</span><br><span class="line">7d0246f780  0b f3 30 50 75 4b b8 a8 44 90 02 c6 07 5e b6 d7  ..0PuK..D....^..</span><br><span class="line">7d0246f790  1a 65 80 06 a6 b6 00 94 c1 69 f0 77 fb 06 3b 93  .e.......i.w..;.</span><br><span class="line">7d0246f7a0  91 64 d1 64 e6 70 4a ae a1 14 c1 fa ed b4 eb fc  .d.d.pJ.........</span><br><span class="line">7d0246f7b0  25 db ca 96 21 a5 58 d2 8b 87 1c 72 7f ff b6 0e  %...!.X....r....</span><br><span class="line">7d0246f7c0  c7 40 e8 64 01 53 e8 e9 4d a9 da 7b 09 9e 30 82  .@.d.S..M..&#123;..0.</span><br><span class="line">7d0246f7d0  c3 77 e4 6d 2d 4e 9c 4a 25 8a b2 54 99 d1 da 85  .w.m-N.J%..T....</span><br><span class="line">7d0246f7e0  5b 14 ca                                         [..</span><br><span class="line">arg3: 0x263</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea9c80  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9c90  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9ca0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cb0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cc0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cd0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line"></span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d0246f580  30 82 02 5f 30 82 01 c8 a0 03 02 01 02 02 04 4e  0.._0..........N</span><br><span class="line">7d0246f590  77 18 86 30 0d 06 09 2a 86 48 86 f7 0d 01 01 05  w..0...*.H......</span><br><span class="line">7d0246f5a0  05 00 30 73 31 0b 30 09 06 03 55 04 06 13 02 63  ..0s1.0...U....c</span><br><span class="line">7d0246f5b0  6e 31 12 30 10 06 03 55 04 08 13 09 67 75 61 6e  n1.0...U....guan</span><br><span class="line">7d0246f5c0  67 64 6f 6e 67 31 12 30 10 06 03 55 04 07 13 09  gdong1.0...U....</span><br><span class="line">7d0246f5d0  67 75 61 6e 67 7a 68 6f 75 31 10 30 0e 06 03 55  guangzhou1.0...U</span><br><span class="line">7d0246f5e0  04 0a 13 07 76 69 70 73 68 6f 70 31 18 30 16 06  ....vipshop1.0..</span><br><span class="line">7d0246f5f0  03 55 04 0b 13 0f 77 77 77 2e 76 69 70 73 68 6f  .U....www.vipsho</span><br><span class="line">7d0246f600  70 2e 63 6f 6d 31 10 30 0e 06 03 55 04 03 13 07  p.com1.0...U....</span><br><span class="line">7d0246f610  76 69 70 73 68 6f 70 30 20 17 0d 31 31 30 39 31  vipshop0 ..11091</span><br><span class="line">7d0246f620  39 31 30 32 35 31 30 5a 18 0f 32 32 38 35 30 37  9102510Z..228507</span><br><span class="line">7d0246f630  30 34 31 30 32 35 31 30 5a 30 73 31 0b 30 09 06  04102510Z0s1.0..</span><br><span class="line">7d0246f640  03 55 04 06 13 02 63 6e 31 12 30 10 06 03 55 04  .U....cn1.0...U.</span><br><span class="line">7d0246f650  08 13 09 67 75 61 6e 67 64 6f 6e 67 31 12 30 10  ...guangdong1.0.</span><br><span class="line">7d0246f660  06 03 55 04 07 13 09 67 75 61 6e 67 7a 68 6f 75  ..U....guangzhou</span><br><span class="line">7d0246f670  31 10 30 0e 06 03 55 04 0a 13 07 76 69 70 73 68  1.0...U....vipsh</span><br><span class="line">7d0246f680  6f 70 31 18 30 16 06 03 55 04 0b 13 0f 77 77 77  op1.0...U....www</span><br><span class="line">7d0246f690  2e 76 69 70 73 68 6f 70 2e 63 6f 6d 31 10 30 0e  .vipshop.com1.0.</span><br><span class="line">7d0246f6a0  06 03 55 04 03 13 07 76 69 70 73 68 6f 70 30 81  ..U....vipshop0.</span><br><span class="line">7d0246f6b0  9f 30 0d 06 09 2a 86 48 86 f7 0d 01 01 01 05 00  .0...*.H........</span><br><span class="line">7d0246f6c0  03 81 8d 00 30 81 89 02 81 81 00 93 34 83 f8 c0  ....0.......4...</span><br><span class="line">7d0246f6d0  1a 56 74 4a a3 a0 54 73 95 ca c4 22 ea 07 ae a0  .VtJ..Ts...&quot;....</span><br><span class="line">7d0246f6e0  3f 38 45 90 c1 fc bb eb d3 0c 71 39 5e a8 b6 bd  ?8E.......q9^...</span><br><span class="line">7d0246f6f0  1a 1b 04 84 47 49 0e 4b af 36 5a 4b 49 72 6f 35  ....GI.K.6ZKIro5</span><br><span class="line">7d0246f700  4e 57 96 35 f5 40 7e 63 86 57 49 2f 6c af 66 5c  NW.5.@~c.WI/l.f\</span><br><span class="line">7d0246f710  27 18 11 8c cc ba d9 2f 1f fc ab 62 3c c7 ca 9e  &#x27;....../...b&lt;...</span><br><span class="line">7d0246f720  a8 ca 9a d5 8c 47 ab 21 05 ba 7c 7c 6d 6f fe 46  .....G.!..||mo.F</span><br><span class="line">7d0246f730  6d 7e 94 06 bb f0 28 cb 9b b5 43 3a 74 cb 85 47  m~....(...C:t..G</span><br><span class="line">7d0246f740  d1 b6 de de f8 84 56 a1 67 9d 3d 02 03 01 00 01  ......V.g.=.....</span><br><span class="line">7d0246f750  30 0d 06 09 2a 86 48 86 f7 0d 01 01 05 05 00 03  0...*.H.........</span><br><span class="line">7d0246f760  81 81 00 17 fd cc f7 dd 2f 1a 42 80 92 89 a2 15  ......../.B.....</span><br><span class="line">7d0246f770  9b 64 aa 5a b0 57 91 35 88 18 37 74 3b ca 21 18  .d.Z.W.5..7t;.!.</span><br><span class="line">7d0246f780  0b f3 30 50 75 4b b8 a8 44 90 02 c6 07 5e b6 d7  ..0PuK..D....^..</span><br><span class="line">7d0246f790  1a 65 80 06 a6 b6 00 94 c1 69 f0 77 fb 06 3b 93  .e.......i.w..;.</span><br><span class="line">7d0246f7a0  91 64 d1 64 e6 70 4a ae a1 14 c1 fa ed b4 eb fc  .d.d.pJ.........</span><br><span class="line">7d0246f7b0  25 db ca 96 21 a5 58 d2 8b 87 1c 72 7f ff b6 0e  %...!.X....r....</span><br><span class="line">7d0246f7c0  c7 40 e8 64 01 53 e8 e9 4d a9 da 7b 09 9e 30 82  .@.d.S..M..&#123;..0.</span><br><span class="line">7d0246f7d0  c3 77 e4 6d 2d 4e 9c 4a 25 8a b2 54 99 d1 da 85  .w.m-N.J%..T....</span><br><span class="line">7d0246f7e0  5b 14 ca                                         [..</span><br><span class="line">ret_arg3: 0x263</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea9c80  31 65 64 35 36 32 65 31 65 39 30 62 32 33 61 65  1ed562e1e90b23ae</span><br><span class="line">7cd7ea9c90  33 66 39 61 34 30 66 38 62 32 61 36 35 33 38 32  3f9a40f8b2a65382</span><br><span class="line">7cd7ea9ca0  62 39 35 61 34 37 35 32 00 00 00 00 00 00 00 00  b95a4752........</span><br><span class="line">7cd7ea9cb0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cc0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cd0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea9c80  31 65 64 35 36 32 65 31 65 39 30 62 32 33 61 65  1ed562e1e90b23ae</span><br><span class="line">7cd7ea9c90  33 66 39 61 34 30 66 38 62 32 61 36 35 33 38 32  3f9a40f8b2a65382</span><br><span class="line">7cd7ea9ca0  62 39 35 61 34 37 35 32 00 00 00 00 00 00 00 00  b95a4752........</span><br><span class="line">7cd7ea9cb0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cc0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9cd0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9ce0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d02424b30  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7d02424b40  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7d02424b50  61 70 69 5f 6b 65 79 3d 62 69 6c 65 74 6f 6e 26  api_key=bileton&amp;</span><br><span class="line">7d02424b60  61 70 70 5f 6e 61 6d 65 3d 73 68 6f 70 5f 61 6e  app_name=shop_an</span><br><span class="line">7d02424b70  64 72 6f 69 64                                   droid</span><br><span class="line">arg3: 0x45</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a10  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7d02424b30  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7d02424b40  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7d02424b50  61 70 69 5f 6b 65 79 3d 62 69 6c 65 74 6f 6e 26  api_key=bileton&amp;</span><br><span class="line">7d02424b60  61 70 70 5f 6e 61 6d 65 3d 73 68 6f 70 5f 61 6e  app_name=shop_an</span><br><span class="line">7d02424b70  64 72 6f 69 64                                   droid</span><br><span class="line">ret_arg3: 0x45</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9a00  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9a10  35 37 39 31 32 30 62 64 00 00 00 00 00 00 00 00  579120bd........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9a00  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9a10  35 37 39 31 32 30 62 64 00 00 00 00 00 00 00 00  579120bd........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">----hooked getByteHash----</span><br><span class="line">arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea98f0  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7cd7ea9900  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7cd7ea9910  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9920  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9930  35 37 39 31 32 30 62 64                          579120bd</span><br><span class="line">arg3: 0x48</span><br><span class="line">arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a00  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a10  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret_arg2:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea98f0  61 65 65 34 63 34 32 35 64 62 62 32 32 38 38 62  aee4c425dbb2288b</span><br><span class="line">7cd7ea9900  38 30 63 37 31 33 34 37 63 63 33 37 64 30 34 62  80c71347cc37d04b</span><br><span class="line">7cd7ea9910  62 30 64 63 61 36 66 31 35 36 66 37 39 30 32 38  b0dca6f156f79028</span><br><span class="line">7cd7ea9920  62 33 61 36 38 63 31 36 36 32 39 34 30 34 65 34  b3a68c16629404e4</span><br><span class="line">7cd7ea9930  35 37 39 31 32 30 62 64                          579120bd</span><br><span class="line">ret_arg3: 0x48</span><br><span class="line">ret_arg4:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  63 39 31 34 63 39 64 64 32 62 38 36 32 61 37 34  c914c9dd2b862a74</span><br><span class="line">7cd7ea9a00  63 35 65 39 31 61 63 31 65 36 62 37 39 33 32 38  c5e91ac1e6b79328</span><br><span class="line">7cd7ea9a10  36 62 33 63 31 61 63 32 00 00 00 00 00 00 00 00  6b3c1ac2........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a50  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret:              0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">7cd7ea99f0  63 39 31 34 63 39 64 64 32 62 38 36 32 61 37 34  c914c9dd2b862a74</span><br><span class="line">7cd7ea9a00  63 35 65 39 31 61 63 31 65 36 62 37 39 33 32 38  c5e91ac1e6b79328</span><br><span class="line">7cd7ea9a10  36 62 33 63 31 61 63 32 00 00 00 00 00 00 00 00  6b3c1ac2........</span><br><span class="line">7cd7ea9a20  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a30  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a40  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a50  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">7cd7ea9a60  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">----hooked over!----</span><br><span class="line">call gsNav result: c914c9dd2b862a74c5e91ac1e6b793286b3c1ac2</span><br><span class="line">----call gsNav over----</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>发现当主动调用gsNav函数的时候，主动调用了三次getByteHash方法，而第一次调用getByteHash方法时的入参和返回值都没有找到相关的信息，在IDA里查看getByteHash交叉引用，发现</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/22.jpg"></p>
<p>发现在其他函数里也调用了getByteHash函数，溯源一下，最后找到是在<code>Utils_ima</code>方法里调用的，并不影响<code>Function_gs</code>函数调用的<code>getByteHash</code>。</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/23.jpg"></p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>从Functions_gs函数里可以看出来，getByteHash函数被调用了两次，这个函数是标准SHA1算法，那么要分析的话就要拿连续的两个hook结果，从hook结果来看，getByteHash传入的第三个参数是map，但是它的开头加盐了，<code>aee4c425dbb2288b80c71347cc37d04b</code>，这个盐的值是固定的</p>
<p>如下是我对Functions_gs函数变量重命名后的关键代码</p>
<p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/20.jpg"></p>
<p>SaltMap是加盐后的Map的值，经过第一次SHA1签名之后，得到ByteHash，然后在ByteHash前面加盐，再一次进行SHA1签名，得到最终的<code>api_sign</code></p>
<h2 id="验证一下"><a href="#验证一下" class="headerlink" title="验证一下"></a>验证一下</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"> </span><br><span class="line">mapdata = <span class="string">&#x27;activity=active_te_dynamic_res&amp;activity_endtime=null&amp;activity_propety=&#123;&quot;activity_name&quot;:&quot;&quot;,&quot;depend_status&quot;:-1,&quot;module&quot;:&quot;smartRoute&quot;,&quot;match&quot;:1,&quot;is_debug&quot;:&quot;0&quot;,&quot;apk_type&quot;:&quot;1&quot;,&quot;scene&quot;:&quot;api&quot;,&quot;is_main_process&quot;:1,&quot;fail_back&quot;:0,&quot;event_id&quot;:0,&quot;has_module&quot;:0,&quot;remove_so&quot;:&quot;0&quot;,&quot;action&quot;:&quot;res_scene&quot;,&quot;status&quot;:0&#125;&amp;activity_starttime=1734847371668&amp;app_name=shop_android&amp;app_version=9.39.4&amp;channel=1&amp;deeplink_cps=&amp;face_flag=0_1&amp;fdc_area_id=104101113&amp;local_time=1734847371668&amp;location=104101&amp;mid=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad&amp;other_cps=&amp;page_id=page_te_loding_activity_1734847371401&amp;repeat=0&amp;service=mobile.activityinfo.logger&amp;session_id=b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734847371335&amp;skey=6692c461c3810ab150c9a980d0c275ec&amp;status=&amp;status_descrit=null&amp;user_class=A1&amp;user_group=20460_【23年新客首页】安卓-5.23-[快应用-独立首页]-[顶部导航-测试-18]&amp;user_label=3105,310505&amp;userid=null&amp;vipruid=null&amp;warehouse=VIP_HZ&#x27;</span></span><br><span class="line"></span><br><span class="line">Salt = <span class="string">&quot;aee4c425dbb2288b80c71347cc37d04b&quot;</span></span><br><span class="line">SaltMap = Salt+mapdata</span><br><span class="line">cipher1 = hashlib.sha1()</span><br><span class="line">cipher1.update(SaltMap.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">ByteHash = cipher1.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(ByteHash)</span><br><span class="line">SecondEnc = Salt+ByteHash</span><br><span class="line">cipher2 = hashlib.sha1()</span><br><span class="line">cipher2.update(SecondEnc.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">api_sign = cipher2.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(api_sign)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">21c4c11c50637d4316ecc1bbf7e6a4abdf6fbe61</span><br><span class="line">237f2dfb34d8846ca7f11071583fb3af5f98b9fe</span><br></pre></td></tr></table></figure>

<p>还原完成</p>
<h1 id="设备注册接口复现"><a href="#设备注册接口复现" class="headerlink" title="设备注册接口复现"></a>设备注册接口复现</h1><p>这次我们可以用自己生成的api_sign来进行设备注册</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">def <span class="title function_">sha1</span>(data):</span><br><span class="line">    cipher = hashlib.<span class="title function_">sha1</span>()</span><br><span class="line">    cipher.<span class="title function_">update</span>(data)</span><br><span class="line">    <span class="keyword">return</span> cipher.<span class="title function_">hexdigest</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">device_token = <span class="title function_">str</span>(uuid.<span class="title function_">uuid4</span>())</span><br><span class="line"></span><br><span class="line">parameters = &#123;</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>:<span class="string">&quot;achievo_ad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>:<span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_token&quot;</span>:device_token,</span><br><span class="line">    <span class="string">&quot;status&quot;</span>:<span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>:<span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;manufacturer&quot;</span>:<span class="string">&quot;Google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device&quot;</span>:<span class="string">&quot;Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os_version&quot;</span>:<span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel&quot;</span>:<span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipruid&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regPlat&quot;</span>:<span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;regid&quot;</span>:<span class="string">&quot;null&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>:<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>:<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mp.appvipshop.com/apns/device_reg&quot;</span></span><br><span class="line"></span><br><span class="line">mapdata = <span class="string">&quot;&amp;&quot;</span>.<span class="title function_">join</span>([key+<span class="string">&quot;=&quot;</span>+value <span class="keyword">for</span> key,value <span class="keyword">in</span> parameters.<span class="title function_">items</span>()])</span><br><span class="line">salt = <span class="string">&quot;aee4c425dbb2288b80c71347cc37d04b&quot;</span></span><br><span class="line">onesha1 = <span class="title function_">sha1</span>((salt+mapdata).<span class="title function_">encode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">apisign = <span class="title function_">sha1</span>((salt+onesha1).<span class="title function_">encode</span>(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;okhttp/4.9.1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;authorization&quot;</span>:<span class="string">&quot;OAuth api_sign=&quot;</span>+apisign,</span><br><span class="line">    <span class="string">&quot;accept-encoding&quot;</span>:<span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.<span class="title function_">get</span>(url,headers=headers,params=parameters)</span><br><span class="line"><span class="title function_">print</span>(response.<span class="property">status_code</span>)</span><br><span class="line"><span class="title function_">print</span>(response.<span class="property">text</span>)</span><br></pre></td></tr></table></figure>

<h1 id="搜索接口逆向"><a href="#搜索接口逆向" class="headerlink" title="搜索接口逆向"></a>搜索接口逆向</h1><h2 id="搜索接口抓包"><a href="#搜索接口抓包" class="headerlink" title="搜索接口抓包"></a>搜索接口抓包</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/21.jpg"></p>
<h2 id="逆向还原"><a href="#逆向还原" class="headerlink" title="逆向还原"></a>逆向还原</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sha1</span>(<span class="params">data</span>):</span><br><span class="line">    cipher = hashlib.sha1()</span><br><span class="line">    cipher.update(data)</span><br><span class="line">    <span class="keyword">return</span> cipher.hexdigest()</span><br><span class="line"></span><br><span class="line">keyword = <span class="built_in">input</span>(<span class="string">&quot;input keyword:&quot;</span>)</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://mapi.appvipshop.com/vips-mobile/rest/shopping/search/product/list/v1&quot;</span></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;api_key&quot;</span>: <span class="string">&quot;23e7f28019e8407b98b84cd05b5aef2c&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_name&quot;</span>: <span class="string">&quot;shop_android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;app_version&quot;</span>: <span class="string">&quot;9.39.4&quot;</span>,</span><br><span class="line">    <span class="string">&quot;bigSaleTagIds&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;brandIds&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;brandStoreSns&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;categoryId&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channelId&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;channel_flag&quot;</span>: <span class="string">&quot;0_1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;clickFrom&quot;</span>: <span class="string">&quot;userword&quot;</span>,</span><br><span class="line">    <span class="string">&quot;client&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;client_type&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;couponIds&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;darkmode&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;deeplink_cps&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;device_model&quot;</span>: <span class="string">&quot;Google Pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;did&quot;</span>: <span class="string">&quot;0.0.7dd2447b686b5292535eeee5df76af4e.e30722&quot;</span>,</span><br><span class="line">    <span class="string">&quot;elder&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;evgid&quot;</span>: <span class="string">&quot;MEPeuS28WvKWWBaORXRayvPD91hpo6rtPhqtYlf9h/sqV/qXMrLitm9X/TxB0xIU0R0HnbOuRkt494w2LedGeuzIt0jR6xdfSfROjGrf92s=&quot;</span>,</span><br><span class="line">    <span class="string">&quot;extParams&quot;</span>: <span class="string">&#x27;&#123;&quot;priceVer&quot;:&quot;2&quot;,&quot;video_playable&quot;:&quot;1&quot;,&quot;mclabel&quot;:&quot;1&quot;,&quot;cmpStyle&quot;:&quot;1&quot;,&quot;statusVer&quot;:&quot;2&quot;,&quot;ic2label&quot;:&quot;1&quot;,&quot;video&quot;:&quot;2&quot;,&quot;uiVer&quot;:&quot;2&quot;,&quot;preheatTipsVer&quot;:&quot;4&quot;,&quot;floatwin&quot;:&quot;1&quot;,&quot;superHot&quot;:&quot;1&quot;,&quot;exclusivePrice&quot;:&quot;1&quot;,&quot;router&quot;:&quot;1&quot;,&quot;coupons&quot;:&quot;4&quot;,&quot;needVideoExplain&quot;:&quot;1&quot;,&quot;rank&quot;:&quot;2&quot;,&quot;needVideoGive&quot;:&quot;1&quot;,&quot;attr&quot;:&quot;2&quot;,&quot;bigBrand&quot;:&quot;2&quot;,&quot;couponVer&quot;:&quot;v2&quot;,&quot;videoExplainUrl&quot;:&quot;1&quot;,&quot;live&quot;:&quot;1&quot;,&quot;sellpoint&quot;:&quot;1&quot;,&quot;reco&quot;:&quot;1&quot;,&quot;vreimg&quot;:&quot;1&quot;,&quot;search_tag&quot;:&quot;2&quot;,&quot;tpl&quot;:&quot;1&quot;,&quot;ads&quot;:&quot;2&quot;,&quot;stdSizeVids&quot;:&quot;&quot;,&quot;labelVer&quot;:&quot;2&quot;,&quot;preheatView&quot;:&quot;1&quot;&#125;&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;fdc_area_id&quot;</span>: <span class="string">&quot;104101113&quot;</span>,</span><br><span class="line">    <span class="string">&quot;functions&quot;</span>: <span class="string">&quot;RTRecomm,flagshipInfo,couponBarV2,lowPriceTabs,discountTabs,feedbackV2,otdAds,zoneCode,slotOp,survey,outfit,aiRealtime,floaterParams,tabGroupV2,bsAndSeason,parallelCall&quot;</span>,</span><br><span class="line">    <span class="string">&quot;harmony_app&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;harmony_os&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;height&quot;</span>: <span class="string">&quot;2028&quot;</span>,</span><br><span class="line">    <span class="string">&quot;isMultiTab&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;is_default_area&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;keyword&quot;</span>: keyword,</span><br><span class="line">    <span class="string">&quot;lastPageProperty&quot;</span>: <span class="string">&quot;&#123;\&quot;isBgToFront\&quot;:\&quot;0\&quot;,\&quot;scene_entry_id\&quot;:\&quot;-99\&quot;,\&quot;refer_page_id\&quot;:\&quot;page_channel_1734917260119\&quot;,\&quot;text\&quot;:\&quot;女童加绒裤子\&quot;,\&quot;module_name\&quot;:\&quot;com.achievo.vipshop.search\&quot;,\&quot;type\&quot;:\&quot;-99\&quot;,\&quot;is_back_page\&quot;:\&quot;0\&quot;&#125;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;maker&quot;</span>: <span class="string">&quot;GOOGLE&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mars_cid&quot;</span>: <span class="string">&quot;b3aad8e2-2840-39a5-8b51-e5b1c5b16bad&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mobile_channel&quot;</span>: <span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;mobile_platform&quot;</span>: <span class="string">&quot;3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;net&quot;</span>: <span class="string">&quot;WIFI&quot;</span>,</span><br><span class="line">    <span class="string">&quot;operator&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os&quot;</span>: <span class="string">&quot;Android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;osv&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;otddid&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;other_cps&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;page_id&quot;</span>: <span class="string">&quot;page_te_globle_classify_search_1734917270854&quot;</span>,</span><br><span class="line">    <span class="string">&quot;phone_brand&quot;</span>: <span class="string">&quot;google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;phone_model&quot;</span>: <span class="string">&quot;pixel 3&quot;</span>,</span><br><span class="line">    <span class="string">&quot;priceMax&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;priceMin&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;props&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;province_id&quot;</span>: <span class="string">&quot;104101&quot;</span>,</span><br><span class="line">    <span class="string">&quot;referer&quot;</span>: <span class="string">&quot;com.achievo.vipshop.search.activity.TabSearchProductListActivity&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rom&quot;</span>: <span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 9; Pixel 3 Build/PD1A.180720.030)&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sd_tuijian&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;service_provider&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;session_id&quot;</span>: <span class="string">&quot;b3aad8e2-2840-39a5-8b51-e5b1c5b16bad_shop_android_1734917371208&quot;</span>,</span><br><span class="line">    <span class="string">&quot;skey&quot;</span>: <span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sort&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source&quot;</span>: <span class="string">&quot;app&quot;</span>,</span><br><span class="line">    <span class="string">&quot;source_app&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">    <span class="string">&quot;standby_id&quot;</span>: <span class="string">&quot;yro8nr0d:::&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sys_version&quot;</span>: <span class="string">&quot;28&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tabFields&quot;</span>: <span class="string">&quot;gender,tabs,priceTabs,discountTabs,tabGroupV2&quot;</span>,</span><br><span class="line">    <span class="string">&quot;timestamp&quot;</span>: <span class="string">&quot;1734917303&quot;</span>,</span><br><span class="line">    <span class="string">&quot;union_mark&quot;</span>: <span class="string">&quot;blank&amp;_&amp;blank&amp;_&amp;yro8nr0d:::&amp;_&amp;blank&amp;_&amp;blank&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vipService&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;warehouse&quot;</span>: <span class="string">&quot;VIP_HZ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;width&quot;</span>: <span class="string">&quot;1080&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mapdata = <span class="string">&quot;&amp;&quot;</span>.join([key+<span class="string">&quot;=&quot;</span>+value <span class="keyword">for</span> key,value <span class="keyword">in</span> data.items()])</span><br><span class="line">salt = <span class="string">&quot;aee4c425dbb2288b80c71347cc37d04b&quot;</span></span><br><span class="line">onesha1 = sha1((salt+mapdata).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">apisign = sha1((salt+onesha1).encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&quot;authorization&quot;</span>: <span class="string">&quot;OAuth api_sign=&quot;</span>+apisign,</span><br><span class="line">  <span class="string">&quot;x-vip-host&quot;</span>: <span class="string">&quot;mapi.appvipshop.com&quot;</span>,</span><br><span class="line">  <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">  <span class="string">&quot;content-length&quot;</span>: <span class="string">&quot;2886&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accept-encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span>,</span><br><span class="line">  <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;okhttp/4.9.1&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url=url,data=data,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>



<h1 id="Unidbg"><a href="#Unidbg" class="headerlink" title="Unidbg"></a>Unidbg</h1><h2 id="模拟执行getNavInfo"><a href="#模拟执行getNavInfo" class="headerlink" title="模拟执行getNavInfo()"></a>模拟执行getNavInfo()</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/24.jpg"></p>
<p>so是<code>libkeyinfo.so</code></p>
<h3 id="hook-getNavInfo"><a href="#hook-getNavInfo" class="headerlink" title="hook getNavInfo()"></a>hook getNavInfo()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_getNavInfo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="title class_">KeyInfo</span>[<span class="string">&quot;getNavInfo&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">context, str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.getNavInfo is called: context=<span class="subst">$&#123;context&#125;</span>, str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;getNavInfo&quot;</span>](context, str);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.getNavInfo result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hook_getNavInfo</span>();</span><br></pre></td></tr></table></figure>

<p>hook结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">KeyInfo.getNavInfo is called: context=com.achievo.vipshop.common.VipApplicationLike@ff37661, str=skey</span><br><span class="line">KeyInfo.getNavInfo result=6692c461c3810ab150c9a980d0c275ec</span><br></pre></td></tr></table></figure>

<h3 id="call-getNavInfo"><a href="#call-getNavInfo" class="headerlink" title="call getNavInfo()"></a>call getNavInfo()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">call_getNavInfo</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="keyword">let</span> context = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;android.app.ActivityThread&quot;</span>).<span class="title function_">currentApplication</span>().<span class="title function_">getApplicationContext</span>();</span><br><span class="line">        <span class="keyword">let</span> str = <span class="string">&quot;skey&quot;</span>;               </span><br><span class="line">        <span class="keyword">let</span> result = <span class="title class_">KeyInfo</span>[<span class="string">&quot;getNavInfo&quot;</span>](context, str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.getNavInfo result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KeyInfo.getNavInfo result=6692c461c3810ab150c9a980d0c275ec</span><br></pre></td></tr></table></figure>

<h3 id="Unidbg执行getNavInfo"><a href="#Unidbg执行getNavInfo" class="headerlink" title="Unidbg执行getNavInfo()"></a>Unidbg执行getNavInfo()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KeyInfo</span> <span class="keyword">extends</span> <span class="title class_">AbstractJni</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AndroidEmulator emulator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Memory memory;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VM vm;</span><br><span class="line">    <span class="keyword">private</span> DalvikModule dm;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KeyInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        emulator = AndroidEmulatorBuilder</span><br><span class="line">                .for64Bit() <span class="comment">// for32Bit()</span></span><br><span class="line">                .setRootDir(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;target/rootfs&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">        memory = emulator.getMemory();</span><br><span class="line">        memory.setLibraryResolver(<span class="keyword">new</span> <span class="title class_">AndroidResolver</span>(<span class="number">23</span>));</span><br><span class="line">        vm = emulator.createDalvikVM(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;unidbg-android/src/test/java/com/achievo/vipshop/weipinhui.apk&quot;</span>));</span><br><span class="line">        vm.setJni(<span class="built_in">this</span>);</span><br><span class="line">        vm.setVerbose(<span class="literal">true</span>);</span><br><span class="line">        dm = vm.loadLibrary(<span class="string">&quot;keyinfo&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        dm.callJNI_OnLoad(emulator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getNavInfo</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DvmClass</span> <span class="variable">KeyInfoClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="type">DvmObject</span> <span class="variable">context</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;android/app/Application&quot;</span>,vm.resolveClass(<span class="string">&quot;android/content/ContextWrapper&quot;</span>,vm.resolveClass(<span class="string">&quot;android/content/Context&quot;</span>))).newObject(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">StringObject</span> <span class="variable">stringObject</span> <span class="operator">=</span> KeyInfoClass.callStaticJniMethodObject(emulator,<span class="string">&quot;getNavInfo(Landroid/content/Context;Ljava/lang/String;)Ljava/lang/String;&quot;</span>,context,<span class="string">&quot;skey&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> stringObject.getValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">KeyInfo</span> <span class="variable">keyInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KeyInfo</span>();</span><br><span class="line">        System.out.println(keyInfo.getNavInfo()); <span class="comment">// 6692c461c3810ab150c9a980d0c275ec</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="模拟执行gsNav"><a href="#模拟执行gsNav" class="headerlink" title="模拟执行gsNav()"></a>模拟执行gsNav()</h2><p><img src="/2024/12/23/%E5%94%AF%E5%93%81%E4%BC%9A%E8%AE%BE%E5%A4%87%E6%B3%A8%E5%86%8C%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E9%80%86%E5%90%91%E5%88%86%E6%9E%90/25.jpg"></p>
<h3 id="hook-gsNav-1"><a href="#hook-gsNav-1" class="headerlink" title="hook gsNav()"></a>hook gsNav()</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_gsNav</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">KeyInfo</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line">        <span class="title class_">KeyInfo</span>[<span class="string">&quot;gsNav&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">context, map, str, z10</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked gsNav----&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.gsNav is called: context=<span class="subst">$&#123;context&#125;</span>, map=<span class="subst">$&#123;map&#125;</span>, str=<span class="subst">$&#123;str&#125;</span>, z10=<span class="subst">$&#123;z10&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;gsNav map:&quot;</span>,<span class="title function_">printMap</span>(map))</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;gsNav&quot;</span>](context, map, str, z10);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`KeyInfo.gsNav result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----hooked over!----&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hook_gsNav</span>()</span><br></pre></td></tr></table></figure>

<p>hook结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">----hooked gsNav----</span><br><span class="line">KeyInfo.gsNav is called: context=com.achievo.vipshop.common.VipApplicationLike@17ab95c, map=[object Object], str=null, z10=false</span><br><span class="line">gsNav map: &#123;app_name=achievo_ad, app_version=9.39.4, channel=yro8nr0d:::, device=Pixel 3, device_token=c6e072c0-ec5c-3fd4-8b3d-993abbdcb72a, manufacturer=Google, os_version=29, regPlat=0, regid=null, rom=Dalvik/2.1.0 (Linux; U; Android 10; Pixel 3 Build/QQ3A.200705.002), skey=6692c461c3810ab150c9a980d0c275ec, status=1, vipruid=, warehouse=VIP_HZ&#125;</span><br><span class="line">KeyInfo.gsNav result=a05a0d94df429a4cdc0d2cd68bce1291b046d667</span><br><span class="line">----hooked over!----</span><br></pre></td></tr></table></figure>

<h3 id="unidbg执行gsNav"><a href="#unidbg执行gsNav" class="headerlink" title="unidbg执行gsNav()"></a>unidbg执行gsNav()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">KeyInfo</span> <span class="keyword">extends</span> <span class="title class_">AbstractJni</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AndroidEmulator emulator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Memory memory;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VM vm;</span><br><span class="line">    <span class="keyword">private</span> DalvikModule dm;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">KeyInfo</span><span class="params">()</span> &#123;</span><br><span class="line">        emulator = AndroidEmulatorBuilder</span><br><span class="line">                .for64Bit() <span class="comment">// for32Bit()</span></span><br><span class="line">                .setRootDir(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;target/rootfs&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">        memory = emulator.getMemory();</span><br><span class="line">        memory.setLibraryResolver(<span class="keyword">new</span> <span class="title class_">AndroidResolver</span>(<span class="number">23</span>));</span><br><span class="line">        vm = emulator.createDalvikVM(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;unidbg-android/src/test/java/com/achievo/vipshop/weipinhui.apk&quot;</span>));</span><br><span class="line">        vm.setJni(<span class="built_in">this</span>);</span><br><span class="line">        vm.setVerbose(<span class="literal">true</span>);</span><br><span class="line">        dm = vm.loadLibrary(<span class="string">&quot;keyinfo&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        dm.callJNI_OnLoad(emulator);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">gsNav</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DvmClass</span> <span class="variable">KeyInfoClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.vip.vcsp.KeyInfo&quot;</span>);</span><br><span class="line"><span class="comment">//        DvmObject context = vm.resolveClass(&quot;android/app/Application&quot;,vm.resolveClass(&quot;android/content/ContextWrapper&quot;,vm.resolveClass(&quot;android/content/Context&quot;))).newObject(null);</span></span><br><span class="line">        <span class="type">DvmObject</span> <span class="variable">context</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;android/content/Context&quot;</span>).newObject(<span class="literal">null</span>);</span><br><span class="line">        Map&lt;String,String&gt; map = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;app_name&quot;</span>,<span class="string">&quot;achievo_ad&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;app_version&quot;</span>,<span class="string">&quot;9.39.4&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;channel&quot;</span>,<span class="string">&quot;yro8nr0d:::&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;device&quot;</span>,<span class="string">&quot;Pixel 3&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;device_token&quot;</span>,<span class="string">&quot;c6e072c0-ec5c-3fd4-8b3d-993abbdcb72a&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;manufacturer&quot;</span>,<span class="string">&quot;Google&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;os_version&quot;</span>,<span class="string">&quot;29&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;regPlat&quot;</span>,<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;regid&quot;</span>,<span class="string">&quot;null&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;rom&quot;</span>,<span class="string">&quot;Dalvik/2.1.0 (Linux; U; Android 10; Pixel 3 Build/QQ3A.200705.002)&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;skey&quot;</span>,<span class="string">&quot;6692c461c3810ab150c9a980d0c275ec&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;status&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;vipruid&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;warehouse&quot;</span>,<span class="string">&quot;VIP_HZ&quot;</span>);</span><br><span class="line">        <span class="type">DvmObject</span> <span class="variable">map_dvmobj</span> <span class="operator">=</span> ProxyDvmObject.createObject(vm,map);</span><br><span class="line">        <span class="type">StringObject</span> <span class="variable">stringObject</span> <span class="operator">=</span> KeyInfoClass.callStaticJniMethodObject(emulator,<span class="string">&quot;gsNav(Landroid/content/Context;Ljava/util/Map;Ljava/lang/String;Z)Ljava/lang/String;&quot;</span>,context,map_dvmobj,<span class="string">&quot;&quot;</span>,<span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> stringObject.getValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">KeyInfo</span> <span class="variable">keyInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KeyInfo</span>();</span><br><span class="line">        System.out.println(keyInfo.gsNav());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下，需要补环境</p>
<h4 id="补entrySet"><a href="#补entrySet" class="headerlink" title="补entrySet()"></a>补entrySet()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedOperationException: java/util/TreeMap-&gt;entrySet()Ljava/util/Set;</span><br><span class="line">	at com.github.unidbg.linux.android.dvm.AbstractJni.callObjectMethod(AbstractJni.java:933)</span><br></pre></td></tr></table></figure>

<p>补</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&quot;java/util/TreeMap-&gt;entrySet()Ljava/util/Set;&quot;</span>:&#123;</span><br><span class="line">    <span class="type">TreeMap</span> <span class="variable">map</span> <span class="operator">=</span> (TreeMap) dvmObject.getValue();</span><br><span class="line">    Set&lt;String&gt; set = map.entrySet();</span><br><span class="line">    <span class="keyword">return</span> ProxyDvmObject.createObject(vm,set);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下继续补环境</p>
<h4 id="补iterator"><a href="#补iterator" class="headerlink" title="补iterator()"></a>补iterator()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedOperationException: java/util/Set-&gt;iterator()Ljava/util/Iterator;</span><br><span class="line">	at com.github.unidbg.linux.android.dvm.AbstractJni.callObjectMethod(AbstractJni.java:933)</span><br></pre></td></tr></table></figure>

<p>补</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&quot;java/util/Set-&gt;iterator()Ljava/util/Iterator;&quot;</span>:&#123;</span><br><span class="line">    <span class="type">Set</span> <span class="variable">set</span> <span class="operator">=</span> (Set) dvmObject.getValue();</span><br><span class="line">    <span class="type">Iterator</span> <span class="variable">it</span> <span class="operator">=</span> set.iterator();</span><br><span class="line">    <span class="keyword">return</span> ProxyDvmObject.createObject(vm,it);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下继续补环境</p>
<h4 id="补hasNext"><a href="#补hasNext" class="headerlink" title="补hasNext()"></a>补hasNext()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedOperationException: java/util/Iterator-&gt;hasNext()Z</span><br><span class="line">	at com.github.unidbg.linux.android.dvm.AbstractJni.callBooleanMethod(AbstractJni.java:598)</span><br></pre></td></tr></table></figure>

<p>补</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">case &quot;java/util/Iterator-&gt;hasNext()Z&quot;:&#123;</span><br><span class="line">    Iterator it = (Iterator) dvmObject.getValue();</span><br><span class="line">    boolean hasNext = it.hasNext();</span><br><span class="line">    return hasNext;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下继续补环境</p>
<h4 id="补next"><a href="#补next" class="headerlink" title="补next()"></a>补next()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedOperationException: java/util/Iterator-&gt;next()Ljava/lang/Object;</span><br><span class="line">	at com.github.unidbg.linux.android.dvm.AbstractJni.callObjectMethod(AbstractJni.java:933)</span><br></pre></td></tr></table></figure>

<p>补</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">case &quot;java/util/Iterator-&gt;next()Ljava/lang/Object;&quot;:&#123;</span><br><span class="line">    Iterator iterator = (Iterator) dvmObject.getValue();</span><br><span class="line">    Object next = iterator.next();</span><br><span class="line">    return ProxyDvmObject.createObject(vm,next);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行一下继续补环境</p>
<h4 id="补getKey"><a href="#补getKey" class="headerlink" title="补getKey()"></a>补getKey()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedOperationException: java/util/Map$Entry-&gt;getKey()Ljava/lang/Object;</span><br><span class="line">	at com.github.unidbg.linux.android.dvm.AbstractJni.callObjectMethod(AbstractJni.java:933)</span><br></pre></td></tr></table></figure>

<p>补</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">case &quot;java/util/Map$Entry-&gt;getKey()Ljava/lang/Object;&quot;:&#123;</span><br><span class="line">    Map.Entry entry = (Map.Entry) dvmObject.getValue();</span><br><span class="line">    Object key = entry.getKey();</span><br><span class="line">    return ProxyDvmObject.createObject(vm,key);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="补getValue"><a href="#补getValue" class="headerlink" title="补getValue()"></a>补getValue()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedOperationException: java/util/Map$Entry-&gt;getValue()Ljava/lang/Object;</span><br><span class="line">	at com.github.unidbg.linux.android.dvm.AbstractJni.callObjectMethod(AbstractJni.java:933)</span><br></pre></td></tr></table></figure>

<p>补</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">&quot;java/util/Map$Entry-&gt;getValue()Ljava/lang/Object;&quot;</span>:&#123;</span><br><span class="line">    Map.<span class="type">Entry</span> <span class="variable">entry</span> <span class="operator">=</span> (Map.Entry) dvmObject.getValue();</span><br><span class="line">    <span class="type">Object</span> <span class="variable">value</span> <span class="operator">=</span> entry.getValue();</span><br><span class="line">    <span class="keyword">return</span> ProxyDvmObject.createObject(vm,value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="over"><a href="#over" class="headerlink" title="over"></a>over</h4><p>出结果了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a05a0d94df429a4cdc0d2cd68bce1291b046d667</span><br></pre></td></tr></table></figure>








      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/22/Flask/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/22/Flask/" class="post-title-link" itemprop="url">Flask</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-22 22:06:05" itemprop="dateCreated datePublished" datetime="2024-12-22T22:06:05+08:00">2024-12-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-12-23 15:43:58" itemprop="dateModified" datetime="2024-12-23T15:43:58+08:00">2024-12-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Flask安装"><a href="#Flask安装" class="headerlink" title="Flask安装"></a>Flask安装</h1><p>建议在Python虚拟环境中安装</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install flask</span><br></pre></td></tr></table></figure>

<h1 id="第一个Flask程序"><a href="#第一个Flask程序" class="headerlink" title="第一个Flask程序"></a>第一个Flask程序</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__) 	<span class="comment"># 创建一个 Flask 应用对象，赋值给变量 app。</span></span><br><span class="line">					  	<span class="comment"># 参数 __name__ 表示当前模块的名称，Flask 使用它来确定应用程序的根路径。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>) 		</span><span class="comment"># 装饰器，用于定义路由。&quot;/&quot; 是 URL 路径的根（即网站的首页）。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():		<span class="comment"># 处理 / 路由的视图函数。</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span> 	<span class="comment"># 视图函数的返回值是一个 HTML 字符串，表示返回给用户的内容。	</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>) <span class="comment"># 启动 Flask 的内置开发服务器，运行这个 Web 应用。</span></span><br><span class="line">    					<span class="comment"># 参数&#x27;debug=True&#x27;是开启调试模式，在代码有变更时，服务器会自动重启。</span></span><br></pre></td></tr></table></figure>

<p>在浏览器中访问<code>http://127.0.0.1:5000</code></p>
<h1 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h1><h2 id="route"><a href="#route" class="headerlink" title="route()"></a>route()</h2><p>使用<code>route()</code>装饰器来把函数绑定到 URL</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Index Page&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hello&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="路由参数"><a href="#路由参数" class="headerlink" title="路由参数"></a>路由参数</h2><h3 id="路由参数-1"><a href="#路由参数-1" class="headerlink" title="&lt;variable_name&gt;路由参数"></a><code>&lt;variable_name&gt;</code>路由参数</h3><p>通过<code>&lt;&gt;</code>标记的变量作为参数传递给函数。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/user/&lt;name&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;name is:&quot;</span>+name</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/22/Flask/1.jpg"></p>
<h3 id="converter-variable-name参数类型"><a href="#converter-variable-name参数类型" class="headerlink" title="converter:variable_name参数类型"></a><code>converter:variable_name</code>参数类型</h3><p>通过转换器<code>converter</code>为参数指定类型。默认类型为<code>string</code>即字符串。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/id/&lt;int:id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bandid</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;id is: &quot;</span>+<span class="built_in">str</span>(<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/22/Flask/2.jpg"></p>
<p><strong>转换器类型</strong></p>
<table>
<thead>
<tr>
<th align="left">converter</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">string</td>
<td>文本</td>
</tr>
<tr>
<td align="left">int</td>
<td>整数</td>
</tr>
<tr>
<td align="left">float</td>
<td>浮点数</td>
</tr>
<tr>
<td align="left">path</td>
<td>路径</td>
</tr>
<tr>
<td align="left">uuid</td>
<td>UUID字符串</td>
</tr>
</tbody></table>
<h1 id="请求方式"><a href="#请求方式" class="headerlink" title="请求方式"></a>请求方式</h1><p>通过定义路由来指定请求方式，Flask默认将路由处理为<code>GET</code>请求。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/hello&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello, World!&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/submit&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Data Submitted!&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="Jinja2模板引擎"><a href="#Jinja2模板引擎" class="headerlink" title="Jinja2模板引擎"></a>Jinja2模板引擎</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/22/%E5%85%B3%E4%BA%8Eptrace/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/22/%E5%85%B3%E4%BA%8Eptrace/" class="post-title-link" itemprop="url">关于ptrace</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-12-22 01:45:16 / 修改时间：02:02:26" itemprop="dateCreated datePublished" datetime="2024-12-22T01:45:16+08:00">2024-12-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">Android系统</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>919</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>&emsp;&emsp;<code>ptrace</code> 是一个系统调用，允许一个进程（父进程即调试器）观察和控制另一个进程（子进程即被调试的目标进程）。同时，它还能检查和改变目标进程的内存、寄存器和执行状态。这种机制广泛用于调试器和逆向分析工具。</p>
<h1 id="ptrace-函数原型"><a href="#ptrace-函数原型" class="headerlink" title="ptrace 函数原型"></a>ptrace 函数原型</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/ptrace.h&gt;</span></span></span><br><span class="line"><span class="type">long</span> <span class="title function_">ptrace</span><span class="params">(<span class="keyword">enum</span> __ptrace_request request, <span class="type">pid_t</span> pid, <span class="type">void</span> *addr, <span class="type">void</span> *data)</span>;</span><br></pre></td></tr></table></figure>

<p><strong><code>request</code></strong><br>指定执行的操作，决定了 <code>ptrace</code> 的具体功能，比如追踪进程、读取内存、单步执行等。常见值如下：</p>
<ul>
<li><code>PTRACE_TRACEME</code>：表示当前进程希望被其父进程调试。</li>
<li><code>PTRACE_ATTACH</code>：将当前进程附加到目标进程上。</li>
<li><code>PTRACE_CONT</code>：继续运行目标进程。</li>
<li><code>PTRACE_PEEKDATA</code>：读取目标进程的内存。</li>
<li><code>PTRACE_POKEDATA</code>：写入目标进程的内存。</li>
<li><code>PTRACE_SINGLESTEP</code>：让目标进程执行单条指令。</li>
<li><code>PTRACE_GETREGS</code> 和 <code>PTRACE_SETREGS</code>：获取或设置目标进程的寄存器。</li>
<li>其他值：具体见系统调用文档。</li>
</ul>
<p><strong><code>pid</code></strong><br>指定目标进程的 PID（进程 ID）。</p>
<p><strong><code>addr</code></strong><br>表示地址参数：</p>
<ul>
<li>对于内存相关操作（如 <code>PTRACE_PEEKDATA</code> 和 <code>PTRACE_POKEDATA</code>），这是目标进程的内存地址。</li>
<li>对于寄存器操作，可以忽略此参数。</li>
</ul>
<p><strong><code>data</code></strong><br>根据操作的不同，此参数可以用作输入或输出：</p>
<ul>
<li>用于传递写入目标进程的值。</li>
<li>保存读取到的数据（如寄存器内容）。</li>
</ul>
<p>&emsp;&emsp;当一个调试器（如 <code>gdb</code> 或自定义调试器）使用 <code>ptrace(PTRACE_ATTACH)</code> 附加到目标进程时，内核会更新目标进程的 <code>TracerPid</code> 字段，记录调试器的 PID。</p>
<h1 id="TracerPid"><a href="#TracerPid" class="headerlink" title="TracerPid"></a>TracerPid</h1><p>&emsp;&emsp;<code>/proc/&lt;pid&gt;/status</code> 文件中的 <code>TracerPid</code> 字段与 <code>ptrace</code> 密切相关，<code>TracerPid</code> 表示该进程的调试状态。</p>
<ul>
<li><p><code>TracerPid: 0</code> 表示当前进程没有被调试。</p>
</li>
<li><p><code>TracerPid: &lt;pid&gt;</code> 表示该进程正在被调试，且调试器的进程 ID 是 <code>&lt;pid&gt;</code>。</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/" class="post-title-link" itemprop="url">自毁程序密码—阿里聚安全</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-22 00:40:22" itemprop="dateCreated datePublished" datetime="2024-12-22T00:40:22+08:00">2024-12-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-11 20:06:16" itemprop="dateModified" datetime="2025-01-11T20:06:16+08:00">2025-01-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.yaotong.crackme</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/1.jpg"></p>
<h2 id="Java层分析"><a href="#Java层分析" class="headerlink" title="Java层分析"></a>Java层分析</h2><h3 id="MainActivity"><a href="#MainActivity" class="headerlink" title="MainActivity"></a>MainActivity</h3><p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/2.jpg"></p>
<p>很容易就能看出来是在securityCheck函数里进行安全校验。securityCheck是一个native函数，到so中进行分析。</p>
<h1 id="SO层分析"><a href="#SO层分析" class="headerlink" title="SO层分析"></a>SO层分析</h1><h2 id="定位函数位置"><a href="#定位函数位置" class="headerlink" title="定位函数位置"></a>定位函数位置</h2><p>在导出函数里搜索</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/3.jpg"></p>
<h2 id="securityCheck"><a href="#securityCheck" class="headerlink" title="securityCheck"></a>securityCheck</h2><p>数据类型修复和重命名后的securityCheck</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">Java_com_yaotong_crackme_MainActivity_securityCheck</span><span class="params">(JNIEnv *a1, jobject a2, <span class="type">char</span> *str)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *inputStr; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">char</span> *wojiushidaan; <span class="comment">// r2</span></span><br><span class="line">  <span class="type">int</span> tempResult; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// r1</span></span><br><span class="line">​</span><br><span class="line">  <span class="keyword">if</span> ( !byte_6359 )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_2494(byte_6304, <span class="number">8</span>, &amp;unk_446B, &amp;unk_4468, <span class="number">2</span>, <span class="number">7</span>);</span><br><span class="line">    byte_6359 = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( !byte_635A )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_24F4(byte_636C, <span class="number">25</span>, &amp;unk_4530, &amp;unk_4474, <span class="number">3</span>, <span class="number">117</span>);</span><br><span class="line">    byte_635A = <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  _android_log_print(<span class="number">4</span>, byte_6304, byte_636C);</span><br><span class="line">  inputStr = (*a1)-&gt;GetStringUTFChars(a1, str, <span class="number">0</span>);</span><br><span class="line">  wojiushidaan = off_628C;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    tempResult = *wojiushidaan;</span><br><span class="line">    <span class="keyword">if</span> ( tempResult != *inputStr )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++wojiushidaan;</span><br><span class="line">    ++inputStr;</span><br><span class="line">    v8 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> ( !tempResult )</span><br><span class="line">      <span class="keyword">return</span> v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="off-628C"><a href="#off-628C" class="headerlink" title="off_628C"></a>off_628C</h3><p>进入off_628C偏移查看，它的内容是”wojiushidaan”</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/4.jpg"></p>
<p>数据查看</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/5.jpg"></p>
<p>结合securityCheck函数分析，我觉得这就是正确答案了。</p>
<p>可是输入之后，还是校验失败。</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/6.jpg"></p>
<p>无奈只能动态调试</p>
<h1 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h1><p>IDA动态调试环境配置这里不再介绍。</p>
<h2 id="附加进程"><a href="#附加进程" class="headerlink" title="附加进程"></a>附加进程</h2><p>重新启动程序</p>
<p>在IDA里选择附加到进程</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/7.jpg"></p>
<p>附加进程之后，我们运行一下，会发现，程序崩了，IDA也崩了，说明这个so是有反调试的。</p>
<h2 id="反调试绕过"><a href="#反调试绕过" class="headerlink" title="反调试绕过"></a>反调试绕过</h2><p>猜测反调试是通过线程进行循环检测的。</p>
<p>打开线程窗口</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/8.jpg"></p>
<p>发现一个线程<code>yaotong.crackme</code>，有点可疑，右键这个线程，将状态改为suspend，暂停这个线程。</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/9.jpg"></p>
<p>然后运行，程序没有挂掉，可以进行调试。</p>
<h2 id="断点调试"><a href="#断点调试" class="headerlink" title="断点调试"></a>断点调试</h2><p>打开Modules窗口，找到libcrackme.so，双击进去，找到securityCheck函数，双击该函数跳转到函数的位置。</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/10.jpg"></p>
<p>在这个函数起始的位置下一个断点，将光标移动到断点位置，按下快捷键F，然后在输入框输入任意数据，点击输入密码，程序就会运行到断点位置。</p>
<p>F5查看反汇编，找到原来的变量偏移地址处，发现数据变了，变成了<code>aiyou,bucuoo</code></p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/11.jpg"></p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/12.jpg"></p>
<h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p>将<code>aiyou,bucuoo</code>放进输入框，点击输入密码，跳转到成功界面。</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/13.jpg"></p>
<h1 id="使用frida-hook内存"><a href="#使用frida-hook内存" class="headerlink" title="使用frida hook内存"></a>使用frida hook内存</h1><p>找到存储答案的变量的内存地址</p>
<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/14.jpg"></p>
<p>在程序启动之后，使用frida直接对内存进行hook</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_yaotong</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libcrackme.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> hookAddr = soAddr.<span class="title function_">add</span>(<span class="number">0x4450</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(hookAddr.<span class="title function_">readCString</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/15.jpg"></p>
<h1 id="使用unidbg模拟执行"><a href="#使用unidbg模拟执行" class="headerlink" title="使用unidbg模拟执行"></a>使用unidbg模拟执行</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yaotong.crackme;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.AndroidEmulator;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.Module;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.arm.backend.DynarmicFactory;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.linux.android.AndroidEmulatorBuilder;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.linux.android.AndroidResolver;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.linux.android.dvm.*;</span><br><span class="line"><span class="keyword">import</span> com.github.unidbg.memory.Memory;</span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AbstractJni</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AndroidEmulator emulator;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Memory memory;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> VM vm;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> DalvikModule dalvikModule;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Module <span class="keyword">module</span>;</span><br><span class="line"></span><br><span class="line">    MainActivity() &#123;</span><br><span class="line">        emulator = AndroidEmulatorBuilder.for32Bit().setProcessName(<span class="string">&quot;com.yaotong.crackme&quot;</span>).addBackendFactory(<span class="keyword">new</span> <span class="title class_">DynarmicFactory</span>(<span class="literal">true</span>)).build();</span><br><span class="line">        memory = emulator.getMemory();</span><br><span class="line">        memory.setLibraryResolver(<span class="keyword">new</span> <span class="title class_">AndroidResolver</span>(<span class="number">23</span>));</span><br><span class="line">        vm = emulator.createDalvikVM(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&quot;unidbg-android/src/test/java/com/yaotong/crackme/alijuanquan.apk&quot;</span>));</span><br><span class="line">        vm.setJni(<span class="built_in">this</span>);</span><br><span class="line">        vm.setVerbose(<span class="literal">true</span>);</span><br><span class="line">        dalvikModule = vm.loadLibrary(<span class="string">&quot;crackme&quot;</span>,<span class="literal">true</span>);</span><br><span class="line">        <span class="keyword">module</span> = dalvikModule.getModule();</span><br><span class="line">        vm.callJNI_OnLoad(emulator,<span class="keyword">module</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">MainActivity</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MainActivity</span>();</span><br><span class="line">        System.out.println(test.Check());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">Check</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DvmClass</span> <span class="variable">dvmClass</span> <span class="operator">=</span> vm.resolveClass(<span class="string">&quot;com.yaotong.crackme.MainActivity&quot;</span>);</span><br><span class="line">        <span class="type">DvmObject</span> <span class="variable">dvmObject</span> <span class="operator">=</span> dvmClass.newObject(<span class="literal">null</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">input</span> <span class="operator">=</span> <span class="string">&quot;aiyou,bucuoo&quot;</span>;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> dvmObject.callJniMethodBoolean(emulator,<span class="string">&quot;securityCheck(Ljava.lang.sring;)Z&quot;</span>,input);</span><br><span class="line">        System.out.println(<span class="string">&quot;result=&quot;</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><img src="/2024/12/22/%E8%87%AA%E6%AF%81%E7%A8%8B%E5%BA%8F%E5%AF%86%E7%A0%81%E2%80%94%E9%98%BF%E9%87%8C%E8%81%9A%E5%AE%89%E5%85%A8/16.jpg"></p>
<p>待完善…</p>
<p>参考文章：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/r-XXZQImgRc-Lce5B7x60w">https://mp.weixin.qq.com/s/r-XXZQImgRc-Lce5B7x60w</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/" class="post-title-link" itemprop="url">腾讯游戏安全移动赛题Tencent2016A</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-21 14:02:11" itemprop="dateCreated datePublished" datetime="2024-12-21T14:02:11+08:00">2024-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-12-22 00:44:48" itemprop="dateModified" datetime="2024-12-22T00:44:48+08:00">2024-12-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.tencent.tencent2016a</p>
<p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/1.jpg"></p>
<h1 id="Java层分析"><a href="#Java层分析" class="headerlink" title="Java层分析"></a>Java层分析</h1><h2 id="MainActivity"><a href="#MainActivity" class="headerlink" title="MainActivity"></a>MainActivity</h2><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/2.jpg"></p>
<h2 id="c"><a href="#c" class="headerlink" title="c"></a>c</h2><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/3.jpg"></p>
<h2 id="NativeCheckRegister"><a href="#NativeCheckRegister" class="headerlink" title="NativeCheckRegister"></a>NativeCheckRegister</h2><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/4.jpg"></p>
<h1 id="so分析"><a href="#so分析" class="headerlink" title="so分析"></a>so分析</h1><h2 id="定位NativeCheckRegister函数位置"><a href="#定位NativeCheckRegister函数位置" class="headerlink" title="定位NativeCheckRegister函数位置"></a>定位NativeCheckRegister函数位置</h2><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/5.jpg"></p>
<h2 id="NativeCheckRegister-1"><a href="#NativeCheckRegister-1" class="headerlink" title="NativeCheckRegister"></a>NativeCheckRegister</h2><p>类型修复及函数重命名之后的NativeCheckRegister函数如下</p>
<p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/6.jpg"></p>
<h2 id="check"><a href="#check" class="headerlink" title="check"></a>check</h2><p>类型修复及函数重命名后的check函数</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> __fastcall <span class="title function_">check</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *name, <span class="type">char</span> *code)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> namelength; <span class="comment">// r5</span></span><br><span class="line">  _BOOL4 result; <span class="comment">// r0</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// r4</span></span><br><span class="line">  _DWORD *nametempaddr; <span class="comment">// r7</span></span><br><span class="line">  <span class="type">int</span> nametempresult; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// r4</span></span><br><span class="line">  <span class="type">int</span> codetemp; <span class="comment">// r1</span></span><br><span class="line">  _DWORD nameresultarray[<span class="number">5</span>]; <span class="comment">// [sp+18h] [bp-458h] BYREF</span></span><br><span class="line">  _DWORD coderesultarray[<span class="number">5</span>]; <span class="comment">// [sp+2Ch] [bp-444h] BYREF</span></span><br><span class="line">  _BYTE namemix[<span class="number">20</span>]; <span class="comment">// [sp+40h] [bp-430h] BYREF</span></span><br><span class="line">  _BYTE codeResult[<span class="number">1052</span>]; <span class="comment">// [sp+54h] [bp-41Ch] BYREF</span></span><br><span class="line"></span><br><span class="line">  namelength = j_strlen(name);</span><br><span class="line">  <span class="keyword">if</span> ( (namelength - <span class="number">6</span>) &gt; <span class="number">0xE</span> )                 <span class="comment">// 校验name长度范围[6:20]</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  j_memset(namemix, <span class="number">0</span>, <span class="keyword">sizeof</span>(namemix));</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i != <span class="number">16</span>; ++i )                   <span class="comment">// 基于name生成一个混淆数据</span></span><br><span class="line">  &#123;</span><br><span class="line">    nametempaddr = &amp;namemix[i];</span><br><span class="line">    nametempresult = name[i % namelength] * (i + <span class="number">20160126</span>) * namelength;<span class="comment">// 基于 name 的字符生成一个与 name 相关的混淆数据，存入namemix</span></span><br><span class="line">    *nametempaddr += nametempresult;</span><br><span class="line">  &#125;</span><br><span class="line">  j_memset(codeResult, <span class="number">0</span>, <span class="number">0x400</span>u);</span><br><span class="line">  <span class="keyword">if</span> ( codeEnc1(code) &gt; <span class="number">1024</span> || codeEnc2(codeResult, code) != <span class="number">20</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  j_memset(nameresultarray, <span class="number">0</span>, <span class="keyword">sizeof</span>(nameresultarray));</span><br><span class="line">  j_memset(coderesultarray, <span class="number">0</span>, <span class="keyword">sizeof</span>(coderesultarray));</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j != <span class="number">5</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    codetemp = *&amp;codeResult[j * <span class="number">4</span>];</span><br><span class="line">    nameresultarray[j] = *&amp;namemix[j * <span class="number">4</span>] / <span class="number">10</span>;</span><br><span class="line">    coderesultarray[j] = codetemp;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( coderesultarray[<span class="number">4</span>] + nameresultarray[<span class="number">0</span>] == coderesultarray[<span class="number">2</span>]</span><br><span class="line">    &amp;&amp; coderesultarray[<span class="number">4</span>] + nameresultarray[<span class="number">0</span>] + nameresultarray[<span class="number">1</span>] == <span class="number">2</span> * coderesultarray[<span class="number">4</span>]</span><br><span class="line">    &amp;&amp; nameresultarray[<span class="number">2</span>] + coderesultarray[<span class="number">3</span>] == coderesultarray[<span class="number">0</span>]</span><br><span class="line">    &amp;&amp; nameresultarray[<span class="number">2</span>] + coderesultarray[<span class="number">3</span>] + nameresultarray[<span class="number">3</span>] == <span class="number">2</span> * coderesultarray[<span class="number">3</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">return</span> nameresultarray[<span class="number">4</span>] + coderesultarray[<span class="number">1</span>] == <span class="number">3</span> * nameresultarray[<span class="number">2</span>];  <span class="comment">// 返回值为1则验证成功</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>根据以上信息，当满足以下条件，程序验证成功</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">coderesultarray[4] + nameresultarray[0] == coderesultarray[2]</span><br><span class="line">coderesultarray[4] + nameresultarray[0] + nameresultarray[1] == 2 * coderesultarray[4]</span><br><span class="line">nameresultarray[2] + coderesultarray[3] == coderesultarray[0]</span><br><span class="line">nameresultarray[2] + coderesultarray[3] + nameresultarray[3] == 2 * coderesultarray[3]</span><br><span class="line">nameresultarray[4] + coderesultarray[1] == 3 * nameresultarray[2]</span><br></pre></td></tr></table></figure>

<p>变换，整理得到如下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">coderesultarray[4] + nameresultarray[0] == coderesultarray[2]</span><br><span class="line">nameresultarray[0] + nameresultarray[1] == coderesultarray[4]</span><br><span class="line">nameresultarray[2] + coderesultarray[3] == coderesultarray[0]</span><br><span class="line">nameresultarray[2] + nameresultarray[3] == coderesultarray[3]</span><br><span class="line">nameresultarray[4] + coderesultarray[1] == 3 * nameresultarray[2]</span><br></pre></td></tr></table></figure>

<p>由此可知：</p>
<ul>
<li>coderesultarray[0]可由nameresultarray[2]+nameresultarray[2]+nameresultarray[3]得到</li>
<li>coderesultarray[1]可由3 * nameresultarray[2]-nameresultarray[4]]得到</li>
<li>coderesultarray[2]可由nameresultarray[0] + nameresultarray[1]+nameresultarray[0]]得到</li>
<li>coderesultarray[3]可由nameresultarray[2] + nameresultarray[3]]得到</li>
<li>coderesultarray[4]可由nameresultarray[0] + nameresultarray[1]]得到</li>
</ul>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>由以上信息，我们可以知道，由<code>name-&gt;namemix-&gt;nameresultarray-&gt;coderesultarray</code></p>
<p>还知道<code>code-&gt;codeResult-&gt;coderesultarray</code></p>
<p>猜测可通过coderesultarray还原code</p>
<p>接下来分析code的两个处理函数codeEnc1和codeEnc2</p>
<h2 id="codeEnc1"><a href="#codeEnc1" class="headerlink" title="codeEnc1"></a>codeEnc1</h2><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/7.jpg"></p>
<h3 id="a456789"><a href="#a456789" class="headerlink" title="a456789"></a>a456789</h3><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/8.jpg"></p>
<p><strong>观察数据窗口</strong></p>
<p>发现末尾有一串Base64表，盲猜会出现Base64编码</p>
<p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/9.jpg"></p>
<p>经过分析，codeEnc1函数的功能是对输入的code进行校验，返回一个与字符串长度和规则相关的值，然后与1024进行比较。</p>
<h2 id="codeEnc2"><a href="#codeEnc2" class="headerlink" title="codeEnc2"></a>codeEnc2</h2><p>处理过后的codeEnc2函数如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">codeEnc2</span><span class="params">(<span class="type">char</span> *codeResult, <span class="type">char</span> *code)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *Cocode; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> Cocode_code; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// r2</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// r5</span></span><br><span class="line">  <span class="type">char</span> *codeResultTemp; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// r3</span></span><br><span class="line">  <span class="type">int</span> v8; <span class="comment">// r6</span></span><br><span class="line"></span><br><span class="line">  Cocode = code;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    ++Cocode;</span><br><span class="line">  <span class="keyword">while</span> ( a456789[*(Cocode - <span class="number">1</span>)] &lt;= <span class="number">63u</span> );</span><br><span class="line">  Cocode_code = Cocode - code;                  <span class="comment">// Cocode_code是Cocode-code</span></span><br><span class="line">  v4 = Cocode_code - <span class="number">1</span>;</span><br><span class="line">  v5 = <span class="number">3</span> * ((Cocode_code + <span class="number">2</span>) / <span class="number">4</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    codeResultTemp = codeResult;</span><br><span class="line">    <span class="keyword">if</span> ( v4 &lt;= <span class="number">4</span> )                              <span class="comment">// 判断剩余字符是否小于4字节</span></span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v4 -= <span class="number">4</span>;</span><br><span class="line">    *codeResult = (a456789[code[<span class="number">1</span>]] &gt;&gt; <span class="number">4</span>) | (<span class="number">4</span> * a456789[*code]);</span><br><span class="line">    codeResult[<span class="number">1</span>] = (a456789[code[<span class="number">2</span>]] &gt;&gt; <span class="number">2</span>) | (<span class="number">16</span> * a456789[code[<span class="number">1</span>]]);</span><br><span class="line">    v7 = code[<span class="number">2</span>];</span><br><span class="line">    v8 = code[<span class="number">3</span>];</span><br><span class="line">    code += <span class="number">4</span>;</span><br><span class="line">    codeResult[<span class="number">2</span>] = (a456789[v7] &lt;&lt; <span class="number">6</span>) | a456789[v8];</span><br><span class="line">    codeResult += <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 &gt; <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    *codeResult = (a456789[code[<span class="number">1</span>]] &gt;&gt; <span class="number">4</span>) | (<span class="number">4</span> * a456789[*code]);</span><br><span class="line">    <span class="keyword">if</span> ( v4 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      codeResultTemp = codeResult + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      codeResult[<span class="number">1</span>] = (a456789[code[<span class="number">2</span>]] &gt;&gt; <span class="number">2</span>) | (<span class="number">16</span> * a456789[code[<span class="number">1</span>]]);</span><br><span class="line">      <span class="keyword">if</span> ( v4 == <span class="number">4</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        codeResultTemp = codeResult + <span class="number">3</span>;</span><br><span class="line">        codeResult[<span class="number">2</span>] = (a456789[code[<span class="number">2</span>]] &lt;&lt; <span class="number">6</span>) | a456789[code[<span class="number">3</span>]];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        codeResultTemp = codeResult + <span class="number">2</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;                                             <span class="comment">// 自实现过Base64编码的人在这里就不难看出来这里是Base64解码算法</span></span><br><span class="line">  *codeResultTemp = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v5 - (-v4 &amp; <span class="number">3</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是一个Base64解码算法</p>
<h3 id="hook验证"><a href="#hook验证" class="headerlink" title="hook验证"></a>hook验证</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_native</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> soAddr = <span class="title class_">Module</span>.<span class="title function_">findBaseAddress</span>(<span class="string">&quot;libCheckRegister.so&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> codeEnc2 = soAddr.<span class="title function_">add</span>(<span class="number">0x1499</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(codeEnc2)</span><br><span class="line">    <span class="title class_">Memory</span>.<span class="title function_">protect</span>(codeEnc2, <span class="number">0x1000</span>, <span class="string">&#x27;rwx&#x27;</span>);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(codeEnc2,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg0:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">0</span>]));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;arg1:&quot;</span>,<span class="title function_">hexdump</span>(args[<span class="number">1</span>]));</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">codeResult</span> = args[<span class="number">0</span>];</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;codeResult:&quot;</span>,<span class="title function_">hexdump</span>(<span class="variable language_">this</span>.<span class="property">codeResult</span>));</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ret:&quot;</span>,ret)</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">ret</span>=<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_native</span>()</span><br></pre></td></tr></table></figure>

<p><strong>输出</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">arg0:            </span><br><span class="line">0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">ffdc62f4  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ffdc6304  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ffdc6314  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">arg1:</span><br><span class="line">0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">deb247a0  31 32 33 34 35 36 37 38 00 00 00 00 00 00 00 00  12345678........</span><br><span class="line">deb247b0  00 00 00 00 28 00 00 00 00 00 00 00 00 00 00 00  ....(...........</span><br><span class="line">codeResult: </span><br><span class="line">0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF</span><br><span class="line">ffdc62f4  d7 6d f8 e7 ae fc 00 00 00 00 00 00 00 00 00 00  .m..............</span><br><span class="line">ffdc6304  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ffdc6314  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................</span><br><span class="line">ret: 0x6</span><br></pre></td></tr></table></figure>

<p>如下证明codeEnc2是标准的Base64解码算法</p>
<p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/10.jpg"></p>
<h2 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h2><p>这里弄明白了，code经过Base64解码得到codeResult，codeResult部分数据经过Base64解码得到coderesultarray。</p>
<h3 id="重新捋一遍流程"><a href="#重新捋一遍流程" class="headerlink" title="重新捋一遍流程"></a>重新捋一遍流程</h3><p>首先，我们输入name，name经过混淆得到namemix，namemix的前20字节经过处理得到nameresultarray，然后由nameresultarray推导出coderesultarray，coderesultarray经过Base64编码得到code。</p>
<h1 id="C-还原"><a href="#C-还原" class="headerlink" title="C++还原"></a>C++还原</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义 Base64 编码字符表</span></span><br><span class="line">string base64_chars =</span><br><span class="line">        <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">        <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">        <span class="string">&quot;0123456789+/&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Base64 编码函数，将字节数组编码为 Base64 格式的字符串</span></span><br><span class="line"><span class="function">string <span class="title">base64_encode</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* bytes_to_encode, <span class="type">unsigned</span> <span class="type">int</span> in_len)</span> </span>&#123;</span><br><span class="line">    std::string ret; <span class="comment">// 存储编码后的结果</span></span><br><span class="line">    <span class="type">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> char_array_3[<span class="number">3</span>]; <span class="comment">// 临时存储3个字节</span></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> char_array_4[<span class="number">4</span>]; <span class="comment">// 临时存储4个编码后的字符</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理输入数据，3个字节一组进行编码</span></span><br><span class="line">    <span class="keyword">while</span> (in_len--) &#123;</span><br><span class="line">        char_array_3[i++] = *(bytes_to_encode++);</span><br><span class="line">        <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="comment">// 将3个字节转换为4个6位的Base64字符索引</span></span><br><span class="line">            char_array_4[<span class="number">0</span>] = (char_array_3[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">            char_array_4[<span class="number">1</span>] = ((char_array_3[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((char_array_3[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">            char_array_4[<span class="number">2</span>] = ((char_array_3[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>) + ((char_array_3[<span class="number">2</span>] &amp; <span class="number">0xc0</span>) &gt;&gt; <span class="number">6</span>);</span><br><span class="line">            char_array_4[<span class="number">3</span>] = char_array_3[<span class="number">2</span>] &amp; <span class="number">0x3f</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 根据索引从Base64字符表中获取字符</span></span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">0</span>; (i &lt; <span class="number">4</span>); i++)</span><br><span class="line">                ret += base64_chars[char_array_4[i]];</span><br><span class="line">            i = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 处理剩余的不足3字节的数据</span></span><br><span class="line">    <span class="keyword">if</span> (i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = i; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">            char_array_3[j] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// 用\0填充</span></span><br><span class="line"></span><br><span class="line">        char_array_4[<span class="number">0</span>] = (char_array_3[<span class="number">0</span>] &amp; <span class="number">0xfc</span>) &gt;&gt; <span class="number">2</span>;</span><br><span class="line">        char_array_4[<span class="number">1</span>] = ((char_array_3[<span class="number">0</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">4</span>) + ((char_array_3[<span class="number">1</span>] &amp; <span class="number">0xf0</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        char_array_4[<span class="number">2</span>] = ((char_array_3[<span class="number">1</span>] &amp; <span class="number">0x0f</span>) &lt;&lt; <span class="number">2</span>) + ((char_array_3[<span class="number">2</span>] &amp; <span class="number">0xc0</span>) &gt;&gt; <span class="number">6</span>);</span><br><span class="line">        char_array_4[<span class="number">3</span>] = char_array_3[<span class="number">2</span>] &amp; <span class="number">0x3f</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; (j &lt; i + <span class="number">1</span>); j++)</span><br><span class="line">            ret += base64_chars[char_array_4[j]];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> ((i++ &lt; <span class="number">3</span>))</span><br><span class="line">            ret += <span class="string">&#x27;=&#x27;</span>; <span class="comment">// 用=填充</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">char</span> name[<span class="number">20</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">// 用于存储用户输入的姓名</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please input name:&quot;</span>);</span><br><span class="line">    cin &gt;&gt; name; <span class="comment">// 输入姓名</span></span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> namelength = <span class="built_in">strlen</span>(name); <span class="comment">// 计算姓名长度</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;namelength:&quot;</span> &lt;&lt; namelength &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="type">char</span>* temppointer = <span class="literal">NULL</span>; <span class="comment">// 临时指针</span></span><br><span class="line">    <span class="type">int</span> namemix[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;; <span class="comment">// 混淆后的结果数组</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 生成混淆数据</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">        temppointer = (<span class="type">char</span>*)namemix + i; <span class="comment">// 将指针指向namemix数组中的第i字节</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据姓名字符和索引计算一个混淆数</span></span><br><span class="line">        <span class="type">int</span> tempnumber = name[i % namelength] * (i + <span class="number">20160126</span>) * namelength;</span><br><span class="line"></span><br><span class="line">        *(<span class="type">int</span>*)temppointer += tempnumber; <span class="comment">// 将计算结果写入对应位置</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出混淆数据</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; &quot;namemix:&quot; &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i != <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; namemix[i] &lt;&lt; endl;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 对混淆数据进一步处理，生成结果数组</span></span><br><span class="line">    <span class="type">int</span> nameresultarray[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        nameresultarray[i] = namemix[i] / <span class="number">10</span>; <span class="comment">// 每个值缩小10倍</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出结果数组</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; &quot;nameresultarrat&quot; &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="comment">//cout &lt;&lt; nameresultarray[i] &lt;&lt; endl;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据结果数组生成编码数组</span></span><br><span class="line">    <span class="type">int</span> coderesultarray[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    coderesultarray[<span class="number">0</span>] = nameresultarray[<span class="number">2</span>] + nameresultarray[<span class="number">2</span>] + nameresultarray[<span class="number">3</span>];</span><br><span class="line">    coderesultarray[<span class="number">1</span>] = <span class="number">3</span> * nameresultarray[<span class="number">2</span>] - nameresultarray[<span class="number">4</span>];</span><br><span class="line">    coderesultarray[<span class="number">2</span>] = nameresultarray[<span class="number">0</span>] + nameresultarray[<span class="number">1</span>] + nameresultarray[<span class="number">0</span>];</span><br><span class="line">    coderesultarray[<span class="number">3</span>] = nameresultarray[<span class="number">2</span>] + nameresultarray[<span class="number">3</span>];</span><br><span class="line">    coderesultarray[<span class="number">4</span>] = nameresultarray[<span class="number">0</span>] + nameresultarray[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出编码数组</span></span><br><span class="line">    <span class="comment">//cout &lt;&lt; &quot;coderesultarray:&quot; &lt;&lt; endl;</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// 输出为16进制格式</span></span><br><span class="line">        <span class="comment">//printf(&quot;%x\n&quot;, coderesultarray[i]);</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用 Base64 对编码数组进行编码</span></span><br><span class="line">    string encodeStr = <span class="built_in">base64_encode</span>((<span class="type">unsigned</span> <span class="type">char</span>*)coderesultarray, <span class="number">20</span>);</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Code is :&quot;</span> &lt;&lt; encodeStr;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="验证成功"><a href="#验证成功" class="headerlink" title="验证成功"></a>验证成功</h2><p><img src="/2024/12/21/%E8%85%BE%E8%AE%AF%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8%E7%A7%BB%E5%8A%A8%E8%B5%9B%E9%A2%98Tencent2016A/11.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/20/FRIDA-JSAPI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/20/FRIDA-JSAPI/" class="post-title-link" itemprop="url">FRIDA-JSAPI</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-20 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-20T00:00:00+08:00">2024-12-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-13 17:45:24" itemprop="dateModified" datetime="2025-03-13T17:45:24+08:00">2025-03-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Frida/" itemprop="url" rel="index"><span itemprop="name">Frida</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h2 id="perform"><a href="#perform" class="headerlink" title="perform()"></a>perform()</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is Java.perform!&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="use-className"><a href="#use-className" class="headerlink" title="use(className)"></a>use(className)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is Java.perform!&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">class</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(className);</span><br><span class="line">    <span class="keyword">class</span>.<span class="property">method</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is class.method!&quot;</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Java-choose-className-callbacks"><a href="#Java-choose-className-callbacks" class="headerlink" title="Java.choose(className, callbacks)"></a>Java.choose(className, callbacks)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">choose</span>(<span class="string">&quot;com.example.SomeClass&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span>(<span class="params">instance</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;找到一个实例: &quot;</span> + instance);</span><br><span class="line">            <span class="comment">// 可以在这里对 instance 进行操作，比如调用其方法或修改属性</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;实例枚举完成！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Java-enumerateLoadedClasses-callbacks"><a href="#Java-enumerateLoadedClasses-callbacks" class="headerlink" title="Java.enumerateLoadedClasses(callbacks)"></a>Java.enumerateLoadedClasses(callbacks)</h2><p>枚举已加载的类</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClasses</span>(&#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">className</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Loaded class: &quot;</span> + className);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Class enumeration complete&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Java-enumerateLoadedClassesSync"><a href="#Java-enumerateLoadedClassesSync" class="headerlink" title="Java.enumerateLoadedClassesSync()"></a>Java.enumerateLoadedClassesSync()</h2><p>枚举当前 Java 虚拟机中已经加载的所有类，返回一个包含所有类名的数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 获取所有已加载的类</span></span><br><span class="line">    <span class="keyword">var</span> loadedClasses = <span class="title class_">Java</span>.<span class="title function_">enumerateLoadedClassesSync</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 输出所有类名</span></span><br><span class="line">    loadedClasses.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">className</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(className);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Java-enumerateClassLoaders-callbacks"><a href="#Java-enumerateClassLoaders-callbacks" class="headerlink" title="Java.enumerateClassLoaders(callbacks)"></a>Java.enumerateClassLoaders(callbacks)</h2><p>枚举所有的类加载器</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoaders</span>(&#123;</span><br><span class="line">        <span class="attr">onMatch</span>: <span class="keyword">function</span> (<span class="params">loader</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Found ClassLoader: &quot;</span> + loader);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onComplete</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ClassLoader enumeration complete&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Java-enumerateClassLoadersSync"><a href="#Java-enumerateClassLoadersSync" class="headerlink" title="Java.enumerateClassLoadersSync()"></a>Java.enumerateClassLoadersSync()</h2><p>枚举当前 Java 虚拟机中所有活跃的类加载器（ClassLoader）实例，返回一个数组。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 枚举所有已加载的类加载器</span></span><br><span class="line">    <span class="keyword">var</span> classLoaders = <span class="title class_">Java</span>.<span class="title function_">enumerateClassLoadersSync</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历并输出每个类加载器的信息</span></span><br><span class="line">    classLoaders.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">classLoader, index</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;ClassLoader[&quot;</span> + index + <span class="string">&quot;]: &quot;</span> + classLoader);</span><br><span class="line">        <span class="comment">// 如果需要，可以调用 classLoader 的方法，或者进一步分析其属性</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="Java-enumerateMethods-query"><a href="#Java-enumerateMethods-query" class="headerlink" title="Java.enumerateMethods(query)"></a>Java.enumerateMethods(query)</h2><p>根据 <code>query</code> 参数筛选符合特定名称模式的类，并返回这些类中的所有方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">enumerateMethods</span>(query)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params">methods</span>) &#123;</span><br><span class="line">        <span class="comment">// 处理返回的 methods 数组</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">error</span>(error);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="cast-object-targetClass"><a href="#cast-object-targetClass" class="headerlink" title="cast(object, targetClass)"></a>cast(object, targetClass)</h2><p>将一个 Java 对象转换为特定的类类型。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">MainActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.app.MainActivity&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> someObject = <span class="title class_">MainActivity</span>.<span class="title function_">getSomeObject</span>(); <span class="comment">// 返回类型可能是 Object</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;原始类型: &quot;</span> + someObject.<span class="property">$className</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 强制转换为 MyClass</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">MyClass</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.example.app.MyClass&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> castedObject = <span class="title class_">Java</span>.<span class="title function_">cast</span>(someObject, <span class="title class_">MyClass</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;转换后类型: &quot;</span> + castedObject.<span class="property">$className</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 现在可以调用 MyClass 的方法</span></span><br><span class="line">    castedObject.<span class="title function_">someMethod</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="classFactory"><a href="#classFactory" class="headerlink" title="classFactory"></a>classFactory</h2><p>Frida 中用于操作 Java 类的一个工厂类，它提供了一系列方法来与 Java 类进行交互。默认情况下，<code>Java.ClassFactory</code> 使用应用程序的主类加载器，但也可以通过指定其他类加载器来创建不同的类工厂实例。</p>
<h3 id="loader"><a href="#loader" class="headerlink" title="loader"></a>loader</h3><p>当前的类加载器。<code>Java.use()</code> 依赖它来 Hook Java 类。</p>
<h2 id="array"><a href="#array" class="headerlink" title="array()"></a>array()</h2><p>用于动态创建 Java 数组对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Java.array(type, elements)</span><br></pre></td></tr></table></figure>



<h1 id="Process"><a href="#Process" class="headerlink" title="Process"></a>Process</h1><h2 id="pointerSize"><a href="#pointerSize" class="headerlink" title="pointerSize"></a>pointerSize</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Process.pointerSize</span><br></pre></td></tr></table></figure>

<p>以字节为单位获取指针的大小。</p>
<h2 id="getCurrentThreadId"><a href="#getCurrentThreadId" class="headerlink" title="getCurrentThreadId()"></a>getCurrentThreadId()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Process.getCurrentThreadId()</span><br></pre></td></tr></table></figure>

<p>获取当前线程Id。</p>
<h2 id="findModuleByName-name"><a href="#findModuleByName-name" class="headerlink" title="findModuleByName(name)"></a>findModuleByName(name)</h2><p>根据模块名称查找并返回对应的模块对象。</p>
<p>如果没有找到匹配的模块，则返回一个空值（根据具体实现，可能是 <code>null</code> 或 <code>undefined</code>）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Process.findModuleByName(name)</span><br></pre></td></tr></table></figure>

<h1 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h1><h2 id="Module属性"><a href="#Module属性" class="headerlink" title="Module属性"></a>Module属性</h2><ul>
<li><p><strong>name</strong></p>
<p>  模块名</p>
</li>
<li><p><strong>base</strong></p>
<p>  模块基地址</p>
</li>
<li><p><strong>size</strong></p>
<p>  模块的字节大小</p>
</li>
<li><p><strong>path</strong></p>
<p>  模块的路径</p>
</li>
</ul>
<h2 id="enumerateSymbols"><a href="#enumerateSymbols" class="headerlink" title="enumerateSymbols()"></a>enumerateSymbols()</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var symbols = ModuleName.enumerateSymbols()</span><br></pre></td></tr></table></figure>

<p>枚举指定模块中的所以符号。</p>
<h3 id="枚举的符号symbol的属性"><a href="#枚举的符号symbol的属性" class="headerlink" title="枚举的符号symbol的属性"></a>枚举的符号symbol的属性</h3><ul>
<li><p><strong>isGlobal</strong></p>
</li>
<li><p><strong>type</strong></p>
</li>
<li><p><strong>section</strong></p>
</li>
<li><p><strong>name</strong></p>
<p>  符号的名字</p>
</li>
<li><p><strong>address</strong></p>
<p>  符号的地址，指针</p>
</li>
<li><p><strong>size</strong></p>
</li>
</ul>
<h2 id="findExportByName-exportName"><a href="#findExportByName-exportName" class="headerlink" title="findExportByName(exportName)"></a>findExportByName(exportName)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var addr = Module.findExportByName(moduleName|null,exportName)</span><br></pre></td></tr></table></figure>

<p>查找指定模块中导出的符号（通常是函数）的地址。</p>
<h2 id="findBaseAddress-name"><a href="#findBaseAddress-name" class="headerlink" title="findBaseAddress(name)"></a>findBaseAddress(name)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var addr = Module.findBaseAddress(name)</span><br></pre></td></tr></table></figure>

<p>获取指定模块的基地址。</p>
<h1 id="Memory"><a href="#Memory" class="headerlink" title="Memory"></a>Memory</h1><h2 id="protect-address-size-protection"><a href="#protect-address-size-protection" class="headerlink" title="protect(address, size, protection)"></a>protect(address, size, protection)</h2><p>更新一块内存区域的保护属性，其中 <code>protection</code> 是一个字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Memory</span>.<span class="title function_">protect</span>(address,size,<span class="string">&#x27;rwx&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="alloc-size"><a href="#alloc-size" class="headerlink" title="alloc(size)"></a>alloc(size)</h2><p>在目标进程的内存中分配一块指定大小的内存。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ptr = <span class="title class_">Memory</span>.<span class="title function_">alloc</span>(size);</span><br></pre></td></tr></table></figure>



<h2 id="allocUtf8String-str"><a href="#allocUtf8String-str" class="headerlink" title="allocUtf8String(str)"></a>allocUtf8String(str)</h2><p>在目标进程的内存中分配一段 UTF-8 编码的字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ptr = <span class="title class_">Memory</span>.<span class="title function_">allocUtf8String</span>(str);</span><br></pre></td></tr></table></figure>



<h1 id="Native"><a href="#Native" class="headerlink" title="Native"></a>Native</h1><h2 id="NativePointer"><a href="#NativePointer" class="headerlink" title="NativePointer"></a>NativePointer</h2><h3 id="new-NativePointer-s"><a href="#new-NativePointer-s" class="headerlink" title="new NativePointer(s)"></a>new NativePointer(s)</h3><p>从包含内存地址的字符串 s 创建一个新的 NativePointer 对象。</p>
<p>字符串可以是十进制的，也可以是以 0x 开头的十六进制表示。</p>
<h3 id="ptr-s"><a href="#ptr-s" class="headerlink" title="ptr(s)"></a>ptr(s)</h3><p>NativePointer 对象也可以通过ptr(s)这种简写方式进行创建。</p>
<h3 id="toInt32"><a href="#toInt32" class="headerlink" title="toInt32()"></a>toInt32()</h3><p>将当前 NativePointer 转换为有符号的 32 位整数。</p>
<h3 id="add-rhs-sub-rhs-and-rhs-or-rhs-xor-rhs"><a href="#add-rhs-sub-rhs-and-rhs-or-rhs-xor-rhs" class="headerlink" title="add(rhs), sub(rhs), and(rhs), or(rhs), xor(rhs)"></a>add(rhs), sub(rhs), and(rhs), or(rhs), xor(rhs)</h3><p>创建一个新的 <strong>NativePointer</strong>，它是将当前的 <strong>NativePointer</strong> 与 <code>rhs</code> 相加、相减、按位与、按位或或按位异或后的结果，其中 <code>rhs</code> 可以是一个数字或另一个 <strong>NativePointer</strong>。</p>
<h3 id="readCString-size-1"><a href="#readCString-size-1" class="headerlink" title="readCString([size &#x3D; -1])"></a>readCString([size &#x3D; -1])</h3><p>从当前内存位置读取 ASCII字符串的字节。如果知道字符串的字节数，可以提供可选的 size 参数；如果字符串以 NULL 结尾，可以省略该参数或指定为 -1。</p>
<p>如果地址中读取的任何 size &#x2F; length 字节不可读，将抛出一个 JavaScript 异常。</p>
<h2 id="NativeFunction"><a href="#NativeFunction" class="headerlink" title="NativeFunction"></a>NativeFunction</h2><ul>
<li><p><strong>new NativeFunction(address, returnType, argTypes)</strong></p>
<ul>
<li><code>address</code>：用<code>NativePointer</code>指定的函数地址。</li>
<li><code>returnType</code>：指定返回值类型。</li>
<li><code>argTypes</code>：一个数组，指定参数类型。</li>
</ul>
  <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">FunctionName</span> = <span class="keyword">new</span> <span class="title class_">NativeFunction</span>(functionAddr, <span class="string">&quot;int&quot;</span>, [<span class="string">&quot;pointer&quot;</span>, <span class="string">&quot;pointer&quot;</span>, <span class="string">&quot;pointer&quot;</span>, <span class="string">&quot;pointer&quot;</span>]);</span><br></pre></td></tr></table></figure></li>
</ul>
<p><code>NativeFunction</code> 用于调用目标进程中指定内存地址处的原生函数。</p>
<h2 id="NativeCallback"><a href="#NativeCallback" class="headerlink" title="NativeCallback"></a>NativeCallback</h2><ul>
<li><p><strong>new NativeCallback(func, returnType, argTypes)</strong></p>
<ul>
<li><code>func</code>: 创建一个新的由JavaScript function实现的NativeCallback</li>
<li><code>returnType</code>: 指定返回类型。</li>
<li><code>argTypes</code>: 数组，指定参数类型。</li>
</ul>
<p>返回的对象是<code>NativeFunction</code>，可以传递给<code>Interceptor.replace</code>。</p>
</li>
</ul>
<p><code>NativeCallback</code> 用于在目标进程中创建一个自定义的原生函数（回调函数），以便在目标进程的上下文中被调用，它的主要用途是模拟或替换目标函数的实现。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(functionAddr, <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is a NativeCallback!&quot;</span>)</span><br><span class="line">&#125;, <span class="string">&quot;void&quot;</span>, []))</span><br></pre></td></tr></table></figure>



<h1 id="Interceptor"><a href="#Interceptor" class="headerlink" title="Interceptor"></a>Interceptor</h1><h2 id="Interceptor-attach-target-callbacks"><a href="#Interceptor-attach-target-callbacks" class="headerlink" title="Interceptor.attach(target, callbacks)"></a>Interceptor.attach(target, callbacks)</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> functionAddr = <span class="title function_">ptr</span>(<span class="number">0x7777</span>);</span><br><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(functionAddr,&#123;</span><br><span class="line">    <span class="title class_">OnEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(args[<span class="number">1</span>]);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(args[<span class="number">2</span>]);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title class_">OnLeave</span>:<span class="keyword">function</span>(<span class="params">ret</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ret);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>注意：在32位ARM架构中，地址参数target的最低有效位必须为0（对于ARM函数）或1（对于Thumb函数）。如果通过Frida API（例如Module.getExportByName()）获取地址，Frida会自动处理这个细节。</p>
<h2 id="Interceptor-replace-target-replacement"><a href="#Interceptor-replace-target-replacement" class="headerlink" title="Interceptor.replace(target, replacement)"></a>Interceptor.replace(target, replacement)</h2><p>使用 replacement 替换 target 处的函数。<br>可以使用 NativeCallback 在 JavaScript 中实现替换。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(functionAddr, <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;This is a NativeCallback!&quot;</span>)</span><br><span class="line">&#125;, <span class="string">&quot;void&quot;</span>, []))</span><br></pre></td></tr></table></figure>

<h1 id="Stalker"><a href="#Stalker" class="headerlink" title="Stalker"></a>Stalker</h1><p>Stalker是基于动态重新编译的代码跟踪器。 它将代码指令复制到内存中的另一个位置，在该位置对其进行调整以适应新位置并包括其他跟踪指令。 如果应用程序在原始位置检查其代码，则会发现该代码是完整无缺的，因为它是被篡改的代码的副本。</p>
<h2 id="follow"><a href="#follow" class="headerlink" title="follow()"></a>follow()</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Stalker</span>.<span class="title function_">follow</span>(threadId, options);</span><br><span class="line"><span class="comment">// threadId 要追踪的线程 ID。可通过 Process.getCurrentThreadId() 或其他方式获取目标线程 ID。</span></span><br><span class="line"><span class="comment">// options 一个对象，用于配置追踪时的行为。</span></span><br></pre></td></tr></table></figure>

<p>Frida 对目标线程进行监控，捕获它执行过程中发生的事件（例如函数调用、返回、基本块边界等），从而进行动态分析、调试或者行为记录。</p>
<h3 id="options详解"><a href="#options详解" class="headerlink" title="options详解"></a>options详解</h3><p><code>options</code> 参数是一个对象，可以配置多种选项来控制跟踪行为。</p>
<p><code>options</code> 参数的详细说明：</p>
<h4 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h4><p>自定义代码转换函数，允许对跟踪的代码进行动态修改（如插入日志、过滤指令等）。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Stalker</span>.<span class="title function_">follow</span>(tid, &#123;</span><br><span class="line">    <span class="attr">transform</span>: <span class="keyword">function</span>(<span class="params">iterator</span>) &#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="keyword">const</span> instruction = iterator.<span class="title function_">next</span>()</span><br><span class="line">            <span class="keyword">if</span> (instruction === <span class="literal">null</span>)&#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            iterator.<span class="title function_">keep</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>优化版本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Stalker</span>.<span class="title function_">follow</span>(tid, &#123;</span><br><span class="line">    <span class="attr">transform</span>: <span class="keyword">function</span>(<span class="params">iterator</span>) &#123;</span><br><span class="line">        <span class="comment">// 使用 while 循环，直接判断 iterator.next() 的返回值</span></span><br><span class="line">        <span class="keyword">let</span> instruction;</span><br><span class="line">        <span class="keyword">while</span> ((instruction = iterator.<span class="title function_">next</span>()) !== <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 对每条指令执行保留操作，不进行修改</span></span><br><span class="line">            iterator.<span class="title function_">keep</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="unfollow"><a href="#unfollow" class="headerlink" title="unfollow()"></a>unfollow()</h2><p>终止在该线程上通过 <code>Stalker.follow()</code> 启动的追踪操作。</p>
<h2 id="flush"><a href="#flush" class="headerlink" title="flush()"></a>flush()</h2><p>刷新缓冲区。</p>
<h2 id="garbageCollect"><a href="#garbageCollect" class="headerlink" title="garbageCollect()"></a>garbageCollect()</h2><p>用于垃圾回收和清理资源，释放由 Stalker 模块在追踪过程中使用的内存和系统资源。</p>
<h1 id="CPU-Instruction"><a href="#CPU-Instruction" class="headerlink" title="CPU Instruction"></a>CPU Instruction</h1><h2 id="Instruction"><a href="#Instruction" class="headerlink" title="Instruction"></a>Instruction</h2><h3 id="Instruction-parse-target"><a href="#Instruction-parse-target" class="headerlink" title="Instruction.parse(target)"></a>Instruction.parse(target)</h3><p>解析内存中 target 地址处的指令，返回一个<code>Instruction</code>对象。</p>
<p><code>Instruction</code>对象包含如下字段：</p>
<ul>
<li><code>address</code>: 此指令的地址（EIP），类型为 <code>NativePointer</code></li>
<li><code>next</code>: 指向下一条指令的指针，您可以使用 <code>parse()</code> 解析它</li>
<li><code>size</code>: 此指令的大小</li>
<li><code>mnemonic</code>: 指令助记符的字符串表示</li>
<li><code>opStr</code>: 指令操作数的字符串表示</li>
<li><code>operands</code>: 描述每个操作数的对象数组，每个对象至少指定类型和值，但可能还包含取决于架构的其他属性</li>
<li><code>regsRead</code>: 此指令隐式读取的寄存器名称数组</li>
<li><code>regsWritten</code>: 此指令隐式写入的寄存器名称数组</li>
<li><code>groups</code>: 此指令所属的组名称数组</li>
<li><code>toString()</code>: 转换为人类可读的字符串</li>
</ul>
<h2 id="Arm64Writer"><a href="#Arm64Writer" class="headerlink" title="Arm64Writer"></a>Arm64Writer</h2><h3 id="new-Arm64Writer-codeAddress-pc-ptr-‘0x1234’"><a href="#new-Arm64Writer-codeAddress-pc-ptr-‘0x1234’" class="headerlink" title="new Arm64Writer(codeAddress[, { pc: ptr(‘0x1234’) }])"></a>new Arm64Writer(codeAddress[, { pc: ptr(‘0x1234’) }])</h3><p>创建一个用于生成 ARM 机器码的代码写入器，该代码会直接写入 <code>codeAddress</code> 指定的内存位置，<code>codeAddress</code> 是一个 <code>NativePointer</code> 类型，第二个参数是可选的选项对象，可以通过其中的 <code>pc</code> 属性指定初始程序计数器（Program Counter, PC）。</p>
<p>返回一个<code>ArmWriter</code>对象。</p>
<h3 id="dispose"><a href="#dispose" class="headerlink" title="dispose()"></a>dispose()</h3><p>释放 <code>Arm64Writer</code> 对象，清理内存。</p>
<h3 id="flush-1"><a href="#flush-1" class="headerlink" title="flush()"></a>flush()</h3><p>用于将已生成或修改的指令刷新到内存中，以确保这些指令可以被正确执行。</p>
<h3 id="putRet"><a href="#putRet" class="headerlink" title="putRet()"></a>putRet()</h3><p>在生成的代码末尾插入一个返回指令，确保动态生成的代码块或函数能够正确返回。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/12/19/Android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/12/19/Android%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">Android系统启动流程分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-12-19 00:00:00" itemprop="dateCreated datePublished" datetime="2024-12-19T00:00:00+08:00">2024-12-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-03-31 10:38:39" itemprop="dateModified" datetime="2025-03-31T10:38:39+08:00">2025-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">Android系统</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本篇以从按下开机键开始至设备桌面图标出现进行分析。</p>
<h1 id="Boot-ROM"><a href="#Boot-ROM" class="headerlink" title="Boot ROM"></a>Boot ROM</h1><p>设备通电后，硬件自检，确保各个硬件组件（CPU、内存、存储设备等）处于正常工作状态。</p>
<p>这个阶段过程通常是由硬件自身的引导程序完成的。</p>
<p>这个引导程序通常是写死在芯片里（ROM），不依赖操作系统。</p>
<h1 id="Bootloader"><a href="#Bootloader" class="headerlink" title="Bootloader"></a>Bootloader</h1><p>&emsp;​&emsp;长按开机键，设备通电，从Boot ROM开始，Boot ROM是芯片上的一段只读存储器，存储设备的启动代码，一般是固定的，用于检测基本硬件的存在，验证 Bootloader 的完整性和安全性，并加载BootLoader到RAM，将控制权移交给BootLoader。</p>
<p>&emsp;​&emsp;​BootLoader对硬件进行基本初始化，从存储设备中读取Android系统Linux内核镜像，通常是boot.img文件，将内核加载到内存中，并将控制权移交给内核。</p>
<h1 id="Linux内核启动"><a href="#Linux内核启动" class="headerlink" title="Linux内核启动"></a>Linux内核启动</h1><p>&emsp;​&emsp;内核启动后会完成复杂的硬件初始化并挂载根文件系统，然后执行第一个用户空间进程<code>init</code>，将控制权移交给<code>init</code>。</p>
<h1 id="init进程"><a href="#init进程" class="headerlink" title="init进程"></a>init进程</h1><p>&emsp;​&emsp;<code>init</code>是Android的第一个用户空间进程，它的PID为1。<code>init</code>解析<code>init.rc</code>脚本文件，定义系统初始化的行为等。</p>
<p>&emsp;​&emsp;启动Zygote进程，<code>Zygote</code>在<code>init.rc</code>文件中定义并通过<code>init</code>启动。</p>
<p>&emsp;​&emsp;<code>init</code>调用<code>/system/bin/app_process</code>可执行文件启动 ART（Android Runtime）或 Dalvik 虚拟机，并执行 <code>ZygoteInit.main()</code>来启动<code>Zygote</code>。</p>
<p>&emsp;​&emsp;<code>init</code>把控制权移交给了<code>Zygote</code>。</p>
<h1 id="Zygote进程"><a href="#Zygote进程" class="headerlink" title="Zygote进程"></a>Zygote进程</h1><p>&emsp;​&emsp;Zygote 是 Android 应用运行时环境的核心，加载虚拟机、类、系统资源，启动SystemServer进程。SystemServer进程是Zygote进程孵化的第一个进程。</p>
<p><strong>Zygote的任务</strong></p>
<p>&emsp;​&emsp;等待应用启动请求，接收请求后，fork() 创建子进程，所有的App进程都是由Zygote孵化而来的。</p>
<h1 id="SystemServer"><a href="#SystemServer" class="headerlink" title="SystemServer"></a>SystemServer</h1><p>&emsp;​&emsp;SystemServer是一个很重要的进程，系统里面重要的服务都是在这个进程里面开启的，比如ActivityManagerService、PackageManagerService、WindowManagerService，负责管理应用程序和系统资源。</p>
<h1 id="Launcher"><a href="#Launcher" class="headerlink" title="Launcher"></a>Launcher</h1><p>&emsp;​&emsp;当 <code>SystemServer</code> 启动完成后，Android 系统会启动第一个前台进程：Launcher。</p>
<p>&emsp;​&emsp;<code>ActivityManagerService</code> 会根据 <code>AndroidManifest.xml</code> 中的配置，启动标记为 <code>MAIN</code> 和 <code>LAUNCHER</code> 的应用，Launcher 加载桌面布局和图标资源。</p>
<p>&emsp;​&emsp;Launcher进程是Zygote孵化出来的第一个App进程。</p>
<p>​	</p>
<p>​	</p>
<p>​	</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/default-index/page/7/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/default-index/">1</a><span class="space">&hellip;</span><a class="page-number" href="/default-index/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/default-index/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/default-index/page/11/">11</a><a class="extend next" rel="next" href="/default-index/page/9/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bileton"
      src="/images/android.svg">
  <p class="site-author-name" itemprop="name">Bileton</p>
  <div class="site-description" itemprop="description">路漫漫其修远夕！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">101</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">93</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bileton</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">856k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">12:58</span>
</div>


<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("01/01/2024 00:00:00"); //修改为你的网站开始运行的时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
