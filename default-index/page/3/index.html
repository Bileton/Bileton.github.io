<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="路漫漫其修远夕！">
<meta property="og:type" content="website">
<meta property="og:title" content="白乐天">
<meta property="og:url" content="http://example.com/default-index/page/3/index.html">
<meta property="og:site_name" content="白乐天">
<meta property="og:description" content="路漫漫其修远夕！">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Bileton">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/default-index/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>白乐天</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">白乐天</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">道阻且长，行则将至。</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">63</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">29</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">68</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/love.js"></script>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/14/frida-rpc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/14/frida-rpc/" class="post-title-link" itemprop="url">frida_rpc</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-01-14 22:10:47 / 修改时间：23:53:12" itemprop="dateCreated datePublished" datetime="2025-01-14T22:10:47+08:00">2025-01-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Frida/" itemprop="url" rel="index"><span itemprop="name">Frida</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="枚举所有进程及其进程ID"><a href="#枚举所有进程及其进程ID" class="headerlink" title="枚举所有进程及其进程ID"></a>枚举所有进程及其进程ID</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Connected to device&quot;</span>)</span><br><span class="line"></span><br><span class="line">processes = device.enumerate_processes()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Listing all processes:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> process <span class="keyword">in</span> processes:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;process.name&#125;</span> (PID: <span class="subst">&#123;process.pid&#125;</span>)&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="注入进程"><a href="#注入进程" class="headerlink" title="注入进程"></a>注入进程</h1><h2 id="附加进程注入"><a href="#附加进程注入" class="headerlink" title="附加进程注入"></a>附加进程注入</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">process = frida.get_usb_device().attach(ProcessName/PID)</span><br><span class="line"></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    console.log(&quot;frida hooked!&quot;)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line">script.load()</span><br></pre></td></tr></table></figure>

<h2 id="spawn方式注入"><a href="#spawn方式注入" class="headerlink" title="spawn方式注入"></a>spawn方式注入</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">pid = device.spawn([PackageName])</span><br><span class="line">process = device.attach(pid)</span><br><span class="line"></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    console.log(&quot;frida hooked!&quot;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">device.resume(pid) 	<span class="comment"># 恢复进程</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Script loaded&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="非标准端口注入"><a href="#非标准端口注入" class="headerlink" title="非标准端口注入"></a>非标准端口注入</h2><p>需要进行端口转发</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb forword tcp:27042 tcp:27042</span><br></pre></td></tr></table></figure>

<h3 id="attach"><a href="#attach" class="headerlink" title="attach"></a>attach</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;127.0.0.1:7788&quot;</span>)	<span class="comment"># 指定IP地址</span></span><br><span class="line">process = device.attach(ProcessName/PID)</span><br><span class="line"></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    console.log(&quot;frida hooked!&quot;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line">script.load()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Script loaded&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="spawn"><a href="#spawn" class="headerlink" title="spawn"></a>spawn</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;127.0.0.1:7788&quot;</span>)	<span class="comment"># 指定IP地址</span></span><br><span class="line">pid = device.spawn(PackageName)</span><br><span class="line">process = device.attach(pid)</span><br><span class="line"></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    console.log(&quot;frida hooked!&quot;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line">device.resume(pid)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Script loaded&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="send"><a href="#send" class="headerlink" title="send"></a>send</h1><p><code>send</code> 是用于在 Frida 脚本和主机 Python 程序之间通信的函数。</p>
<h2 id="JS端"><a href="#JS端" class="headerlink" title="JS端"></a>JS端</h2><p><code>send</code> 是 Frida 的全局函数，用于向Python程序发送字符串、对象或其他序列化数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">send</span>(<span class="string">&quot;Hello from Frida!&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Python端"><a href="#Python端" class="headerlink" title="Python端"></a>Python端</h2><p>通过 <code>script.on(&quot;message&quot;, callback)</code> 监听 JavaScript 脚本发送的消息。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Received message: <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, on_message)  <span class="comment"># 注册消息回调</span></span><br></pre></td></tr></table></figure>

<h2 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;127.0.0.1:7788&quot;</span>)</span><br><span class="line">pid = device.spawn(PackageName)</span><br><span class="line">process = device.attach(pid)</span><br><span class="line"></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    console.log(&quot;frida hooked!&quot;);</span></span><br><span class="line"><span class="string">    send(&quot;Hello from Frida!&quot;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message,data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Received from JavaScript: <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>,on_message)</span><br><span class="line"></span><br><span class="line">script.load()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Script loaded&quot;</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">frida hooked!</span><br><span class="line">Received <span class="keyword">from</span> JavaScript: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;send&#x27;</span>, <span class="string">&#x27;payload&#x27;</span>: <span class="string">&#x27;Hello from Frida!&#x27;</span>&#125;</span><br><span class="line">Script loaded</span><br></pre></td></tr></table></figure>



<h2 id="双向通信"><a href="#双向通信" class="headerlink" title="双向通信"></a>双向通信</h2><h3 id="JS端-1"><a href="#JS端-1" class="headerlink" title="JS端"></a>JS端</h3><p>通过&#96;&#96;send<code>发送，</code>recv&#96;来接收。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">send</span>(<span class="string">&quot;Requesting data from Python&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收来自 Python 的消息</span></span><br><span class="line"><span class="title function_">recv</span>(<span class="keyword">function</span> (<span class="params">message</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received from Python:&quot;</span>, message.<span class="property">payload</span>);</span><br><span class="line">&#125;).<span class="title function_">wait</span>();</span><br></pre></td></tr></table></figure>

<h3 id="Python端-1"><a href="#Python端-1" class="headerlink" title="Python端"></a>Python端</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Received from JavaScript: <span class="subst">&#123;message[<span class="string">&#x27;payload&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 回复消息给 JavaScript</span></span><br><span class="line">        script.post(&#123;<span class="string">&quot;response&quot;</span>: <span class="string">&quot;Data received!&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, on_message)</span><br></pre></td></tr></table></figure>

<h2 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line">device = frida.get_device_manager().add_remote_device(<span class="string">&quot;127.0.0.1:7788&quot;</span>)</span><br><span class="line">pid = device.spawn(PackageName)</span><br><span class="line">process = device.attach(pid)</span><br><span class="line"></span><br><span class="line">jsCode = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    console.log(&quot;frida hooked!&quot;);</span></span><br><span class="line"><span class="string">    send(&quot;Hello from Frida!&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    recv(function (message)&#123;</span></span><br><span class="line"><span class="string">        console.log(&quot;Received from Python:&quot;, message)</span></span><br><span class="line"><span class="string">    &#125;).wait();</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">script = process.create_script(jsCode)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message,data</span>):</span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;send&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Received from JavaScript: <span class="subst">&#123;message&#125;</span>&quot;</span>)</span><br><span class="line">    script.post(<span class="string">&quot;message from Python&quot;</span>)</span><br><span class="line"></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>,on_message)</span><br><span class="line">script.load()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Script loaded&quot;</span>)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">frida hooked!</span><br><span class="line">Received <span class="keyword">from</span> JavaScript: &#123;<span class="string">&#x27;type&#x27;</span>: <span class="string">&#x27;send&#x27;</span>, <span class="string">&#x27;payload&#x27;</span>: <span class="string">&#x27;Hello from Frida!&#x27;</span>&#125;</span><br><span class="line">Received <span class="keyword">from</span> Python: message <span class="keyword">from</span> Python</span><br><span class="line">Script loaded</span><br></pre></td></tr></table></figure>

<h1 id="rpc"><a href="#rpc" class="headerlink" title="rpc"></a>rpc</h1><h2 id="JS端定义rpc函数"><a href="#JS端定义rpc函数" class="headerlink" title="JS端定义rpc函数"></a>JS端定义rpc函数</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rpc.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">hello</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hello from Frida!&quot;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="attr">add</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>rpc.exports</code> 是一个对象，暴露的函数作为其属性。</p>
<h2 id="Python端调用rpc方法"><a href="#Python端调用rpc方法" class="headerlink" title="Python端调用rpc方法"></a>Python端调用rpc方法</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接到目标设备和应用</span></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line">pid = device.spawn([<span class="string">&quot;com.example.app&quot;</span>])</span><br><span class="line">session = device.attach(pid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 JavaScript 脚本</span></span><br><span class="line">js_code = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">rpc.exports = &#123;</span></span><br><span class="line"><span class="string">    hello: function () &#123;</span></span><br><span class="line"><span class="string">        return &quot;Hello from Frida!&quot;;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    add: function (a, b) &#123;</span></span><br><span class="line"><span class="string">        return a + b;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">script = session.create_script(js_code)</span><br><span class="line">script.load()</span><br><span class="line">device.resume(pid)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用 RPC 方法</span></span><br><span class="line"><span class="built_in">print</span>(script.exports.hello())  <span class="comment"># 输出: Hello from Frida!</span></span><br><span class="line"><span class="built_in">print</span>(script.exports.add(<span class="number">3</span>, <span class="number">5</span>))  <span class="comment"># 输出: 8</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/" class="post-title-link" itemprop="url">爱库存app参数sign还原</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-13 22:43:32" itemprop="dateCreated datePublished" datetime="2025-01-13T22:43:32+08:00">2025-01-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-14 18:28:42" itemprop="dateModified" datetime="2025-01-14T18:28:42+08:00">2025-01-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>22k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>20 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.aikucun.akapp</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/1.jpg"></p>
<h1 id="关于frida反调试"><a href="#关于frida反调试" class="headerlink" title="关于frida反调试"></a>关于frida反调试</h1><p>这个app的反调试我是通过杀线程绕过的，具体过程不再详写，其他文章里有相同的绕过思路。</p>
<h1 id="抓包分析数据"><a href="#抓包分析数据" class="headerlink" title="抓包分析数据"></a>抓包分析数据</h1><p>寻找<code>sign</code>参数</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/2.jpg"></p>
<h1 id="jadx反编译apk"><a href="#jadx反编译apk" class="headerlink" title="jadx反编译apk"></a>jadx反编译apk</h1><p>搜索<code>&quot;sign&quot;</code>，经过一番搜索，并没有找到相关的代码实现位置，换一种思路搜素<code>&quot;svs&quot;</code>，定位到了参数的位置。</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/3.jpg"></p>
<p>双击查看</p>
<h2 id="onAttachQueryParameters"><a href="#onAttachQueryParameters" class="headerlink" title="onAttachQueryParameters"></a>onAttachQueryParameters</h2><p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/4.jpg"></p>
<p>这里我们可以双击<code>b.u</code>，查看其内容即<code>svs</code>的值，发现它是一个定值<code>v3</code></p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/5.jpg"></p>
<p>接着向下浏览找到了<code>&quot;&amp;sign=&quot;</code>，结合上下文发现就是我们要找的<code>sign</code></p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/6.jpg"></p>
<p>很清晰的看出来了<code>sign</code>的值为<code>signV3</code>，是经过<code>signV3</code>函数签名得到的结果。</p>
<h2 id="signV3"><a href="#signV3" class="headerlink" title="signV3"></a>signV3</h2><p>查看signV3的内容，它是一个native函数</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/7.jpg"></p>
<h3 id="hook-signV3"><a href="#hook-signV3" class="headerlink" title="hook signV3"></a>hook signV3</h3><p>我们可以hook signV3函数查看其参数和返回值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_signV3</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">MXSecurity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.mengxiang.arch.security.MXSecurity&quot;</span>);</span><br><span class="line">        <span class="title class_">MXSecurity</span>[<span class="string">&quot;signV3&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">url, nonceStr, timestamp, body</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`MXSecurity.signV3 is called: url=<span class="subst">$&#123;url&#125;</span>, nonceStr=<span class="subst">$&#123;nonceStr&#125;</span>, timestamp=<span class="subst">$&#123;timestamp&#125;</span>, body=<span class="subst">$&#123;body&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;signV3&quot;</span>](url, nonceStr, timestamp, body);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`MXSecurity.signV3 result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_signV3</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">MXSecurity.signV3 is called: url=https://zuul.aikucun.com/akucun-base-data-new/base/address/selectAddrVersion?appid=38741001&amp;did=d545ae984083237bae9a6358ca29910f&amp;noncestr=3f60cc&amp;svs=v3&amp;timestamp=1736605877, nonceStr=3f60cc, timestamp=1736605877, body=</span><br><span class="line">MXSecurity.signV3 is called: url=https://m.xiangdian.com/api/mshop/mshop-aggr-prod/outer/common/bwl/isHitByBatch?appid=38741001&amp;did=d545ae984083237bae9a6358ca29910f&amp;noncestr=bf6c60&amp;svs=v3&amp;timestamp=1736605877, nonceStr=bf6c60, timestamp=1736605877, body=398a40be5a2a6a5a742f35b1b606277a</span><br><span class="line">MXSecurity.signV3 result=508858db8f332eb10fcf604c617229e5ef180f8698e10bd8626d3b9ec67416a4</span><br><span class="line">MXSecurity.signV3 result=a89e326bb0d2fcb6029e3991366ba812ee1deafd6bd0ba81f00850b794fd4a49</span><br><span class="line">MXSecurity.signV3 is called: url=https://m.xiangdian.com/api/mshop/mshop-aggr-prod/outer/v1/material/create/createAuth?appid=38741001&amp;did=d545ae984083237bae9a6358ca29910f&amp;noncestr=2cd903&amp;svs=v3&amp;timestamp=1736605877, nonceStr=2cd903, timestamp=1736605877, body=37a6259cc0c1dae299a7866489dff0bd</span><br><span class="line">MXSecurity.signV3 result=7df7962bdd9a2e5182cbacb123e0f95aba154da8f4499c9dab69b45e90003f17</span><br><span class="line">MXSecurity.signV3 is called: url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config?appid=38741001&amp;did=d545ae984083237bae9a6358ca29910f&amp;noncestr=63ba42&amp;svs=v3&amp;timestamp=1736605879, nonceStr=63ba42, timestamp=1736605879, body=ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">MXSecurity.signV3 result=70b90270cefb862185029b36663c9643201f13f790a9b20fd7a31082e30d0fbe</span><br></pre></td></tr></table></figure>

<h2 id="url"><a href="#url" class="headerlink" title="url"></a>url</h2><p>url是signV3的第一个参数，</p>
<p>分析url里的参数，url的第一个参数是<code>appid</code></p>
<p>如下，<code>appid</code>是在so里面获取的，等分析so的时候再去分析它</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/26.jpg"></p>
<p>url的第二个参数是did</p>
<p>如下，调用getDid方法</p>
<h3 id="getDId"><a href="#getDId" class="headerlink" title="getDId"></a>getDId</h3><p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/27.jpg"></p>
<p>在getDid方法里调用了md5String方法，其参数是<code>&quot;micker.cn&quot;</code>拼接<code>getUdid()</code>的返回值，对参数进行md5加密，得到did</p>
<h3 id="getUdid"><a href="#getUdid" class="headerlink" title="getUdid"></a>getUdid</h3><p>获取udid的值</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/28.jpg"></p>
<p>如果udid为空，会重新随机一个uuid，设置为udid</p>
<h2 id="nonceStr"><a href="#nonceStr" class="headerlink" title="nonceStr"></a>nonceStr</h2><p>nonceStr是signV3的第二个参数</p>
<p><strong>substring</strong></p>
<p>传入signV3方法的第二个参数是<code>substring</code>，查找这个参数是怎么生成的</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/8.jpg"></p>
<p>可以看出来，这个参数是<code>replace$default</code>的子字符串，也就是其前六个字符。</p>
<p><strong>replace$default</strong></p>
<p>如下</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/9.jpg"></p>
<p>StringsJVM调用的<code>replace$default</code>方法，里面传入了一个参数uuid，它是随机生成的  </p>
<p>看一下这个方法是怎么实现的，如下</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/10.jpg"></p>
<p>又调用了replace方法，查看其实现</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/11.jpg"></p>
<p>好长一串啊，这里我选择直接hook <code>replace</code>方法分析其参数和返回值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_replace</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">StringsJVM</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;kotlin.text.StringsKt__StringsJVMKt&quot;</span>);</span><br><span class="line">        <span class="title class_">StringsJVM</span>[<span class="string">&quot;replace&quot;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;boolean&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str, oldValue, newValue, z</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`StringsJVM.replace is called: str=<span class="subst">$&#123;str&#125;</span>, oldValue=<span class="subst">$&#123;oldValue&#125;</span>, newValue=<span class="subst">$&#123;newValue&#125;</span>, z=<span class="subst">$&#123;z&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;replace&quot;</span>](str, oldValue, newValue, z);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`StringsJVM.replace result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_replace</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook 结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">StringsJVM.replace is called: str=14d557b1-496b-4daa-ba2f-d7cffe054397, oldValue=-, newValue=, z=false</span><br><span class="line">StringsJVM.replace result=14d557b1496b4daaba2fd7cffe054397</span><br></pre></td></tr></table></figure>

<p>它是把<code>uuid</code>中的<code>-</code>符号给去除了</p>
<p>到这里就知道nonceStr的值就是uuid的前六个字符</p>
<h2 id="timestamp"><a href="#timestamp" class="headerlink" title="timestamp"></a>timestamp</h2><p><code>signV3</code>的第三个参数是timestamp没什么好分析的，是一个时间戳。</p>
<h2 id="body"><a href="#body" class="headerlink" title="body"></a>body</h2><p>接下来分析<code>signV3</code>的第四个参数，<code>body</code></p>
<p>传入<code>signV3</code>的参数是<code>bodyMD5</code>，看名字就与<code>bodyMD5</code>有关系</p>
<p>看这个参数是怎么生成的</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/12.jpg"></p>
<p>调用了bodyMD5()方法，里面传入了一个request参数</p>
<h3 id="bodyMD5"><a href="#bodyMD5" class="headerlink" title="bodyMD5"></a>bodyMD5</h3><p>查看这个方法的具体实现</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/13.jpg"></p>
<p>把请求体进行了一个MD5运算</p>
<h3 id="hook-bodyMD5"><a href="#hook-bodyMD5" class="headerlink" title="hook bodyMD5"></a>hook bodyMD5</h3><p>这里可以把bodyMD5方法和md5标准加密算法同时hook，更清晰</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_md5</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">MD5Utils</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.mengxiang.arch.utils.MD5Utils&quot;</span>);</span><br><span class="line">        <span class="title class_">MD5Utils</span>[<span class="string">&quot;md5&quot;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">value</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`MD5Utils.md5 is called: value=<span class="subst">$&#123;value&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;md5&quot;</span>](value);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`MD5Utils.md5 result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_bodymd5</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> <span class="title class_">MXV1Sign</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.mengxiang.arch.net.sign.MXV1Sign&quot;</span>);</span><br><span class="line">        <span class="title class_">MXV1Sign</span>[<span class="string">&quot;bodyMD5&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">request</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`MXV1Sign.bodyMD5 is called: request=<span class="subst">$&#123;request&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;bodyMD5&quot;</span>](request);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`MXV1Sign.bodyMD5 result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hook_bodymd5</span>()</span><br><span class="line"><span class="title function_">hook_md5</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook 结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">MXV1Sign.bodyMD5 is called: request=Request&#123;method=GET, url=https://zuul.aikucun.com/akucun-base-data-new/base/address/selectAddrVersion, tags=&#123;class retrofit2.Invocation=com.aikucun.akapp.business.address.service.AddressService.selectAddressVersion() []&#125;&#125;</span><br><span class="line">MXV1Sign.bodyMD5 result=</span><br><span class="line"></span><br><span class="line">MXV1Sign.bodyMD5 is called: request=Request&#123;method=POST, url=https://m.xiangdian.com/api/mshop/mshop-aggr-prod/outer/common/bwl/isHitByBatch, tags=&#123;class retrofit2.Invocation=com.aikucun.akapp.common.gray.GrayService$GrayServiceApi.grayControl() [&#123;bwlCodes=[B-MATERIAL-CREATE-V2, B-MATERIAL-CREATE-V3, B-MATERIAL-INCOME]&#125;]&#125;&#125;</span><br><span class="line"></span><br><span class="line">MD5Utils.md5 is called: value=&#123;&quot;bwlCodes&quot;:[&quot;B-MATERIAL-CREATE-V2&quot;,&quot;B-MATERIAL-CREATE-V3&quot;,&quot;B-MATERIAL-INCOME&quot;]&#125;</span><br><span class="line">MD5Utils.md5 result=398a40be5a2a6a5a742f35b1b606277a</span><br><span class="line">MXV1Sign.bodyMD5 result=398a40be5a2a6a5a742f35b1b606277a</span><br><span class="line"></span><br><span class="line">MXV1Sign.bodyMD5 is called: request=Request&#123;method=POST, url=https://m.xiangdian.com/api/mshop/mshop-aggr-prod/outer/v1/material/create/createAuth, headers=[app-cache-strategy:1], tags=&#123;class retrofit2.Invocation=com.mengxiang.arch.channel.impl.network.NetChannel$APIService.postRequest() [/api/mshop/mshop-aggr-prod/outer/v1/material/create/createAuth, &#123;app-cache-strategy=1&#125;, null]&#125;&#125;</span><br><span class="line">MD5Utils.md5 is called: value=null</span><br><span class="line">MD5Utils.md5 result=37a6259cc0c1dae299a7866489dff0bd</span><br><span class="line">MXV1Sign.bodyMD5 result=37a6259cc0c1dae299a7866489dff0bd</span><br><span class="line"></span><br><span class="line">MXV1Sign.bodyMD5 is called: request=Request&#123;method=POST, url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config, tags=&#123;class retrofit2.Invocation=com.aikucun.akapp.business.update.service.UpdateService.checkAppUpgrade() [&#123;configKey=[Ljava.lang.String;@61048d9, system=1, isShowUpdate=false, appId=com.aikucun.akapp, channel=2010, deviceModel=google-Pixel 3, buildCode=76302, version=7.63.2, userCode=, deviceBrand=Google&#125;]&#125;&#125;</span><br><span class="line">MD5Utils.md5 is called: value=&#123;&quot;configKey&quot;:[&quot;versionUpdate&quot;],&quot;system&quot;:1,&quot;isShowUpdate&quot;:false,&quot;appId&quot;:&quot;com.aikucun.akapp&quot;,&quot;channel&quot;:&quot;2010&quot;,&quot;deviceModel&quot;:&quot;google-Pixel 3&quot;,&quot;buildCode&quot;:76302,&quot;version&quot;:&quot;7.63.2&quot;,&quot;userCode&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;Google&quot;&#125;</span><br><span class="line">MD5Utils.md5 result=ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">MXV1Sign.bodyMD5 result=ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line"></span><br><span class="line">MXV1Sign.bodyMD5 is called: request=Request&#123;method=POST, url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config, tags=&#123;class retrofit2.Invocation=com.aikucun.akapp.business.update.service.UpdateService.checkAppUpgrade() [&#123;configKey=[Ljava.lang.String;@f07dfd1, system=1, isShowUpdate=false, appId=com.aikucun.akapp, channel=2010, deviceModel=google-Pixel 3, buildCode=76302, version=7.63.2, userCode=, deviceBrand=Google&#125;]&#125;&#125;</span><br><span class="line">MD5Utils.md5 is called: value=&#123;&quot;configKey&quot;:[&quot;versionUpdate&quot;],&quot;system&quot;:1,&quot;isShowUpdate&quot;:false,&quot;appId&quot;:&quot;com.aikucun.akapp&quot;,&quot;channel&quot;:&quot;2010&quot;,&quot;deviceModel&quot;:&quot;google-Pixel 3&quot;,&quot;buildCode&quot;:76302,&quot;version&quot;:&quot;7.63.2&quot;,&quot;userCode&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;Google&quot;&#125;</span><br><span class="line">MD5Utils.md5 result=ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">MXV1Sign.bodyMD5 result=ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">MXV1Sign.bodyMD5 is called: request=Request&#123;method=POST, url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config, tags=&#123;class retrofit2.Invocation=com.aikucun.akapp.business.update.service.UpdateService.checkAppUpgrade() [&#123;configKey=[Ljava.lang.String;@cf2f91a, system=1, isShowUpdate=false, appId=com.aikucun.akapp, channel=2010, deviceModel=google-Pixel 3, buildCode=76302, version=7.63.2, userCode=, deviceBrand=Google&#125;]&#125;&#125;</span><br><span class="line">MD5Utils.md5 is called: value=&#123;&quot;configKey&quot;:[&quot;versionUpdate&quot;],&quot;system&quot;:1,&quot;isShowUpdate&quot;:false,&quot;appId&quot;:&quot;com.aikucun.akapp&quot;,&quot;channel&quot;:&quot;2010&quot;,&quot;deviceModel&quot;:&quot;google-Pixel 3&quot;,&quot;buildCode&quot;:76302,&quot;version&quot;:&quot;7.63.2&quot;,&quot;userCode&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;Google&quot;&#125;</span><br><span class="line">MD5Utils.md5 result=ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">MXV1Sign.bodyMD5 result=ce10a5623f4ce537c8cbd4e306504860</span><br></pre></td></tr></table></figure>



<p>好了，这里就把<code>signV3</code>方法的参数和返回值分析完成了，接下来就到so里面具体分析这个函数的实现过程了。</p>
<h1 id="so分析"><a href="#so分析" class="headerlink" title="so分析"></a>so分析</h1><p>signV3的实现在<code>mx</code>里</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/14.jpg"></p>
<h2 id="定位signV3"><a href="#定位signV3" class="headerlink" title="定位signV3"></a>定位signV3</h2><p>IDA打开so文件，在导出函数表里搜索<code>Java</code>，直接就定位到了，双击跳转到函数地址</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/15.jpg"></p>
<p>对反汇编的内容稍作处理，得到如下内容</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">Java_com_mengxiang_arch_security_MXSecurity_signV3</span><span class="params">(</span></span><br><span class="line"><span class="params">        JNIEnv *env,</span></span><br><span class="line"><span class="params">        jobject obj,</span></span><br><span class="line"><span class="params">        <span class="type">char</span> *url,</span></span><br><span class="line"><span class="params">        <span class="type">char</span> *noncestr,</span></span><br><span class="line"><span class="params">        <span class="type">char</span> *timestamp,</span></span><br><span class="line"><span class="params">        <span class="type">char</span> *body)</span></span><br><span class="line">&#123;</span><br><span class="line">  JNIEnv v6; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">size_t</span> v11; <span class="comment">// x28</span></span><br><span class="line">  <span class="type">size_t</span> v12; <span class="comment">// x25</span></span><br><span class="line">  <span class="type">size_t</span> v13; <span class="comment">// x26</span></span><br><span class="line">  <span class="type">size_t</span> v14; <span class="comment">// x27</span></span><br><span class="line">  <span class="type">size_t</span> v15; <span class="comment">// x20</span></span><br><span class="line">  <span class="type">size_t</span> v16; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">size_t</span> v17; <span class="comment">// x22</span></span><br><span class="line">  <span class="type">size_t</span> v18; <span class="comment">// x23</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v19; <span class="comment">// x20</span></span><br><span class="line">  _QWORD *v20; <span class="comment">// x24</span></span><br><span class="line">  __int64 v21; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">char</span> *v22; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v23; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v24; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v25; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v26; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v27; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v28; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v29; <span class="comment">// x0</span></span><br><span class="line">  __int64 v30; <span class="comment">// x8</span></span><br><span class="line">  <span class="type">char</span> *v31; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v32; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">char</span> *v33; <span class="comment">// x0</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v34; <span class="comment">// w20</span></span><br><span class="line">  jbyteArray sha256_data; <span class="comment">// x21</span></span><br><span class="line">  <span class="type">char</span> *v36; <span class="comment">// x1</span></span><br><span class="line">  jstring (*NewStringUTF)(JNIEnv *, <span class="type">const</span> <span class="type">char</span> *); <span class="comment">// x2</span></span><br><span class="line">  <span class="type">size_t</span> v39; <span class="comment">// [xsp+8h] [xbp-78h]</span></span><br><span class="line">  <span class="type">char</span> *timestamp_char; <span class="comment">// [xsp+10h] [xbp-70h]</span></span><br><span class="line">  <span class="type">char</span> *noncestr_char; <span class="comment">// [xsp+18h] [xbp-68h]</span></span><br><span class="line">  <span class="type">char</span> *url_char; <span class="comment">// [xsp+20h] [xbp-60h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *body_char; <span class="comment">// [xsp+28h] [xbp-58h]</span></span><br><span class="line"></span><br><span class="line">  v6 = *env;</span><br><span class="line">  <span class="keyword">if</span> ( (byte_32051 &amp; <span class="number">1</span>) != <span class="number">0</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    noncestr_char = v6-&gt;GetStringUTFChars(env, noncestr, <span class="number">0LL</span>);</span><br><span class="line">    timestamp_char = (*env)-&gt;GetStringUTFChars(env, timestamp, <span class="number">0LL</span>);</span><br><span class="line">    url_char = (*env)-&gt;GetStringUTFChars(env, url, <span class="number">0LL</span>);</span><br><span class="line">    body_char = (*env)-&gt;GetStringUTFChars(env, body, <span class="number">0LL</span>);</span><br><span class="line">    v39 = __strlen_chk(<span class="string">&quot;appid=&quot;</span>, <span class="number">7uLL</span>);</span><br><span class="line">    v11 = __strlen_chk(<span class="string">&quot;&amp;svs=&quot;</span>, <span class="number">6uLL</span>);</span><br><span class="line">    v12 = __strlen_chk(<span class="string">&quot;v3&quot;</span>, <span class="number">3uLL</span>);</span><br><span class="line">    v13 = __strlen_chk(<span class="string">&quot;&amp;noncestr=&quot;</span>, <span class="number">0xB</span>uLL);</span><br><span class="line">    v14 = <span class="built_in">strlen</span>(noncestr_char);</span><br><span class="line">    v15 = __strlen_chk(<span class="string">&quot;&amp;timestamp=&quot;</span>, <span class="number">0xC</span>uLL);</span><br><span class="line">    v16 = <span class="built_in">strlen</span>(timestamp_char);</span><br><span class="line">    v17 = __strlen_chk(<span class="string">&quot;&amp;secret=&quot;</span>, <span class="number">9uLL</span>);</span><br><span class="line">    v18 = __strlen_chk(<span class="string">&quot;&amp;url=&quot;</span>, <span class="number">6uLL</span>);</span><br><span class="line">    v19 = v39 + v11 + v12 + v13 + v14 + v15 + v16 + v17 + v18 + <span class="built_in">strlen</span>(url_char) + <span class="number">74</span>;</span><br><span class="line">    v20 = operator new[](v19);</span><br><span class="line">    <span class="built_in">memset</span>(v20, <span class="number">0</span>, v19);</span><br><span class="line">    *v20 = <span class="number">0LL</span>;</span><br><span class="line">    <span class="built_in">strcat</span>(v20, <span class="string">&quot;appid=&quot;</span>);</span><br><span class="line">    v21 = <span class="number">32LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( isDebug )</span><br><span class="line">      v21 = <span class="number">16LL</span>;</span><br><span class="line">    v22 = <span class="built_in">strcat</span>(v20, *(lpAppInfo + v21));</span><br><span class="line">    v23 = <span class="built_in">strcat</span>(v22, <span class="string">&quot;&amp;svs=&quot;</span>);</span><br><span class="line">    v24 = <span class="built_in">strcat</span>(v23, <span class="string">&quot;v3&quot;</span>);</span><br><span class="line">    v25 = <span class="built_in">strcat</span>(v24, <span class="string">&quot;&amp;noncestr=&quot;</span>);</span><br><span class="line">    v26 = <span class="built_in">strcat</span>(v25, noncestr_char);</span><br><span class="line">    v27 = <span class="built_in">strcat</span>(v26, <span class="string">&quot;&amp;timestamp=&quot;</span>);</span><br><span class="line">    v28 = <span class="built_in">strcat</span>(v27, timestamp_char);</span><br><span class="line">    v29 = <span class="built_in">strcat</span>(v28, <span class="string">&quot;&amp;secret=&quot;</span>);</span><br><span class="line">    v30 = <span class="number">40LL</span>;</span><br><span class="line">    <span class="keyword">if</span> ( isDebug )</span><br><span class="line">      v30 = <span class="number">24LL</span>;</span><br><span class="line">    v31 = <span class="built_in">strcat</span>(v29, *(lpAppInfo + v30));</span><br><span class="line">    v32 = <span class="built_in">strcat</span>(v31, <span class="string">&quot;&amp;url=&quot;</span>);</span><br><span class="line">    <span class="built_in">strcat</span>(v32, url_char);</span><br><span class="line">    <span class="keyword">if</span> ( body_char &amp;&amp; <span class="built_in">strlen</span>(body_char) )</span><br><span class="line">    &#123;</span><br><span class="line">      v33 = <span class="built_in">strcat</span>(v20, <span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">      <span class="built_in">strcat</span>(v33, body_char);</span><br><span class="line">    &#125;</span><br><span class="line">    v34 = <span class="built_in">strlen</span>(v20);</span><br><span class="line">    sha256_data = (*env)-&gt;NewByteArray(env, v34);</span><br><span class="line">    (*env)-&gt;SetByteArrayRegion(env, sha256_data, <span class="number">0LL</span>, v34, v20);</span><br><span class="line">    v36 = digest(env, ALGORITHM_SHA256, sha256_data);</span><br><span class="line">    NewStringUTF = (*env)-&gt;NewStringUTF;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    NewStringUTF = v6-&gt;NewStringUTF;</span><br><span class="line">    v36 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> NewStringUTF(env, v36);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>调用了digest方法，是SHA256签名算法，参数是<code>sha256_data</code>，分析这个参数是怎么生成的</p>
<p>它是由<code>appid</code>，<code>svs</code>、<code>noncestr</code>、<code>timestamp</code>、<code>secret</code>、<code>url</code>、<code>body</code>这些内容拼接而成的</p>
<p>目前还有两个未知参数<code>appid</code>和<code>secret</code></p>
<h3 id="appid"><a href="#appid" class="headerlink" title="appid"></a>appid</h3><p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/16.jpg"></p>
<p>这里看到appid的值是<code>lpAppInfo</code>加上一个偏移，偏移与<code>isDebug</code>有关</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/18.jpg"></p>
<p>可以直接用frida直接打印内存中的数据</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/17.jpg"></p>
<p><code>isDebug</code>的值为0，所以<code>v21</code>的值为32</p>
<p>接下来打印<code>lpAppInfo</code>的值</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/19.jpg"></p>
<p><code>lpAppInfo</code>的值为<code>773f4e8b70</code>，<code>lpAppInfo</code>是个二级指针，加上偏移，打印它在内存中的数据</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/20.jpg"></p>
<p>还是指向一个地址，继续打印</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/21.jpg"></p>
<p>这里就得到appid的值为<code>38741001</code></p>
<h3 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h3><p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/22.jpg"></p>
<p>这里和<code>appid</code>参数一样，只需要修改偏移就可以打印<code>secret</code>的值</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/23.jpg"></p>
<p>继续打印</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/24.jpg"></p>
<p>这里得到<code>secret</code>的值为<code>04fdc5e4d9c7420e896ee92b17c68e9f</code></p>
<h3 id="hook-digest"><a href="#hook-digest" class="headerlink" title="hook digest"></a>hook digest</h3><p>参数分析完成了，接下来hook digest函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_dlopen</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//Android8.0之后加载so通过android_dlopen_ext函数</span></span><br><span class="line">    <span class="keyword">var</span> android_dlopen_ext = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>,<span class="string">&quot;android_dlopen_ext&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr_android_dlopen_ext&quot;</span>,android_dlopen_ext);</span><br><span class="line">    <span class="keyword">var</span> islibmx = <span class="literal">false</span>;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(android_dlopen_ext,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> pathptr = args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(pathptr!=<span class="literal">null</span> &amp;&amp; pathptr != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> path = <span class="title function_">ptr</span>(pathptr).<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="keyword">if</span>(path.<span class="title function_">indexOf</span>(<span class="string">&quot;libmx.so&quot;</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">                    islibmx = <span class="literal">true</span>;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;android_dlopen_ext:&quot;</span>,path);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retvel</span>)&#123;</span><br><span class="line">            <span class="comment">//console.log(&quot;leave!&quot;);</span></span><br><span class="line">            <span class="keyword">if</span>(islibmx)&#123;</span><br><span class="line">                islibmx=<span class="literal">false</span>;</span><br><span class="line">                <span class="title function_">hook_digest</span>()</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_digest</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> digest_addr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libmx.so&quot;</span>,<span class="string">&quot;_Z6digestP7_JNIEnvPKcP11_jbyteArray&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr:&quot;</span>,digest_addr);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(digest_addr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hooked&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[1]:&quot;</span>,args[<span class="number">1</span>].<span class="title function_">readCString</span>());</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[2]:&quot;</span>,args[<span class="number">2</span>]);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retval</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;retval:&quot;</span>,retval.<span class="title function_">readCString</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="title function_">hook_dlopen</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook 结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2]: 0x15</span><br><span class="line">retval: 580ef777f37fbb91dc13afa7cf6c2cd40db25286898f79af7ee4d707a2776a5b</span><br><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2]: 0x19</span><br><span class="line">retval: 06c3972159e698bec75632ecf9dd3e03ef47414f4cb22ec963effa10764a526e</span><br><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2]: 0x15</span><br><span class="line">retval: de46725478edde6cc051dcdab7d0cd762678999038fa010d7188e7340c530932</span><br><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2]: 0x15</span><br><span class="line">retval: b1eabf65340dd48a7e3d2855ffe38c4b21461f2a5688a7abbdfe970c30799ae2</span><br></pre></td></tr></table></figure>

<p>这里有些小疑惑，<code>args[2]</code>是加密的数据，应该是一个指针，指向一个字符串，而这里是一个数值</p>
<p>找到这个变量定义的地方，原来它的类型是<code>jbyteArray</code>类型，打印出来的值实际上是<code>jbyteArray</code>的句柄值。</p>
<p><img src="/2025/01/13/%E7%88%B1%E5%BA%93%E5%AD%98app%E5%8F%82%E6%95%B0sign%E8%BF%98%E5%8E%9F/25.jpg"></p>
<p>打印<code>jbyteArray</code>，我们可以调用如下方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">jbyteArray2Array</span>(<span class="params">jbyteArray</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;[B&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> buffer = <span class="title class_">Java</span>.<span class="title function_">cast</span>(jbyteArray, b);</span><br><span class="line">        ret = <span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&#x27;byte&#x27;</span>, buffer);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加入到hook代码中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_dlopen</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//Android8.0之后加载so通过android_dlopen_ext函数</span></span><br><span class="line">    <span class="keyword">var</span> android_dlopen_ext = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>,<span class="string">&quot;android_dlopen_ext&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr_android_dlopen_ext&quot;</span>,android_dlopen_ext);</span><br><span class="line">    <span class="keyword">var</span> islibmx = <span class="literal">false</span>;</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(android_dlopen_ext,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> pathptr = args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(pathptr!=<span class="literal">null</span> &amp;&amp; pathptr != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> path = <span class="title function_">ptr</span>(pathptr).<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="keyword">if</span>(path.<span class="title function_">indexOf</span>(<span class="string">&quot;libmx.so&quot;</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">                    islibmx = <span class="literal">true</span>;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;android_dlopen_ext:&quot;</span>,path);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retvel</span>)&#123;</span><br><span class="line">            <span class="comment">//console.log(&quot;leave!&quot;);</span></span><br><span class="line">            <span class="keyword">if</span>(islibmx)&#123;</span><br><span class="line">                islibmx=<span class="literal">false</span>;</span><br><span class="line">                <span class="title function_">hook_digest</span>()</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_digest</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> digest_addr = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libmx.so&quot;</span>,<span class="string">&quot;_Z6digestP7_JNIEnvPKcP11_jbyteArray&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr:&quot;</span>,digest_addr);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(digest_addr,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hooked&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[1]:&quot;</span>,args[<span class="number">1</span>].<span class="title function_">readCString</span>());</span><br><span class="line">            <span class="keyword">let</span> arrayStr = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>).$new(<span class="title function_">jbyteArray2Array</span>(args[<span class="number">2</span>]))</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;args[2]&quot;</span>,arrayStr);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retval</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;retval:&quot;</span>,retval.<span class="title function_">readCString</span>())</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jbyteArray2Array</span>(<span class="params">jbyteArray</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> ret;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;[B&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> buffer = <span class="title class_">Java</span>.<span class="title function_">cast</span>(jbyteArray, b);</span><br><span class="line">        ret = <span class="title class_">Java</span>.<span class="title function_">array</span>(<span class="string">&#x27;byte&#x27;</span>, buffer);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">	<span class="title function_">hook_dlopen</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook 结果如下</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2] appid=38741001&amp;svs=v3&amp;noncestr=52d7e0&amp;timestamp=1736841686&amp;secret=04fdc5e4d9c7420e896ee92b17c68e9f&amp;url=https://m.xiangdian.com/api/mshop/mshop-aggr-prod/outer/v1/material/create/createAuth?appid=38741001&amp;did=cf05095e7e5c4492023833c88e4701bd&amp;noncestr=52d7e0&amp;svs=v3&amp;timestamp=1736841686&amp;37a6259cc0c1dae299a7866489dff0bd</span><br><span class="line">retval: c8a8920fdb192fbff509a3fcc02a574387bba8387b3699c3b523f6b9a5f1a9bb</span><br><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2] appid=38741001&amp;svs=v3&amp;noncestr=dc5f62&amp;timestamp=1736841687&amp;secret=04fdc5e4d9c7420e896ee92b17c68e9f&amp;url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config?appid=38741001&amp;did=cf05095e7e5c4492023833c88e4701bd&amp;noncestr=dc5f62&amp;svs=v3&amp;timestamp=1736841687&amp;ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">retval: 374c820993d895d427540bc5a0416a20c0813b0050f9f2d547b6557531b587e3</span><br><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2] appid=38741001&amp;svs=v3&amp;noncestr=0446f5&amp;timestamp=1736841688&amp;secret=04fdc5e4d9c7420e896ee92b17c68e9f&amp;url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config?appid=38741001&amp;did=cf05095e7e5c4492023833c88e4701bd&amp;noncestr=0446f5&amp;svs=v3&amp;timestamp=1736841688&amp;ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">retval: cf733458b1142b469afbee61529ca5e37730c551ada13e8839cc390660c773db</span><br><span class="line">hooked</span><br><span class="line">args[1]: SHA256</span><br><span class="line">args[2] appid=38741001&amp;svs=v3&amp;noncestr=e8e90a&amp;timestamp=1736841688&amp;secret=04fdc5e4d9c7420e896ee92b17c68e9f&amp;url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config?appid=38741001&amp;did=cf05095e7e5c4492023833c88e4701bd&amp;noncestr=e8e90a&amp;svs=v3&amp;timestamp=1736841688&amp;ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line">retval: 8af4d51e17d8d8c1d9b3a0da22796ea52871bbeb27a630e74db97befce039814</span><br></pre></td></tr></table></figure>

<h1 id="参数还原"><a href="#参数还原" class="headerlink" title="参数还原"></a>参数还原</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_digest</span>(<span class="params">data</span>):</span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    result = md5.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://zuul.aikucun.com/appconfigmgt/api/v1/download/config&quot;</span></span><br><span class="line"></span><br><span class="line">body = <span class="string">&#x27;&#123;&quot;configKey&quot;:[&quot;versionUpdate&quot;],&quot;system&quot;:1,&quot;isShowUpdate&quot;:false,&quot;appId&quot;:&quot;com.aikucun.akapp&quot;,&quot;channel&quot;:&quot;2010&quot;,&quot;deviceModel&quot;:&quot;google-Pixel 3&quot;,&quot;buildCode&quot;:76302,&quot;version&quot;:&quot;7.63.2&quot;,&quot;userCode&quot;:&quot;&quot;,&quot;deviceBrand&quot;:&quot;Google&quot;&#125;&#x27;</span></span><br><span class="line">bodymd5 = md5_digest(body)</span><br><span class="line"></span><br><span class="line">uuid = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line">appid = <span class="string">&quot;38741001&quot;</span></span><br><span class="line">svs = <span class="string">&quot;v3&quot;</span></span><br><span class="line">noncestr = uuid[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">timestamp = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time()))</span><br><span class="line">secret = <span class="string">&quot;04fdc5e4d9c7420e896ee92b17c68e9f&quot;</span></span><br><span class="line">did = md5_digest(<span class="string">&quot;micker.cn&quot;</span>+uuid)</span><br><span class="line">cat_url = url+<span class="string">&quot;?&quot;</span>+<span class="string">&quot;appid=&quot;</span>+appid+<span class="string">&quot;&amp;did=&quot;</span>+did+<span class="string">&quot;&amp;noncestr=&quot;</span>+noncestr+<span class="string">&quot;&amp;svs=v3&quot;</span>+<span class="string">&quot;&amp;timestamp=&quot;</span>+timestamp+<span class="string">&quot;&amp;&quot;</span>+bodymd5</span><br><span class="line">sha256_str = <span class="string">&quot;appid=&quot;</span>+appid+<span class="string">&quot;&amp;svs=&quot;</span>+svs+<span class="string">&quot;&amp;noncestr=&quot;</span>+noncestr+<span class="string">&quot;&amp;timestamp=&quot;</span>+timestamp+<span class="string">&quot;&amp;secret=&quot;</span>+secret+<span class="string">&quot;&amp;url=&quot;</span>+cat_url</span><br><span class="line">sha256 = hashlib.sha256()</span><br><span class="line">sha256.update(sha256_str.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">sign = sha256.hexdigest()</span><br><span class="line"><span class="built_in">print</span>(sha256_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&quot;Auth-Token&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Pixel3 android 9 7.63.2 2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;token&quot;</span>: <span class="string">&quot;477c33c6-2f38-4363-a670-314393b47c1b&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-MODEL&quot;</span>: <span class="string">&quot;Pixel3&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-OS&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-OS-VERSION&quot;</span>: <span class="string">&quot;9&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-APP-VERSION&quot;</span>: <span class="string">&quot;7.63.2&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-APP-API-VERSION&quot;</span>: <span class="string">&quot;2.0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-APP-BUILD-VERSION&quot;</span>: <span class="string">&quot;76302&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-DID&quot;</span>: <span class="string">&quot;bedf28c355443e1f695fad8bed68fb62&quot;</span>,</span><br><span class="line">  <span class="string">&quot;AKC-APP-CHANNEL&quot;</span>: <span class="string">&quot;2010&quot;</span>,</span><br><span class="line">  <span class="string">&quot;applicationId&quot;</span>: <span class="string">&quot;com.aikucun.akapp&quot;</span>,</span><br><span class="line">  <span class="string">&quot;x-auth-token&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;live-channel&quot;</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line">  <span class="string">&quot;dtdToken&quot;</span>: <span class="string">&quot;6784f1da9Lvio98PqHQ7NhCTS4TB4ruXU4mwxoe3&quot;</span>,</span><br><span class="line">  <span class="string">&quot;app2H5Token&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;uid&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;subUid&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;APP-LOGIN-CHANNEL&quot;</span>: <span class="string">&quot;akcApp&quot;</span>,</span><br><span class="line">  <span class="string">&quot;app-request-id&quot;</span>: <span class="string">&quot;120883481161481b9ab275208092d108&quot;</span>,</span><br><span class="line">  <span class="string">&quot;PAGE-NAME&quot;</span>: <span class="string">&quot;%E7%99%BB%E5%BD%95&quot;</span>,</span><br><span class="line">  <span class="string">&quot;TRACKER-SESSION-ID&quot;</span>: <span class="string">&quot;0be8b952d15b980a&quot;</span>,</span><br><span class="line">  <span class="string">&quot;APP-USER-TYPE&quot;</span>: <span class="string">&quot;6&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json; charset=UTF-8&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Content-Length&quot;</span>: <span class="string">&quot;213&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;zuul.aikucun.com&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;Keep-Alive&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">  <span class="string">&quot;appid&quot;</span>: appid,</span><br><span class="line">  <span class="string">&quot;did&quot;</span>: did,</span><br><span class="line">  <span class="string">&quot;noncestr&quot;</span>: noncestr,</span><br><span class="line">  <span class="string">&quot;svs&quot;</span>: svs,</span><br><span class="line">  <span class="string">&quot;timestamp&quot;</span>: timestamp,</span><br><span class="line">  <span class="string">&quot;sign&quot;</span>: sign</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;configKey&quot;</span>: [</span><br><span class="line">    <span class="string">&quot;versionUpdate&quot;</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;system&quot;</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="string">&quot;isShowUpdate&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">  <span class="string">&quot;appId&quot;</span>: <span class="string">&quot;com.aikucun.akapp&quot;</span>,</span><br><span class="line">  <span class="string">&quot;channel&quot;</span>: <span class="string">&quot;2010&quot;</span>,</span><br><span class="line">  <span class="string">&quot;deviceModel&quot;</span>: <span class="string">&quot;google-Pixel 3&quot;</span>,</span><br><span class="line">  <span class="string">&quot;buildCode&quot;</span>: <span class="number">76302</span>,</span><br><span class="line">  <span class="string">&quot;version&quot;</span>: <span class="string">&quot;7.63.2&quot;</span>,</span><br><span class="line">  <span class="string">&quot;userCode&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;deviceBrand&quot;</span>: <span class="string">&quot;Google&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url=url,headers=headers,params=params,json=data)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">appid=<span class="number">38741001</span>&amp;svs=v3&amp;noncestr=ade8eb&amp;timestamp=<span class="number">1736844173</span>&amp;secret=04fdc5e4d9c7420e896ee92b17c68e9f&amp;url=https://zuul.aikucun.com/appconfigmgt/api/v1/download/config?appid=<span class="number">38741001</span>&amp;did=eb3be18635dec1ae73f3a0b86e81c982&amp;noncestr=ade8eb&amp;svs=v3&amp;timestamp=<span class="number">1736844173</span>&amp;ce10a5623f4ce537c8cbd4e306504860</span><br><span class="line"><span class="number">200</span></span><br><span class="line">&#123;<span class="string">&quot;code&quot;</span>:<span class="number">200</span>,<span class="string">&quot;data&quot;</span>:&#123;&#125;,<span class="string">&quot;message&quot;</span>:<span class="string">&quot;success&quot;</span>,<span class="string">&quot;status&quot;</span>:<span class="string">&quot;success&quot;</span>,<span class="string">&quot;success&quot;</span>:true&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/11/Android%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/11/Android%E7%B3%BB%E7%BB%9F%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">Android系统相关命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-11 18:40:52" itemprop="dateCreated datePublished" datetime="2025-01-11T18:40:52+08:00">2025-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-31 20:13:33" itemprop="dateModified" datetime="2025-01-31T20:13:33+08:00">2025-01-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android%E7%B3%BB%E7%BB%9F/" itemprop="url" rel="index"><span itemprop="name">Android系统</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>245</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="getprop"><a href="#getprop" class="headerlink" title="getprop"></a>getprop</h1><p><code>getprop</code> 是 Android 系统中常用的命令，用于获取设备的属性值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getprop [属性名]</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>无参数</strong>: 直接运行 <code>getprop</code>，会列出系统中所有的属性及其值。</p>
</li>
<li><p><strong>指定属性名</strong>: 指定某个属性名时，会返回该属性的值。</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">getprop ro.debuggable	# 检查当前 Android 设备是否处于可调试模式。（0为不可调试）</span><br><span class="line">getprop ro.serialno		# 获取设备的序列号</span><br><span class="line">getgrop wlan.lge.wifimac	# LG 安卓设备中用于存储 Wi-Fi 网卡 MAC 地址的系统属性。</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/11/Markdown%E8%AF%AD%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/11/Markdown%E8%AF%AD%E6%B3%95/" class="post-title-link" itemprop="url">Markdown语法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-11 16:05:04" itemprop="dateCreated datePublished" datetime="2025-01-11T16:05:04+08:00">2025-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-28 15:13:12" itemprop="dateModified" datetime="2025-01-28T15:13:12+08:00">2025-01-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Markdown%E8%AF%AD%E6%B3%95/" itemprop="url" rel="index"><span itemprop="name">Markdown语法</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>691</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Markdown是一种轻量级标记语言，使用易读易写的纯文本格式编写文档。</p>
<h1 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h1><h2 id="标题"><a href="#标题" class="headerlink" title="标题"></a>标题</h2><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#	    一级标题</span></span><br><span class="line"><span class="section">##	    二级标题</span></span><br><span class="line"><span class="section">###	    三级标题</span></span><br><span class="line"><span class="section">####	四级标题</span></span><br><span class="line"><span class="section">#####	五级标题</span></span><br><span class="line"><span class="section">######	六级标题</span></span><br></pre></td></tr></table></figure>

<h2 id="段落"><a href="#段落" class="headerlink" title="段落"></a>段落</h2><p>使用空白行来进行段落分隔。</p>
<h2 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h2><p>在一行的末尾添加两个空格，然后按回车键,即可创建一个换行。</p>
<h2 id="加粗文本"><a href="#加粗文本" class="headerlink" title="加粗文本"></a>加粗文本</h2><p>在文本的前后各添加两个星号或下划线。</p>
<h2 id="斜体"><a href="#斜体" class="headerlink" title="斜体"></a>斜体</h2><p>在文本前后添加一个星号或下划线。</p>
<h2 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h2><p>在段落前添加一个 <code>&gt;</code> 符号。</p>
<h2 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h2><p><strong>有序列表</strong></p>
<p>在每个列表项前添加数字并紧跟一个英文句点。</p>
<p><strong>无序列表</strong></p>
<p>在每个列表项前面添加破折号 (-)、星号 (*) 或加号 (+) 。</p>
<h2 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h2><p>要将单词或短语表示为代码，将其包裹在反引号 &#96;&#96;&#96; 中。</p>
<h2 id="分隔线"><a href="#分隔线" class="headerlink" title="分隔线"></a>分隔线</h2><p>在单独一行上使用三个或多个星号 (<code>***</code>)、破折号 (<code>---</code>) 或下划线 (<code>___</code>) ，并且不能包含其他内容。</p>
<h2 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[超链接显示名](超链接地址 &quot;超链接title&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![图片alt](图片链接 &quot;图片title&quot;)</span><br></pre></td></tr></table></figure>

<h1 id="数学公式"><a href="#数学公式" class="headerlink" title="数学公式"></a>数学公式</h1><ul>
<li><p><strong>行内公式：</strong> 使用<code>$</code>包裹公式</p>
</li>
<li><p><strong>独立公式：</strong> 使用<code>$$</code>包裹公式</p>
</li>
</ul>
<h2 id="上下标"><a href="#上下标" class="headerlink" title="上下标"></a>上下标</h2><p>上下标分别使用^和_表示。例如：</p>
<p><code>$x^2$</code> $\rightarrow$ $x^2$</p>
<p><code>$x_2$</code> $ \rightarrow$$x_2$</p>
<h2 id="分数"><a href="#分数" class="headerlink" title="分数"></a>分数</h2><ul>
<li><p>第一种</p>
<p>  <code>$\frac &#123;a&#125;&#123;b&#125;$</code>$ \rightarrow$$\frac {a}{b}$</p>
</li>
<li><p>第二种</p>
<p>  <code>$\over$</code> $ \rightarrow$ $a+1 \over b+1$</p>
</li>
</ul>
<h2 id="数学运算符"><a href="#数学运算符" class="headerlink" title="数学运算符"></a>数学运算符</h2><p><code>$\sum$</code> $ \rightarrow$ $\sum$</p>
<h2 id="标注"><a href="#标注" class="headerlink" title="标注"></a>标注</h2><p><code>$\hat&#123;x&#125;$</code>  $ \rightarrow$ $\hat{x}$</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/08/Numpy/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/08/Numpy/" class="post-title-link" itemprop="url">Numpy</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-08 11:58:22" itemprop="dateCreated datePublished" datetime="2025-01-08T11:58:22+08:00">2025-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-11 11:03:43" itemprop="dateModified" datetime="2025-01-11T11:03:43+08:00">2025-01-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.6k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装模块"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install numpy</span><br></pre></td></tr></table></figure>

<h2 id="创建数组"><a href="#创建数组" class="headerlink" title="创建数组"></a>创建数组</h2><h3 id="array"><a href="#array" class="headerlink" title="array()"></a>array()</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.array(<span class="built_in">object</span>, dtype=<span class="literal">None</span>, copy=<span class="literal">True</span>, order=<span class="string">&#x27;K&#x27;</span>, subok=<span class="literal">False</span>, ndmin=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong><code>object</code></strong>: 必需。输入数据，例如列表、元组、嵌套列表等。</p>
</li>
<li><p><strong><code>dtype</code></strong>: 数据类型（如 <code>int</code>, <code>float</code>, <code>complex</code> 等）。默认为自动推断。</p>
</li>
<li><p><strong><code>copy</code></strong>: 是否复制输入数据，默认为 <code>True</code>。</p>
</li>
<li><p><strong><code>order</code></strong>: 内存存储顺序：</p>
<ul>
<li><p><code>&#39;C&#39;</code>：按行优先（C-style，默认）。</p>
</li>
<li><p><code>&#39;F&#39;</code>：按列优先（Fortran-style）。</p>
</li>
</ul>
</li>
<li><p><strong><code>subok</code></strong>: 如果为 <code>True</code>，生成的数组会继承输入数据的子类，否则始终返回基础类 <code>ndarray</code>。</p>
</li>
<li><p><strong><code>ndmin</code></strong>: 指定返回数组的最小维度。</p>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(a))</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">&lt;<span class="keyword">class</span> <span class="string">&#x27;numpy.ndarray&#x27;</span>&gt;</span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br></pre></td></tr></table></figure>



<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">b = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">4</span>]]</span><br></pre></td></tr></table></figure>

<h3 id="shape"><a href="#shape" class="headerlink" title="shape"></a>shape</h3><p><strong><code>shape</code></strong> 是一个属性，用于返回数组的形状（即各维度的大小）。</p>
<p>它以元组的形式表示，元组中的每个值表示数组在该维度的大小。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">b = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line"><span class="built_in">print</span>(b.shape)</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">(<span class="number">2</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h3 id="arange"><a href="#arange" class="headerlink" title="arange()"></a>arange()</h3><p><code>arange()</code> 函数用于生成一个指定范围内的等差数列数组。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.arange([start, ]stop, [step, ]dtype=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong><code>start</code></strong>: 范围的起始值（可选）。默认是 <code>0</code>。</p>
</li>
<li><p><strong><code>stop</code></strong>: 范围的结束值（不包括该值）。</p>
</li>
<li><p><strong><code>step</code></strong>: 步长（可选）。默认为 <code>1</code>。可以是浮点数。</p>
</li>
<li><p><strong><code>dtype</code></strong>: 返回数组的数据类型（可选）。默认会根据输入类型推断。</p>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从 0 到 9 的整数数组</span></span><br><span class="line">a = np.arange(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(a)  <span class="comment"># 输出: [0 1 2 3 4 5 6 7 8 9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从 1 到 9 的整数数组</span></span><br><span class="line">b = np.arange(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(b)  <span class="comment"># 输出: [1 2 3 4 5 6 7 8 9]</span></span><br></pre></td></tr></table></figure>



<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从 1 到 9，步长为 2</span></span><br><span class="line">c = np.arange(<span class="number">1</span>, <span class="number">10</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(c)  <span class="comment"># 输出: [1 3 5 7 9]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 从 10 到 0，步长为 -2</span></span><br><span class="line">d = np.arange(<span class="number">10</span>, <span class="number">0</span>, -<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(d)  <span class="comment"># 输出: [10 8 6 4 2]</span></span><br></pre></td></tr></table></figure>

<h3 id="random"><a href="#random" class="headerlink" title="random"></a>random</h3><p>numpy的random模块提供了多种功能，用于生成随机数和进行随机操作。</p>
<h4 id="rand"><a href="#rand" class="headerlink" title="rand()"></a>rand()</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.random.rand(d0, d1, ..., dn)</span><br></pre></td></tr></table></figure>

<p><code>rand()</code> 函数用于生成 [0, 1) 之间均匀分布的随机浮点数。它接受一个或多个整数参数，这些参数指定了输出数组的形状。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">a = np.random.rand(1,2,3)</span><br><span class="line">print(a)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[[0.10311541 0.37724536 0.0200087 ]</span><br><span class="line">  [0.68078737 0.54724305 0.73788641]]]</span><br></pre></td></tr></table></figure>

<h4 id="random-1"><a href="#random-1" class="headerlink" title="random()"></a>random()</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numpy.random.random(size=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line">size：指定输出数组的形状，可以是整数或元组。如果为 <span class="literal">None</span>，则返回一个标量。</span><br></pre></td></tr></table></figure>

<p><code>random()</code>函数用于生成 [0, 1) 之间的均匀分布随机数。它不接受维度参数，而是直接返回一个形状由参数决定的数组。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">a = np.random.random(size=(<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">0.27557538</span> <span class="number">0.78651989</span> <span class="number">0.21555761</span>]</span><br><span class="line"> [<span class="number">0.07048964</span> <span class="number">0.05920274</span> <span class="number">0.36977286</span>]]</span><br></pre></td></tr></table></figure>



<h4 id="randint"><a href="#randint" class="headerlink" title="randint()"></a>randint()</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.random.randint(low, high=<span class="literal">None</span>, size=<span class="literal">None</span>, dtype=<span class="built_in">int</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong><code>low</code></strong>: 生成随机整数的下界（包含）。</p>
</li>
<li><p><strong><code>high</code></strong>: 生成随机整数的上界（不包含）。如果未提供 <code>high</code>，则默认生成 0 到 <code>low</code> 的随机整数。</p>
</li>
<li><p><strong><code>size</code></strong>: 输出数组的形状。如果是整数，返回一个该形状的数组；如果是元组，返回对应维度的数组。</p>
</li>
<li><p><strong><code>dtype</code></strong>: 输出数组的数据类型，默认为 <code>int</code>。</p>
</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成一个长度为 5 的一维数组，值范围在 [10, 50) 之间</span></span><br><span class="line">e = np.random.randint(<span class="number">10</span>, <span class="number">50</span>, <span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(e)  <span class="comment"># 输出类似: [28 31 11 45 39]</span></span><br></pre></td></tr></table></figure>

<h4 id="randn"><a href="#randn" class="headerlink" title="randn()"></a>randn()</h4><p><code>numpy.random.randn()</code> 是一个用于生成标准正态分布（均值为 0，标准差为 1）的随机数的函数。与其他生成随机数的函数不同，<code>randn()</code> 生成的数值并不受指定范围的限制，而是符合标准正态分布。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.random.randn(d0, d1, ..., dn)</span><br></pre></td></tr></table></figure>

<p><strong><code>d0, d1, ..., dn</code></strong>: 指定输出数组的形状。如果没有传入任何参数，则生成一个标量（单个值）。</p>
<h4 id="normal"><a href="#normal" class="headerlink" title="normal()"></a>normal()</h4><p><code>numpy.random.normal()</code> 是一个用于生成正态分布（高斯分布）随机数的函数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.random.normal(loc=0.0, scale=1.0, size=None)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong><code>loc</code></strong>: 正态分布的均值（默认为 0.0）。</p>
</li>
<li><p><strong><code>scale</code></strong>: 正态分布的标准差（默认为 1.0）。标准差决定了数据的分布宽度。</p>
</li>
<li><p><strong><code>size</code></strong>: 输出数组的形状。如果是单个整数，则生成一个具有该长度的一维数组；如果是元组，则生成一个形状为元组的多维数组。</p>
</li>
</ul>
<h3 id="copy"><a href="#copy" class="headerlink" title="copy()"></a>copy()</h3><p><code>copy()</code> 函数用于创建数组的副本。</p>
<p>这是一个深拷贝操作，它会分配一个全新的内存空间，并复制原数组的所有数据。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.ndarray.copy(order=<span class="string">&#x27;C&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong><code>order</code></strong>: 决定数组在内存中的存储顺序（可选，默认值为 <code>&#39;C&#39;</code>）。</p>
<ul>
<li><code>&#39;C&#39;</code>: 按行存储（C 风格）。</li>
<li><code>&#39;F&#39;</code>: 按列存储（Fortran 风格）。</li>
<li><code>&#39;A&#39;</code>: 如果原数组是按行存储，则返回按行存储的副本；如果是按列存储，则返回按列存储的副本。</li>
<li><code>&#39;K&#39;</code>: 尽可能保留原数组的存储顺序。</li>
</ul>
<h2 id="ndarray对象"><a href="#ndarray对象" class="headerlink" title="ndarray对象"></a>ndarray对象</h2><p><code>ndarray</code> 是 NumPy 中的核心对象，它是一个多维数组，能够高效地存储和操作同类型的数据。</p>
<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><h4 id="shape-1"><a href="#shape-1" class="headerlink" title="shape"></a>shape</h4><p>数组的维度</p>
<h4 id="ndim"><a href="#ndim" class="headerlink" title="ndim"></a>ndim</h4><p>数组的维度数</p>
<h4 id="size"><a href="#size" class="headerlink" title="size"></a>size</h4><p>数组的元素总数</p>
<h4 id="dtype"><a href="#dtype" class="headerlink" title="dtype"></a>dtype</h4><p>数组的元素类型</p>
<h4 id="itemsize"><a href="#itemsize" class="headerlink" title="itemsize"></a>itemsize</h4><p>数组中每个元素的大小，以字节为单位</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><h4 id="reshape"><a href="#reshape" class="headerlink" title="reshape()"></a>reshape()</h4><p>通过 <code>reshape</code>方法，可以将一个数组转换成任意指定的形状，只要新形状与原数组的元素总数相同。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndarray.reshape(shape, order=&#x27;C&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong><code>shape</code></strong>: 指定新的形状，必须是一个整数元组，形状的各个维度大小的乘积需要与原数组的总元素数一致。</p>
</li>
<li><p><strong><code>order</code></strong>: 表示读取和写入元素的顺序，默认是行优先（<code>C</code> 风格）。</p>
<ul>
<li><p><code>&#39;C&#39;</code>: 按行（C 风格）读取数据。</p>
</li>
<li><p><code>&#39;F&#39;</code>: 按列（Fortran 风格）读取数据。</p>
</li>
<li><p><code>&#39;A&#39;</code>: 如果数组存储在内存中是按行顺序，等同于 <code>&#39;C&#39;</code>；如果是按列顺序，等同于 <code>&#39;F&#39;</code>。</p>
</li>
</ul>
</li>
</ul>
<p><code>reshape</code> 不会修改原数组，它返回的是一个新的数组。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一维数组</span></span><br><span class="line">arr = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为二维数组</span></span><br><span class="line">reshaped_arr = arr.reshape((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(reshaped_arr)</span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># [[1 2 3]</span></span><br><span class="line"><span class="comment">#  [4 5 6]]</span></span><br></pre></td></tr></table></figure>

<h4 id="ravel"><a href="#ravel" class="headerlink" title="ravel()"></a>ravel()</h4><p><code>ravel()</code> 方法用于将多维数组展平为一维数组。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ndarray.ravel(order=&#x27;C&#x27;)</span><br></pre></td></tr></table></figure>

<p><strong><code>order</code></strong>: 指定展平的顺序（可选，默认值为 <code>&#39;C&#39;</code>）。</p>
<ul>
<li><code>&#39;C&#39;</code>: 按行优先（C 风格）展平数据。</li>
<li><code>&#39;F&#39;</code>: 按列优先（Fortran 风格）展平数据。</li>
<li><code>&#39;A&#39;</code>: 如果数组是按行存储，等同于 <code>&#39;C&#39;</code>；如果是按列存储，等同于 <code>&#39;F&#39;</code>。</li>
<li><code>&#39;K&#39;</code>: 尽可能保留原数组的存储顺序。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建二维数组</span></span><br><span class="line">arr = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 展平数组</span></span><br><span class="line">flattened_arr = arr.ravel()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Original Array:\n&quot;</span>, arr)</span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># [[1 2 3]</span></span><br><span class="line"><span class="comment">#  [4 5 6]]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flattened Array:&quot;</span>, flattened_arr)</span><br><span class="line"><span class="comment"># 输出: Flattened Array: [1 2 3 4 5 6]</span></span><br></pre></td></tr></table></figure>

<h4 id="flatten"><a href="#flatten" class="headerlink" title="flatten()"></a>flatten()</h4><p><code>flatten()</code> 是一种将多维数组展平为一维数组的方法。</p>
<p>与 <code>ravel()</code> 不同，<code>flatten()</code> 总是返回数组的<strong>深拷贝</strong>，即它会创建一个全新的数组对象，因此对返回结果的修改不会影响原始数组。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建二维数组</span></span><br><span class="line">arr = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 ravel</span></span><br><span class="line">ravel_arr = arr.ravel()</span><br><span class="line">ravel_arr[<span class="number">0</span>] = <span class="number">99</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Modified ravel Array:&quot;</span>, ravel_arr)</span><br><span class="line"><span class="comment"># 输出: [99  2  3  4  5  6]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Original Array:\n&quot;</span>, arr)  <span class="comment"># 原数组被修改</span></span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># [[99  2  3]</span></span><br><span class="line"><span class="comment">#  [ 4  5  6]]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 flatten</span></span><br><span class="line">flatten_arr = arr.flatten()</span><br><span class="line">flatten_arr[<span class="number">0</span>] = <span class="number">88</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Modified flatten Array:&quot;</span>, flatten_arr)</span><br><span class="line"><span class="comment"># 输出: [88  2  3  4  5  6]</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Original Array:\n&quot;</span>, arr)  <span class="comment"># 原数组未被修改</span></span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># [[99  2  3]</span></span><br><span class="line"><span class="comment">#  [ 4  5  6]]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h4 id="切片和索引"><a href="#切片和索引" class="headerlink" title="切片和索引"></a>切片和索引</h4> <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">arr = np.arange(<span class="number">1</span>,<span class="number">10</span>)</span><br><span class="line">arr_r=arr.reshape(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(arr_r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> arr_r:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(arr_r[<span class="number">1</span>:<span class="number">3</span>,<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]]</span><br><span class="line"></span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line">[<span class="number">4</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line">[<span class="number">7</span> <span class="number">8</span> <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">[[<span class="number">5</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">8</span> <span class="number">9</span>]]</span><br></pre></td></tr></table></figure>

<h2 id="数组的拼接"><a href="#数组的拼接" class="headerlink" title="数组的拼接"></a>数组的拼接</h2><h3 id="hstack"><a href="#hstack" class="headerlink" title="hstack()"></a>hstack()</h3><p><code>np.hstack()</code>是一个水平拼接（按列方向）函数。</p>
<p>它将多个数组沿水平方向（即列方向，<code>axis=1</code>）进行拼接，所有输入数组的行数（第一维大小）必须相同。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.hstack((arr1, arr2, ...))</span><br></pre></td></tr></table></figure>

<p><strong>参数</strong></p>
<p>**<code>arr1, arr2, ...</code>**：需要拼接的数组（可以是列表、元组或其他数组）。</p>
<ul>
<li>输入数组的<strong>行数必须相同</strong>。</li>
</ul>
<p><strong>返回值</strong></p>
<ul>
<li>返回一个新数组，表示输入数组沿水平方向的拼接结果。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义两个二维数组</span></span><br><span class="line">arr1 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">arr2 = np.array([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 水平拼接</span></span><br><span class="line">result = np.hstack((arr1, arr2))</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># [[1 2 5 6]</span></span><br><span class="line"><span class="comment">#  [3 4 7 8]]</span></span><br></pre></td></tr></table></figure>

<h3 id="vstack"><a href="#vstack" class="headerlink" title="vstack()"></a>vstack()</h3><p><code>np.vstack()</code>用于垂直拼接（按行方向）的函数。</p>
<p>它将多个数组沿垂直方向（即行方向，<code>axis=0</code>）进行堆叠。所有输入数组的列数（第二维大小）必须相同。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.vstack((arr1, arr2, ...))</span><br></pre></td></tr></table></figure>

<p><strong>参数</strong></p>
<p><code>arr1, arr2, ...</code>需要拼接的数组（可以是列表、元组或其他数组）。</p>
<ul>
<li>输入数组的<strong>列数必须相同</strong>。</li>
</ul>
<p><strong>返回值</strong></p>
<ul>
<li>返回一个新数组，表示输入数组沿垂直方向堆叠的结果。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义两个二维数组</span></span><br><span class="line">arr1 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">arr2 = np.array([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>,<span class="number">8</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 垂直拼接</span></span><br><span class="line">result = np.vstack((arr1, arr2))</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"><span class="comment"># 输出:</span></span><br><span class="line"><span class="comment"># [[1 2]</span></span><br><span class="line"><span class="comment">#  [3 4]</span></span><br><span class="line"><span class="comment">#  [5 6]</span></span><br><span class="line"><span class="comment">#  [7 8]]</span></span><br></pre></td></tr></table></figure>

<h3 id="concatenate"><a href="#concatenate" class="headerlink" title="concatenate()"></a>concatenate()</h3><p><code>np.concatenate()</code>函数用于将多个数组沿指定轴（行或者列）进行拼接。它比 <code>vstack</code> 和 <code>hstack</code> 更加灵活，因为它可以拼接任意维度的数组，并且通过指定 <code>axis</code> 参数来决定拼接的方向。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.concatenate((arr1, arr2, ...), axis=<span class="number">0</span>, out=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a><strong>参数</strong></h4><ul>
<li>**<code>arr1, arr2, ...</code>**：要拼接的数组（可以是多个数组）。</li>
<li>**<code>axis</code>**：拼接的轴。默认为 <code>0</code>，表示沿行方向拼接。如果为 <code>1</code>，则表示沿列方向拼接。</li>
<li>**<code>out</code>**：可选参数，用于指定输出数组的存放位置。</li>
</ul>
<h4 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a><strong>返回值</strong></h4><ul>
<li>返回一个拼接后的新数组。</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])  <span class="comment"># 第一块数组</span></span><br><span class="line">arr2 = np.array([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]])  <span class="comment"># 第二块数组</span></span><br><span class="line"></span><br><span class="line">result = np.concatenate((arr1, arr2), axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">7</span> <span class="number">8</span>]]</span><br></pre></td></tr></table></figure>



<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr1 = np.array([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])  <span class="comment"># 第一块数组</span></span><br><span class="line">arr2 = np.array([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]])  <span class="comment"># 第二块数组</span></span><br><span class="line"></span><br><span class="line">result = np.concatenate((arr1, arr2), axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">5</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">4</span> <span class="number">7</span> <span class="number">8</span>]]</span><br></pre></td></tr></table></figure>

<h2 id="数组的拆分"><a href="#数组的拆分" class="headerlink" title="数组的拆分"></a>数组的拆分</h2><h3 id="split"><a href="#split" class="headerlink" title="split()"></a>split()</h3><p> <code>np.split</code> 是用于拆分数组的函数。</p>
<p>它将一个数组按照指定的分割点拆成多个子数组。</p>
<p>可以选择按照沿着哪个轴拆分数组，并指定拆分点的位置。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numpy.split(ary, indices_or_sections, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<p><strong>参数</strong></p>
<ul>
<li>**<code>ary</code>**：要拆分的数组。</li>
<li><code>indices_or_sections</code>：<ul>
<li><strong>整数</strong>：表示将数组分成多少个部分。比如，<code>3</code> 就表示将数组均匀拆分成 3 个部分。</li>
<li><strong>数组</strong>：表示在指定的索引位置进行拆分。如果传入的是一个数组，数组中的每个元素就是一个拆分点。</li>
</ul>
</li>
<li>**<code>axis</code>**：拆分的轴，默认为 0，即沿着行方向拆分。如果指定 <code>axis=1</code>，则表示沿着列方向拆分。</li>
</ul>
<p><strong>返回值</strong></p>
<ul>
<li>返回一个列表，包含拆分后的多个子数组。</li>
</ul>
<p><strong>行方向拆分</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">result = np.split(arr, <span class="number">3</span>, axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]), array([[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]]), array([[<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])]</span><br></pre></td></tr></table></figure>



<p><strong>列方向拆分</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">arr = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">result = np.split(arr, <span class="number">3</span>, axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[array([[<span class="number">1</span>],</span><br><span class="line">       [<span class="number">4</span>],</span><br><span class="line">       [<span class="number">7</span>]]), array([[<span class="number">2</span>],</span><br><span class="line">       [<span class="number">5</span>],</span><br><span class="line">       [<span class="number">8</span>]]), array([[<span class="number">3</span>],</span><br><span class="line">       [<span class="number">6</span>],</span><br><span class="line">       [<span class="number">9</span>]])]</span><br></pre></td></tr></table></figure>

<h2 id="数组的转置"><a href="#数组的转置" class="headerlink" title="数组的转置"></a>数组的转置</h2><h3 id="transpose"><a href="#transpose" class="headerlink" title="transpose()"></a>transpose()</h3><p><code>np.transpose()</code> 函数用于对数组进行转置操作。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">arr = np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]])</span><br><span class="line"><span class="built_in">print</span>(np.transpose(arr))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">[[<span class="number">1</span> <span class="number">4</span> <span class="number">7</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">5</span> <span class="number">8</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">6</span> <span class="number">9</span>]]</span><br></pre></td></tr></table></figure>

<h2 id="算术运算"><a href="#算术运算" class="headerlink" title="算术运算"></a>算术运算</h2><h2 id="聚合函数"><a href="#聚合函数" class="headerlink" title="聚合函数"></a>聚合函数</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/08/%E9%AB%98%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7%E9%9B%86%E5%90%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/08/%E9%AB%98%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7%E9%9B%86%E5%90%88/" class="post-title-link" itemprop="url">高效率工具集合</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-08 00:17:08" itemprop="dateCreated datePublished" datetime="2025-01-08T00:17:08+08:00">2025-01-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-09 17:58:07" itemprop="dateModified" datetime="2025-02-09T17:58:07+08:00">2025-02-09</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%AB%98%E6%95%88%E7%8E%87%E5%B7%A5%E5%85%B7%E5%90%88%E9%9B%86/" itemprop="url" rel="index"><span itemprop="name">高效率工具合集</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>495</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Everything"><a href="#Everything" class="headerlink" title="Everything"></a>Everything</h1><p>一个强大的文件搜索工具，快速定位计算机上的文件和文件夹。</p>
<h1 id="Snipast"><a href="#Snipast" class="headerlink" title="Snipast"></a>Snipast</h1><p>一个简单但强大的截图工具，也可以让你将截图贴回到屏幕上！</p>
<ul>
<li><code>F1</code>截图</li>
<li>按下<code>F1</code>，再按下<code>F3</code>，截图就可以在桌面置顶显示</li>
</ul>
<h1 id="PixPin"><a href="#PixPin" class="headerlink" title="PixPin"></a>PixPin</h1><p>随心截图, 随意贴图。</p>
<p>屏幕截图，录制屏幕，长截图，文字识别，贴图，以及更多功能。</p>
<h1 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h1><p>一款 Markdown 编辑器和阅读器。</p>
<h1 id="VSCode"><a href="#VSCode" class="headerlink" title="VSCode"></a>VSCode</h1><p>轻量级代码编辑器。</p>
<h1 id="PotPlayer"><a href="#PotPlayer" class="headerlink" title="PotPlayer"></a>PotPlayer</h1><p>一款免费的多媒体播放器，支持各种视频编解码器和格式。</p>
<h1 id="Maye-Lite"><a href="#Maye-Lite" class="headerlink" title="Maye Lite"></a>Maye Lite</h1><p>简洁的快速启动工具。</p>
<h1 id="IDM"><a href="#IDM" class="headerlink" title="IDM"></a>IDM</h1><p>下载加速器。</p>
<h1 id="SpaceSniffer"><a href="#SpaceSniffer" class="headerlink" title="SpaceSniffer"></a>SpaceSniffer</h1><p>一款免费且便携的磁盘空间分析工具。</p>
<h1 id="Xmind"><a href="#Xmind" class="headerlink" title="Xmind"></a>Xmind</h1><p>思维导图软件。</p>
<h2 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h2><ul>
<li><p><strong>Ctrl+N</strong></p>
<p>  新建思维导图</p>
</li>
<li><p><strong>Ctrl+O</strong></p>
<p>  打开思维导图</p>
</li>
<li><p><strong>Ctrl+T</strong></p>
<p>  新建标签页面</p>
</li>
<li><p><strong>Tab</strong></p>
<p>  添加子主题</p>
</li>
<li><p><strong>Ctrl+Shift</strong></p>
<p>  添加父主题</p>
</li>
<li><p><strong>Enter&#x2F;Shift Enter</strong></p>
<p>  插入主题</p>
</li>
</ul>
<h1 id="Cyberchef"><a href="#Cyberchef" class="headerlink" title="Cyberchef"></a>Cyberchef</h1><p>CyberChef 是一个功能强大的在线工具，用于执行各种数据处理和分析任务，特别适用于安全研究、数字取证、密码学分析、数据转换和加密解密等方面。</p>
<h1 id="浏览器拓展插件"><a href="#浏览器拓展插件" class="headerlink" title="浏览器拓展插件"></a>浏览器拓展插件</h1><h2 id="ADGUARD"><a href="#ADGUARD" class="headerlink" title="ADGUARD"></a>ADGUARD</h2><p>广告拦截器</p>
<h2 id="网盘直链下载助手"><a href="#网盘直链下载助手" class="headerlink" title="网盘直链下载助手"></a>网盘直链下载助手</h2><p>可以在web端下载网盘文件</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/" class="post-title-link" itemprop="url">豆瓣frida检测绕过及搜索接口参数还原</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-07 18:33:18" itemprop="dateCreated datePublished" datetime="2025-01-07T18:33:18+08:00">2025-01-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-08 11:14:47" itemprop="dateModified" datetime="2025-01-08T11:14:47+08:00">2025-01-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E6%A1%88%E4%BE%8B/" itemprop="url" rel="index"><span itemprop="name">逆向实战案例</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>12k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>11 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="App信息"><a href="#App信息" class="headerlink" title="App信息"></a>App信息</h1><p>包名：com.douban.frodo</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/1.png" alt="1"></p>
<h1 id="frida反调试绕过"><a href="#frida反调试绕过" class="headerlink" title="frida反调试绕过"></a>frida反调试绕过</h1><p>首先尝试注入frida，发现直接就挂掉了，说明frida被检测到了</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/2.jpg" alt="1"></p>
<h2 id="定位检测frida的so"><a href="#定位检测frida的so" class="headerlink" title="定位检测frida的so"></a>定位检测frida的so</h2><p>hook dlopen查看so加载流程，看在加载哪一个so的时候挂掉的，说明检测frida的函数在那个so里。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_dlopen</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//Android8.0之后加载so通过android_dlopen_ext函数</span></span><br><span class="line">    <span class="keyword">var</span> android_dlopen_ext = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>,<span class="string">&quot;android_dlopen_ext&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr_android_dlopen_ext&quot;</span>,android_dlopen_ext);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(android_dlopen_ext,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> pathptr = args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(pathptr!=<span class="literal">null</span> &amp;&amp; pathptr != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> path = <span class="title function_">ptr</span>(pathptr).<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;android_dlopen_ext:&quot;</span>,path);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retvel</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;leave!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_dlopen</span>()</span><br></pre></td></tr></table></figure>

<p>根据hook的输出可以知道，在加载<code>libmsaoaidsec.so</code>之后，frida就挂掉了，说明是在<code>libmsaoaidsec.so</code>里检测的frida。</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/3.jpg" alt="1"></p>
<h2 id="定位检测frida的函数地址，并进行替换"><a href="#定位检测frida的函数地址，并进行替换" class="headerlink" title="定位检测frida的函数地址，并进行替换"></a>定位检测frida的函数地址，并进行替换</h2><p>根据so的加载流程，<code>call_construction()</code>函数用来确保动态库中的函数得到加载并执行，在<code>call_construction()</code>函数里会调用一个<code>init_array()</code>函数，它包含了一组指向函数的指针，用于对函数进行初始化，在so加载完成之后，会调用<code>JNI_OnLoad()</code>函数，用于进行 JNI 环境的初始化、注册本地方法。</p>
<h3 id="hook-pthread-create"><a href="#hook-pthread-create" class="headerlink" title="hook pthread_create()"></a>hook pthread_create()</h3><p>检测frida的函数通常不会在主线程中，我们可以通过hook pthread_create()函数来打印线程中创建的函数的地址</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_dlopen</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//Android8.0之后加载so通过android_dlopen_ext函数</span></span><br><span class="line">    <span class="keyword">var</span> android_dlopen_ext = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>,<span class="string">&quot;android_dlopen_ext&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr_android_dlopen_ext&quot;</span>,android_dlopen_ext);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(android_dlopen_ext,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> pathptr = args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(pathptr!=<span class="literal">null</span> &amp;&amp; pathptr != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> path = <span class="title function_">ptr</span>(pathptr).<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="keyword">if</span>(path.<span class="title function_">indexOf</span>(<span class="string">&quot;libmsaoaidsec.so&quot;</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;android_dlopen_ext:&quot;</span>,path);</span><br><span class="line">                    <span class="title function_">hook_pthread</span>()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retvel</span>)&#123;</span><br><span class="line">            <span class="comment">// console.log(&quot;leave!&quot;);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_pthread</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> pth_create = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="string">&quot;libc.so&quot;</span>, <span class="string">&quot;pthread_create&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;[pth_create]&quot;</span>, pth_create);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(pth_create, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> <span class="variable language_">module</span> = <span class="title class_">Process</span>.<span class="title function_">findModuleByAddress</span>(args[<span class="number">2</span>]);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">module</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;address&quot;</span>, <span class="variable language_">module</span>.<span class="property">name</span>, args[<span class="number">2</span>].<span class="title function_">sub</span>(<span class="variable language_">module</span>.<span class="property">base</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>: <span class="keyword">function</span> (<span class="params">retval</span>) &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">hook_dlopen</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p>结果如下，在<code>libmsaoaidsec.so</code>里创建了三个函数</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/4.jpg" alt="1"></p>
<h3 id="hook-call-construction"><a href="#hook-call-construction" class="headerlink" title="hook call_construction()"></a>hook call_construction()</h3><p>可以通过hook call_construction()这个函数来对pthread_create()中创建的函数进行替换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_dlopen</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//Android8.0之后加载so通过android_dlopen_ext函数</span></span><br><span class="line">    <span class="keyword">var</span> android_dlopen_ext = <span class="title class_">Module</span>.<span class="title function_">findExportByName</span>(<span class="literal">null</span>,<span class="string">&quot;android_dlopen_ext&quot;</span>);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;addr_android_dlopen_ext&quot;</span>,android_dlopen_ext);</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(android_dlopen_ext,&#123;</span><br><span class="line">        <span class="attr">onEnter</span>:<span class="keyword">function</span>(<span class="params">args</span>)&#123;</span><br><span class="line">            <span class="keyword">var</span> pathptr = args[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">if</span>(pathptr!=<span class="literal">null</span> &amp;&amp; pathptr != <span class="literal">undefined</span>)&#123;</span><br><span class="line">                <span class="keyword">var</span> path = <span class="title function_">ptr</span>(pathptr).<span class="title function_">readCString</span>();</span><br><span class="line">                <span class="keyword">if</span>(path.<span class="title function_">indexOf</span>(<span class="string">&quot;libmsaoaidsec.so&quot;</span>)!=-<span class="number">1</span>)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;android_dlopen_ext:&quot;</span>,path);</span><br><span class="line">                    <span class="title function_">hook_call_constructors</span>()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onLeave</span>:<span class="keyword">function</span>(<span class="params">retvel</span>)&#123;</span><br><span class="line">            <span class="comment">//console.log(&quot;leave!&quot;);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hook_call_constructors</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> linker64_base_addr = <span class="title class_">Module</span>.<span class="title function_">getBaseAddress</span>(<span class="string">&quot;linker64&quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> call_constructors_func_off = <span class="number">0x2C274</span> <span class="comment">//这个地址是从手机上把linker64 pull出来，然后到IDA中找到的，不同的机型，地址可能不一样</span></span><br><span class="line">    <span class="keyword">var</span> call_constructors_func_addr = linker64_base_addr.<span class="title function_">add</span>(call_constructors_func_off)</span><br><span class="line">    <span class="keyword">var</span> listener = <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(call_constructors_func_addr, &#123;</span><br><span class="line">        <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hooked call_constructors&quot;</span>)</span><br><span class="line">            <span class="keyword">var</span> <span class="variable language_">module</span> = <span class="title class_">Process</span>.<span class="title function_">findModuleByName</span>(<span class="string">&quot;libmsaoaidsec.so&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">module</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(<span class="variable language_">module</span>.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x1c544</span>), <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;0x1c544:替换成功&quot;</span>)</span><br><span class="line">                &#125;, <span class="string">&quot;void&quot;</span>, []))</span><br><span class="line">                <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(<span class="variable language_">module</span>.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x1b924</span>), <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;0x1B924:替换成功&quot;</span>)</span><br><span class="line">                &#125;, <span class="string">&quot;void&quot;</span>, []))</span><br><span class="line">                <span class="title class_">Interceptor</span>.<span class="title function_">replace</span>(<span class="variable language_">module</span>.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x26e5c</span>), <span class="keyword">new</span> <span class="title class_">NativeCallback</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;0x26e5c:替换成功&quot;</span>)</span><br><span class="line">                &#125;, <span class="string">&quot;void&quot;</span>, []))</span><br><span class="line">                listener.<span class="title function_">detach</span>()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">hook_dlopen</span>()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>

<p>结果如下，frida反调试绕过成功了！</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/5.jpg" alt="1"></p>
<h1 id="sign参数还原"><a href="#sign参数还原" class="headerlink" title="_sign参数还原"></a>_sign参数还原</h1><h2 id="抓包分析"><a href="#抓包分析" class="headerlink" title="抓包分析"></a>抓包分析</h2><p>通过抓包找到有关<code>_sig</code>参数的数据包</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/6.jpg" alt="1"></p>
<h2 id="jadx反编译apk"><a href="#jadx反编译apk" class="headerlink" title="jadx反编译apk"></a>jadx反编译apk</h2><p>搜索字符串<code>&quot;_sig&quot;</code></p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/7.jpg" alt="1"></p>
<h2 id="intercept"><a href="#intercept" class="headerlink" title="intercept"></a>intercept</h2><p>定位到intercept函数，如下可以看出来<code>sig</code>的值为F3.first，F3的值为<code>i0.d.F(request)</code></p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/8.jpg" alt="1"></p>
<p>跟进到F方法里</p>
<h2 id="F"><a href="#F" class="headerlink" title="F"></a>F</h2><p>F方法内容如下</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/9.jpg" alt="1"></p>
<p>返回值是E方法</p>
<p>跟进到E方法</p>
<h2 id="E"><a href="#E" class="headerlink" title="E"></a>E</h2><p>E方法内容如下</p>
<p><img src="/2025/01/07/%E8%B1%86%E7%93%A3frida%E6%A3%80%E6%B5%8B%E7%BB%95%E8%BF%87%E5%8F%8A%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3%E5%8F%82%E6%95%B0%E8%BF%98%E5%8E%9F/10.jpg" alt="1"></p>
<p><strong>分析流程</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">1.判断str是否为空	（TextUtils.isEmpty(str)）</span><br><span class="line">   ↓</span><br><span class="line">2.获取str2	（StringBuilder l10 = android.support.v4.media.e.l(str2)）</span><br><span class="line">   ↓</span><br><span class="line">3.获取URL的路径部分，并进行url编码	（String encodedPath = HttpUrl.parse(str).encodedPath()）</span><br><span class="line">   ↓</span><br><span class="line">4.对进行过URL解码的路径部分进行URL解码	（decode = Uri.decode(encodedPath)）</span><br><span class="line">   ↓</span><br><span class="line">5.如果路径URL的路径部分的末尾有/符号，则删除它</span><br><span class="line">   ↓</span><br><span class="line">6.在l10末尾追加一个&amp;符号</span><br><span class="line">   ↓</span><br><span class="line">7.对解码的URL路径部分进行url编码，然后追加到l10末尾</span><br><span class="line">   ↓</span><br><span class="line">8.在l10末尾追加一个&amp;符号</span><br><span class="line">   ↓</span><br><span class="line">9.在l10末尾追加当前时间戳</span><br><span class="line">   ↓</span><br><span class="line">10.进行HmacSHA1签名</span><br><span class="line">   ↓</span><br><span class="line">11.进行Base64编码</span><br></pre></td></tr></table></figure>

<h2 id="hook-doFinal"><a href="#hook-doFinal" class="headerlink" title="hook doFinal"></a>hook doFinal</h2><p>hook doFinal方法来查看参与加密的参数的格式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">ByteString</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.okhttp.okio.ByteString&quot;</span>);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">toBase64</span>(<span class="params">tag, data</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(tag + <span class="string">&quot; Base64: &quot;</span> + <span class="title class_">ByteString</span>.<span class="title function_">of</span>(data).<span class="title function_">base64</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">toHex</span>(<span class="params">tag, data</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(tag + <span class="string">&quot; Hex: &quot;</span> + <span class="title class_">ByteString</span>.<span class="title function_">of</span>(data).<span class="title function_">hex</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">toUtf8</span>(<span class="params">tag, data</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(tag + <span class="string">&quot; Utf8: &quot;</span> + <span class="title class_">ByteString</span>.<span class="title function_">of</span>(data).<span class="title function_">utf8</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> mac = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.crypto.Mac&quot;</span>);</span><br><span class="line">    mac.<span class="property">init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.security.Key&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Mac.init(&#x27;java.security.Key&#x27;) is called!&quot;</span>);</span><br><span class="line">        <span class="keyword">var</span> algorithm = <span class="variable language_">this</span>.<span class="title function_">getAlgorithm</span>();</span><br><span class="line">        <span class="keyword">var</span> tag = algorithm + <span class="string">&quot; init Key&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> keyBytes = key.<span class="title function_">getEncoded</span>();</span><br><span class="line">        <span class="title function_">toUtf8</span>(tag, keyBytes);</span><br><span class="line">        <span class="title function_">toHex</span>(tag, keyBytes);</span><br><span class="line">        <span class="title function_">toBase64</span>(tag, keyBytes);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">init</span>(key);</span><br><span class="line">    &#125;</span><br><span class="line">    mac.<span class="property">doFinal</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">data</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Mac.doFinal.overload(&#x27;[B&#x27;) is called!&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data:&quot;</span>,<span class="title function_">toUtf8</span>(<span class="string">&quot;data:&quot;</span>,data))</span><br><span class="line">        <span class="keyword">var</span> result = <span class="variable language_">this</span>.<span class="title function_">doFinal</span>(data)</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result:&quot;</span>,<span class="title function_">toBase64</span>(<span class="string">&quot;result&quot;</span>,result))</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;=======================================================&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p><strong>hook 结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Mac.init(&#x27;java.security.Key&#x27;) is called!</span><br><span class="line">HmacSHA1 init Key Utf8: bf7dddc7c9cfe6f7</span><br><span class="line">HmacSHA1 init Key Hex: 62663764646463376339636665366637</span><br><span class="line">HmacSHA1 init Key Base64: YmY3ZGRkYzdjOWNmZTZmNw==</span><br><span class="line">Mac.doFinal.overload(&#x27;[B&#x27;) is called!</span><br><span class="line">data: Utf8: GET&amp;%2Fapi%2Fv2%2Fsearch&amp;1736261466</span><br><span class="line">data: undefined</span><br><span class="line">result Base64: S6+RLmdsNP1NdjQghxJebsST7Tc=</span><br><span class="line">result: undefined</span><br><span class="line">=======================================================</span><br></pre></td></tr></table></figure>



<h2 id="hook-E"><a href="#hook-E" class="headerlink" title="hook E"></a>hook E</h2><p>对E方法进行hook，可以查看参数和返回值</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_E</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> d = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;i0.d&quot;</span>);</span><br><span class="line">        d.<span class="property">E</span>.<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str1,str2,str3</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----E----&quot;</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str1:&quot;</span>,str1);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str2:&quot;</span>,str2);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str3:&quot;</span>,str3);</span><br><span class="line">            <span class="keyword">let</span> result = <span class="variable language_">this</span>.<span class="title function_">E</span>(str1,str2,str3);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;result:&quot;</span>,result)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;----over----&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_E</span>()</span><br></pre></td></tr></table></figure>

<p><strong>hook 结果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">----E----</span><br><span class="line">str1: https://frodo.douban.com/api/v2/search/suggestion?q=%E8%AF%AF%E6%9D%80&amp;loc_id=108288&amp;apikey=0dad551ec0f84ed02907ff5c42e8ec70&amp;channel=ali_market&amp;udid=ce0fb355c7f98012b1d6716853b6841ba7e35819&amp;os_rom=android&amp;timezone=Asia%2FShanghai</span><br><span class="line">str2: GET</span><br><span class="line">str3: null</span><br><span class="line">result: Pair&#123;idc8eWIGKhtP6hTr9piPi5OSadQ= 1736098880&#125;</span><br><span class="line">----over----</span><br><span class="line">----E----</span><br><span class="line">str1: https://frodo.douban.com/api/v2/search/found_words?screen_width=1080&amp;screen_height=2028&amp;wx_api_ver=0&amp;opensdk_ver=638058496&amp;webview_ua=Mozilla%2F5.0%20%28Linux%3B%20Android%209%3B%20Pixel%203%20Build%2FPD1A.180720.030%3B%20wv%29%20AppleWebKit%2F537.36%20%28KHTML%2C%20like%20Gecko%29%20Version%2F4.0%20Chrome%2F66.0.3359.158%20Mobile%20Safari%2F537.36&amp;sugar=0&amp;update_mark=1709887761.853333336&amp;network=wifi&amp;enable_sdk_bidding=1&amp;timezone=Asia%2FShanghai</span><br><span class="line">str2: POST</span><br><span class="line">str3: null</span><br><span class="line">result: Pair&#123;gYm5pJeYn7Wh/uv2QxJF6sh6sfA= 1736098863&#125;</span><br><span class="line">----over----</span><br></pre></td></tr></table></figure>

<h2 id="hook-SecretKeySpec"><a href="#hook-SecretKeySpec" class="headerlink" title="hook SecretKeySpec"></a>hook SecretKeySpec</h2><p>对于hmacsha1算法，我们得知道密钥才行，可以hook SecretKeySpec得到密钥</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hook_SecretKeySpec</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> secretkeyspec = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;javax.crypto.spec.SecretKeySpec&quot;</span>);</span><br><span class="line">        secretkeyspec.<span class="property">$init</span>.<span class="title function_">overload</span>(<span class="string">&#x27;[B&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span>(<span class="params">str5,sha1</span>)&#123;</span><br><span class="line">            <span class="keyword">let</span> stringdata = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.String&quot;</span>).$new(str5);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str5:&quot;</span>,stringdata);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sha1:&quot;</span>,sha1);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;====+++====&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">hook_SecretKeySpec</span>()</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="attr">str5</span>: bf7dddc7c9cfe6f7</span><br><span class="line"><span class="attr">sha1</span>: <span class="title class_">HmacSHA1</span></span><br></pre></td></tr></table></figure>

<p>得到hmacsha1的密钥为<code>bf7dddc7c9cfe6f7</code></p>
<h2 id="参数还原"><a href="#参数还原" class="headerlink" title="参数还原"></a>参数还原</h2><p>这里拿一份hook到的数据进行分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">----E----</span><br><span class="line">str1: https://frodo.douban.com/api/v2/search/suggestion?q=%E8%AF%AF%E6%9D%80&amp;loc_id=108288&amp;apikey=0dad551ec0f84ed02907ff5c42e8ec70&amp;channel=ali_market&amp;udid=ce0fb355c7f98012b1d6716853b6841ba7e35819&amp;os_rom=android&amp;timezone=Asia%2FShanghai</span><br><span class="line">str2: GET</span><br><span class="line">str3: null</span><br><span class="line">result: Pair&#123;idc8eWIGKhtP6hTr9piPi5OSadQ= 1736098880&#125;</span><br><span class="line">----over----</span><br></pre></td></tr></table></figure>

<p>首先需要的是请求方式，这里是<code>GET</code></p>
<p>其次是URL的路径部分，还要进行url编码，这里拿到的是<code>%2Fapi%2Fv2%2Fsearch%2Fsuggestion</code></p>
<p>然后是时间戳<code>1736098880</code></p>
<p>进行HmacSHA1签名，在进行Base64编码</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hmacsha1</span>(<span class="params">key,data</span>):</span><br><span class="line">    key_bytes = key.encode()</span><br><span class="line">    data_bytes = data.encode()</span><br><span class="line">    mac = hmac.new(key_bytes,data_bytes,hashlib.sha1)</span><br><span class="line">    sha1_result = mac.digest()</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(sha1_result).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    </span><br><span class="line">key = <span class="string">&quot;bf7dddc7c9cfe6f7&quot;</span></span><br><span class="line">data = <span class="string">&quot;GET&amp;%2Fapi%2Fv2%2Fsearch%2Fsuggestion&amp;1736098880&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sig:&quot;</span>+hmacsha1(key,data))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">sig:idc8eWIGKhtP6hTr9piPi5OSadQ=</span><br></pre></td></tr></table></figure>

<h1 id="搜索接口"><a href="#搜索接口" class="headerlink" title="搜索接口"></a>搜索接口</h1><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hmacsha1</span>(<span class="params">key,data</span>):</span><br><span class="line">    key_bytes = key.encode()</span><br><span class="line">    data_bytes = data.encode()</span><br><span class="line">    mac = hmac.new(key_bytes,data_bytes,hashlib.sha1)</span><br><span class="line">    sha1_result = mac.digest()</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(sha1_result).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;https://frodo.douban.com/api/v2/search&quot;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">  <span class="string">&quot;user-agent&quot;</span>: <span class="string">&quot;api-client/1 com.douban.frodo/7.89.0(307) Android/28 product/blueline vendor/Google model/Pixel 3 brand/google  rom/android  network/wifi  udid/ce0fb355c7f98012b1d6716853b6841ba7e35819  platform/mobile&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accept-encoding&quot;</span>: <span class="string">&quot;br,gzip&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">timestamp = <span class="built_in">int</span>(time.time())</span><br><span class="line">encode_data = <span class="string">&quot;GET&quot;</span>+<span class="string">&quot;&amp;&quot;</span>+<span class="string">&quot;%2Fapi%2Fv2%2Fsearch&quot;</span>+<span class="string">&quot;&amp;&quot;</span>+<span class="built_in">str</span>(timestamp)</span><br><span class="line">key = <span class="string">&quot;bf7dddc7c9cfe6f7&quot;</span></span><br><span class="line">sig = hmacsha1(key,encode_data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;sig:&quot;</span>,sig)</span><br><span class="line"></span><br><span class="line">query = <span class="built_in">input</span>(<span class="string">&quot;请输入：&quot;</span>)</span><br><span class="line"></span><br><span class="line">params = &#123;</span><br><span class="line">  <span class="string">&quot;q&quot;</span>: query,</span><br><span class="line">  <span class="string">&quot;sort&quot;</span>: <span class="string">&quot;relevance&quot;</span>,</span><br><span class="line">  <span class="string">&quot;count&quot;</span>: <span class="string">&quot;20&quot;</span>,</span><br><span class="line">  <span class="string">&quot;screen_width&quot;</span>: <span class="string">&quot;1080&quot;</span>,</span><br><span class="line">  <span class="string">&quot;screen_height&quot;</span>: <span class="string">&quot;2028&quot;</span>,</span><br><span class="line">  <span class="string">&quot;wx_api_ver&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;opensdk_ver&quot;</span>: <span class="string">&quot;638058496&quot;</span>,</span><br><span class="line">  <span class="string">&quot;webview_ua&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Linux; Android 9; Pixel 3 Build/PD1A.180720.030; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/66.0.3359.158 Mobile Safari/537.36&quot;</span>,</span><br><span class="line">  <span class="string">&quot;sugar&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">  <span class="string">&quot;update_mark&quot;</span>: <span class="string">&quot;1709887761.853333336&quot;</span>,</span><br><span class="line">  <span class="string">&quot;network&quot;</span>: <span class="string">&quot;wifi&quot;</span>,</span><br><span class="line">  <span class="string">&quot;enable_sdk_bidding&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">  <span class="string">&quot;loc_id&quot;</span>: <span class="string">&quot;108288&quot;</span>,</span><br><span class="line">  <span class="string">&quot;apikey&quot;</span>: <span class="string">&quot;0dad551ec0f84ed02907ff5c42e8ec70&quot;</span>,</span><br><span class="line">  <span class="string">&quot;channel&quot;</span>: <span class="string">&quot;ali_market&quot;</span>,</span><br><span class="line">  <span class="string">&quot;udid&quot;</span>: <span class="string">&quot;ce0fb355c7f98012b1d6716853b6841ba7e35819&quot;</span>,</span><br><span class="line">  <span class="string">&quot;os_rom&quot;</span>: <span class="string">&quot;android&quot;</span>,</span><br><span class="line">  <span class="string">&quot;oaid&quot;</span>: <span class="string">&quot;EdGi3zYQCRzmwwB1YR7WKg==\n&quot;</span>,</span><br><span class="line">  <span class="string">&quot;timezone&quot;</span>: <span class="string">&quot;Asia/Shanghai&quot;</span>,</span><br><span class="line">  <span class="string">&quot;_sig&quot;</span>:sig,</span><br><span class="line">  <span class="string">&quot;_ts&quot;</span>: timestamp</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">response = requests.get(url=url,headers=headers,params=params)</span><br><span class="line"><span class="built_in">print</span>(response.status_code)</span><br><span class="line"><span class="comment"># print(response.text)</span></span><br><span class="line">text = json.loads(response.text)</span><br><span class="line"><span class="built_in">print</span>(text)</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/06/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/06/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/" class="post-title-link" itemprop="url">安卓开发</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-06 01:24:07" itemprop="dateCreated datePublished" datetime="2025-01-06T01:24:07+08:00">2025-01-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-01-23 14:32:46" itemprop="dateModified" datetime="2025-01-23T14:32:46+08:00">2025-01-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/" itemprop="url" rel="index"><span itemprop="name">安卓开发</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>10 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="项目目录结构"><a href="#项目目录结构" class="headerlink" title="项目目录结构"></a>项目目录结构</h1><p>新建一个项目，分析项目目录结构</p>
<p><img src="/2025/01/06/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/1.jpg"></p>
<p><strong>1.gradle和.idea</strong></p>
<p>这两个目录下放置的都是Android Studio 自动生成的一些文件，我们无需关心和编辑。</p>
<p><strong>2.app</strong></p>
<p>项目中的代码、资源等内容几乎都是放置在这个目录下的，我们后面的开发工作也都是在这个目录下进行的。</p>
<p><strong>3.gradle</strong></p>
<p>这个目录包含了gradle wrapper的配置文件。</p>
<h2 id="app目录"><a href="#app目录" class="headerlink" title="app目录"></a>app目录</h2><p><img src="/2025/01/06/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/2.jpg"></p>
<h3 id="build"><a href="#build" class="headerlink" title="build"></a><strong>build</strong></h3><p>包含编译时自动生成的文件。</p>
<h3 id="src"><a href="#src" class="headerlink" title="src"></a>src</h3><p>存放源代码。</p>
<h4 id="androidTest"><a href="#androidTest" class="headerlink" title="androidTest"></a>androidTest</h4><p>存放测试代码。</p>
<h4 id="main"><a href="#main" class="headerlink" title="main"></a>main</h4><p>存放应用核心代码和资源。</p>
<h5 id="java"><a href="#java" class="headerlink" title="java"></a>java</h5><p>放置java代码。</p>
<h5 id="res"><a href="#res" class="headerlink" title="res"></a>res</h5><p>存放资源文件，包括布局、图像、字符串等。</p>
<h5 id="AndroidManifest-xml"><a href="#AndroidManifest-xml" class="headerlink" title="AndroidManifest.xml"></a>AndroidManifest.xml</h5><p>这是整个Android项目的配置文件，在程序中定义的所有四大组件都需要在这个文件里注册，还可以在这个文件中添加权限声明。</p>
<h4 id="test"><a href="#test" class="headerlink" title="test"></a>test</h4><p>用来编写UnitTest测试用例的，是对项目及逆行自动化测试的另一种方式。</p>
<h4 id="build-gradle"><a href="#build-gradle" class="headerlink" title="build.gradle"></a>build.gradle</h4><p>app模块的gradle构建脚本，这个文件会指定很多项目构建相关的配置。</p>
<h1 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h1><p>Activity 是一种用户界面的组件，是 Android 应用的一个核心部分。每个 Activity 通常代表一个单独的屏幕或界面，用户与应用的互动通常发生在 Activity 中。</p>
<h2 id="MainActivity"><a href="#MainActivity" class="headerlink" title="MainActivity"></a>MainActivity</h2><p>在使用Android Studio创建项目的时候，它会自动帮我们创建MainActivity。<br>其内容如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    <span class="comment">//// 设置布局，接受一个布局文件的资源 ID，并将该布局文件作为当前活动的界面。</span></span><br><span class="line">    setContentView(R.layout.activity_main);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="布局文件"><a href="#布局文件" class="headerlink" title="布局文件"></a>布局文件</h2><p>布局文件定义了用户界面（UI）的结构和视图元素。</p>
<p>在res目录里有一个layout目录，展开后可以看到有一个activity_main.xml文件，其内容如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">&quot;http://schemas.android.com/apk/res-auto&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/main&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">&quot;.MainActivity&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">&quot;Hello World!&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintEnd_toEndOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintStart_toStartOf</span>=<span class="string">&quot;parent&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">&quot;parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">androidx.constraintlayout.widget.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Activity的注册"><a href="#Activity的注册" class="headerlink" title="Activity的注册"></a>Activity的注册</h2><p>所有的活动都要在AndroidManifest.xml文件中注册才能生效。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:allowBackup</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:dataExtractionRules</span>=<span class="string">&quot;@xml/data_extraction_rules&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fullBackupContent</span>=<span class="string">&quot;@xml/backup_rules&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:icon</span>=<span class="string">&quot;@mipmap/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:roundIcon</span>=<span class="string">&quot;@mipmap/ic_launcher_round&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:supportsRtl</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:theme</span>=<span class="string">&quot;@style/Theme.HelloWorld&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">tools:targetApi</span>=<span class="string">&quot;31&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>活动的注册声明在<code>&lt;application&gt;</code>标签内，通过<code>&lt;activity&gt;</code>标签来进行注册。<br>在<code>&lt;activity&gt;</code>标签中使用<code>android:name</code>指定具体注册的活动，这里<code>.MainActivity</code>是省略了包名。</p>
<h2 id="程序入口activity"><a href="#程序入口activity" class="headerlink" title="程序入口activity"></a>程序入口activity</h2><p>在程序的actitity中添加如下内容指定程序入口<code>activity</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.MAIN&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.category.LAUNCHER&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>action</code>中的<code>.MAIN</code>动作用于启动一个应用程序的主界面。</p>
<p><code>category</code>中的<code>LAUNCHER</code>类别意味着这个活动应该在设备的应用程序启动器（应用抽屉）中显示一个图标，允许用户点击图标来启动应用程序。</p>
<h2 id="Intent"><a href="#Intent" class="headerlink" title="Intent"></a>Intent</h2><p>使用Intent可以从主活动跳转到其他活动。<br>Intent是Android程序中各组件之间进行交互的一种重要方式。</p>
<h3 id="显式-Intent"><a href="#显式-Intent" class="headerlink" title="显式 Intent"></a>显式 Intent</h3><p>显式 <code>Intent</code> 直接指定了目标组件，通常用于在应用内部启动 <code>Activity</code>、<code>Service</code> 或与之通信。</p>
<p>启动 <code>Activity</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Intent</span> <span class="variable">secondintent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="built_in">this</span>, SecondActivity.class);</span><br><span class="line">startActivity(secondintent)</span><br></pre></td></tr></table></figure>

<h3 id="隐式-Intent"><a href="#隐式-Intent" class="headerlink" title="隐式 Intent"></a>隐式 Intent</h3><p>隐式 <code>Intent</code> 不直接指定目标组件，而是声明一个意图（通常是动作），然后由 Android 系统根据该动作来匹配适合的组件来处理 <code>Intent</code>。这种方式不需要明确指定目标组件，系统会根据设备上所有能够处理该动作的应用来选择合适的组件。</p>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><p><img src="/2025/01/06/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/3.jpg"></p>
<h3 id="四种状态"><a href="#四种状态" class="headerlink" title="四种状态"></a>四种状态</h3><ul>
<li><strong>运行状态</strong><br>  活动位于栈顶并在前台运行，用户可以与之交互。</li>
<li><strong>暂停状态</strong><br>  活动部分可见但未完全覆盖用户界面，它仍在前台但无法与用户交互。</li>
<li><strong>停止状态</strong><br>  活动完全不可见，已被其他活动完全覆盖。</li>
<li><strong>销毁状态</strong><br>  活动已被系统或用户完全移除，实例不再存在。</li>
</ul>
<h3 id="生命周期的回调方法"><a href="#生命周期的回调方法" class="headerlink" title="生命周期的回调方法"></a>生命周期的回调方法</h3><h4 id="onCreate"><a href="#onCreate" class="headerlink" title="onCreate()"></a>onCreate()</h4><p><strong>调用时机</strong>：当 <code>Activity</code> 被创建时，系统会调用此方法。此时 <code>Activity</code> 尚未显示在屏幕上。</p>
<h4 id="onStart"><a href="#onStart" class="headerlink" title="onStart()"></a>onStart()</h4><p><strong>调用时机</strong>：当 <code>Activity</code> 即将变得可见时，系统会调用此方法。这时 <code>Activity</code> 还没有与用户交互。</p>
<h4 id="onResume"><a href="#onResume" class="headerlink" title="onResume()"></a>onResume()</h4><p><strong>调用时机</strong>：当 <code>Activity</code> 准备好与用户交互时，系统会调用此方法，表示 <code>Activity</code> 已经位于前台并处于活动状态。</p>
<h4 id="onPause"><a href="#onPause" class="headerlink" title="onPause()"></a>onPause()</h4><p><strong>调用时机</strong>：当系统即将启动或恢复另一个 <code>Activity</code> 时，当前的 <code>Activity</code> 将被暂停。</p>
<h4 id="onStop"><a href="#onStop" class="headerlink" title="onStop()"></a>onStop()</h4><p><strong>调用时机</strong>：当 <code>Activity</code> 不再对用户可见时，系统会调用此方法。</p>
<h4 id="onRestart"><a href="#onRestart" class="headerlink" title="onRestart()"></a>onRestart()</h4><p><strong>调用时机</strong>：当 <code>Activity</code> 从停止状态恢复并重新变得可见时，系统会调用此方法。</p>
<h4 id="onDestroy"><a href="#onDestroy" class="headerlink" title="onDestroy()"></a>onDestroy()</h4><p><strong>调用时机</strong>：当 <code>Activity</code> 被销毁时（如 <code>finish()</code> 被调用、系统内存不足等），系统会调用此方法。</p>
<h2 id="启动模式"><a href="#启动模式" class="headerlink" title="启动模式"></a>启动模式</h2><p><code>Activity</code> 的启动模式决定了新的 <code>Activity</code> 如何在任务栈（task stack）中管理和显示。</p>
<h3 id="standard"><a href="#standard" class="headerlink" title="standard"></a>standard</h3><p>这是 <code>Activity</code> 默认的启动模式。每次启动一个新的 <code>Activity</code> 时，都会在任务栈的顶部创建一个新的 <code>Activity</code> 实例。</p>
<p>无论栈中是否已经有该 <code>Activity</code> 的实例，都会新建一个 <code>Activity</code> 实例并添加到栈中。</p>
<p>在standard模式下，每当启动一个新的<code>Activity</code>，它就会在返回栈中入栈，并处于栈顶的位置。</p>
<h3 id="singleTop"><a href="#singleTop" class="headerlink" title="singleTop"></a>singleTop</h3><p>如果任务栈的顶部已经有该 <code>Activity</code> 的实例，则不会再创建一个新的实例，而是复用栈顶的实例，调用 <code>onNewIntent()</code> 方法来处理新的 <code>Intent</code>。</p>
<p><strong>使用方式</strong>：在 <code>AndroidManifest.xml</code> 中配置 <code>launchMode</code> 为 <code>singleTop</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:launchMode</span>=<span class="string">&quot;singleTop&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果 <code>MainActivity</code> 已经在栈顶，则会复用现有实例，并通过 <code>onNewIntent()</code> 接收新的 <code>Intent</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onNewIntent</span><span class="params">(Intent intent)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onNewIntent(intent);</span><br><span class="line">    <span class="comment">// 处理新的 Intent</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="singleTask"><a href="#singleTask" class="headerlink" title="singleTask"></a>singleTask</h3><p>该模式下，<code>Activity</code> 会被启动为一个新的任务，并且栈中只能有该 <code>Activity</code> 的一个实例。即使栈中已经有该 <code>Activity</code> 的实例，也会先销毁栈中所有的 <code>Activity</code>，然后启动这个新的 <code>Activity</code>。</p>
<p><strong>使用方式</strong>： 在 <code>AndroidManifest.xml</code> 中配置 <code>launchMode</code> 为 <code>singleTask</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:launchMode</span>=<span class="string">&quot;singleTask&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="singleInstance"><a href="#singleInstance" class="headerlink" title="singleInstance"></a>singleInstance</h3><p>这是最严格的启动模式。系统会创建一个新的任务栈，并且栈中只能有该 <code>Activity</code> 的一个实例。即使有其他 <code>Activity</code> 启动该 <code>Activity</code>，也会使用独立的栈，不与其他任务栈共享。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">&quot;.MainActivity&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">android:launchMode</span>=<span class="string">&quot;singleInstance&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="常用控件"><a href="#常用控件" class="headerlink" title="常用控件"></a>常用控件</h1><h2 id="TextView"><a href="#TextView" class="headerlink" title="TextView"></a>TextView</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/textView&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">&quot;Hello, World!&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textSize</span>=<span class="string">&quot;20sp&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:textColor</span>=<span class="string">&quot;#FF0000&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Button"><a href="#Button" class="headerlink" title="Button"></a>Button</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/button&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:text</span>=<span class="string">&quot;Button&quot;</span> /&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="EditText"><a href="#EditText" class="headerlink" title="EditText"></a>EditText</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EditText</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/editText&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:hint</span>=<span class="string">&quot;input&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:inputType</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="ImageView"><a href="#ImageView" class="headerlink" title="ImageView"></a>ImageView</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/imageView&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;wrap_content&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:src</span>=<span class="string">&quot;@drawable/image&quot;</span> /&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="WebView"><a href="#WebView" class="headerlink" title="WebView"></a>WebView</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">WebView</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:id</span>=<span class="string">&quot;@+id/webView&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">&quot;match_parent&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">&quot;match_parent&quot;</span> /&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="Broadcast"><a href="#Broadcast" class="headerlink" title="Broadcast"></a>Broadcast</h1><p>广播（Broadcast）是一种消息传递机制，允许应用之间或应用内部的不同组件之间进行通信。</p>
<h2 id="广播的分类"><a href="#广播的分类" class="headerlink" title="广播的分类"></a>广播的分类</h2><h3 id="标准广播"><a href="#标准广播" class="headerlink" title="标准广播"></a>标准广播</h3><ul>
<li><p>是一种异步广播，所有接收者几乎在同一时间接收广播。</p>
</li>
<li><p>优点：效率高，因为广播是同时分发的。</p>
</li>
<li><p>缺点：接收器之间无法中断广播，无法保证接收顺序。</p>
</li>
</ul>
<h3 id="有序广播"><a href="#有序广播" class="headerlink" title="有序广播"></a>有序广播</h3><ul>
<li><p>是一种同步广播，按接收器的优先级依次接收广播。</p>
</li>
<li><p>每个接收器可以处理后终止广播的传递，或者修改广播内容。</p>
</li>
<li><p>优点：可控制广播的传播，并允许对广播进行修改。</p>
</li>
<li><p>缺点：效率较低，因为接收器按顺序逐个处理广播。</p>
</li>
</ul>
<h2 id="广播的类型"><a href="#广播的类型" class="headerlink" title="广播的类型"></a>广播的类型</h2><p><strong>系统广播</strong></p>
<p>安卓系统定义了一些广播来通知应用程序系统事件。</p>
<p><strong>自定义广播</strong></p>
<p>开发者可以发送自己定义的广播，用于应用内部或多个应用之间的通信。</p>
<h2 id="广播接收器"><a href="#广播接收器" class="headerlink" title="广播接收器"></a>广播接收器</h2><p>广播接收器可以通过两种方式注册：</p>
<h3 id="静态注册"><a href="#静态注册" class="headerlink" title="静态注册"></a>静态注册</h3><p>静态注册的广播接收器在应用未运行时也可以接收到广播。</p>
<h4 id="静态注册广播实现开机启动"><a href="#静态注册广播实现开机启动" class="headerlink" title="静态注册广播实现开机启动"></a>静态注册广播实现开机启动</h4><p>创建广播接收器，右键Java包-&gt;New-&gt;Other-&gt;Broadcast Reveiver</p>
<p><img src="/2025/01/06/%E5%AE%89%E5%8D%93%E5%BC%80%E5%8F%91/4.jpg"></p>
<p>实现<code>onReceive</code>方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BootCompleteReceiver</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        Toast.makeText(context,<span class="string">&quot;Boot Complete!&quot;</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">        Log.d(<span class="string">&quot;Broadcast&quot;</span>,<span class="string">&quot;Boot Complete!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>AndroidManifest.xml</code>进行注册和添加权限</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">manifest</span> <span class="attr">xmlns:android</span>=<span class="string">&quot;http://schemas.android.com/apk/res/android&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">&quot;http://schemas.android.com/tools&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 声明权限：允许应用接收设备启动完成后的广播 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">    	<span class="attr">...</span></span></span><br><span class="line"><span class="tag">        &lt;<span class="attr">receiver</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:name</span>=<span class="string">&quot;.BootCompleteReceiver&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:enabled</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:exported</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    		<span class="comment">&lt;!-- 定义接收器要监听的广播类型 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 接收系统广播：设备启动完成 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">&quot;android.intent.action.BOOT_COMPLETED&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">receiver</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">activity</span></span></span><br><span class="line"><span class="tag">        	<span class="attr">...</span></span></span><br><span class="line"><span class="tag">        &lt;/<span class="attr">activity</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">manifest</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>关闭设备，重新启动，就可以看到开机广播。</p>
<h3 id="动态注册"><a href="#动态注册" class="headerlink" title="动态注册"></a>动态注册</h3><p>动态注册的广播只在应用运行时有效。</p>
<h4 id="动态注册广播监听网络变化"><a href="#动态注册广播监听网络变化" class="headerlink" title="动态注册广播监听网络变化"></a>动态注册广播监听网络变化</h4><p><strong>声明权限</strong></p>
<p>需要在 <code>AndroidManifest.xml</code> 文件中添加以下权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>定义广播接收器</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetworkReceiver</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="type">ConnectivityManager</span> <span class="variable">connectivityManager</span> <span class="operator">=</span></span><br><span class="line">                (ConnectivityManager) context.getSystemService(Context.CONNECTIVITY_SERVICE);</span><br><span class="line">        <span class="keyword">if</span>(connectivityManager!=<span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="type">NetworkInfo</span> <span class="variable">activeNetwork</span> <span class="operator">=</span> connectivityManager.getActiveNetworkInfo();</span><br><span class="line">            <span class="keyword">if</span>(activeNetwork!=<span class="literal">null</span> &amp;&amp; activeNetwork.isConnected())&#123;</span><br><span class="line">                <span class="comment">// 网络已连接</span></span><br><span class="line">                <span class="keyword">if</span>(activeNetwork.getType()==ConnectivityManager.TYPE_WIFI)&#123;</span><br><span class="line">                    Toast.makeText(context, <span class="string">&quot;已连接 Wi-Fi&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> (activeNetwork.getType()==ConnectivityManager.TYPE_MOBILE)&#123;</span><br><span class="line">                    Toast.makeText(context, <span class="string">&quot;已连接移动网络&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 网络断开</span></span><br><span class="line">                Toast.makeText(context, <span class="string">&quot;网络已断开&quot;</span>, Toast.LENGTH_SHORT).show();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>动态注册广播</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个广播接收器，用于监听网络状态变化</span></span><br><span class="line">    <span class="keyword">private</span> NetworkReceiver networkReceiver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        EdgeToEdge.enable(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置当前 Activity 的布局文件</span></span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建网络状态广播接收器实例</span></span><br><span class="line">        networkReceiver = <span class="keyword">new</span> <span class="title class_">NetworkReceiver</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建 IntentFilter，指定接收的广播类型为网络连接状态变化</span></span><br><span class="line">        <span class="type">IntentFilter</span> <span class="variable">intentFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntentFilter</span>();</span><br><span class="line">        intentFilter.addAction(ConnectivityManager.CONNECTIVITY_ACTION);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注册广播接收器，将其绑定到网络状态变化的广播上</span></span><br><span class="line">        registerReceiver(networkReceiver, intentFilter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDestroy();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 在 Activity 销毁时注销广播接收器，避免内存泄漏</span></span><br><span class="line">        unregisterReceiver(networkReceiver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在切换网络状态的时候就会看到广播效果。</p>
<h3 id="使用本地广播"><a href="#使用本地广播" class="headerlink" title="使用本地广播"></a>使用本地广播</h3><p><strong>定义广播接收器</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalBroadcastReceiver</span> <span class="keyword">extends</span> <span class="title class_">BroadcastReceiver</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onReceive</span><span class="params">(Context context, Intent intent)</span> &#123;</span><br><span class="line">        <span class="comment">// 处理广播内容</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">message</span> <span class="operator">=</span> intent.getStringExtra(<span class="string">&quot;message&quot;</span>);</span><br><span class="line">        Toast.makeText(context, <span class="string">&quot;LocalBroadcast: &quot;</span> + message, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发送和接收本地广播</p>
<p>添加一个按钮，通过按钮触发本地广播的发送</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> LocalBroadcastReceiver localBroadcastReceiver;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> LocalBroadcastManager localBroadcastManager;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">    EdgeToEdge.enable(<span class="built_in">this</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化广播接收器</span></span><br><span class="line">    localBroadcastReceiver = <span class="keyword">new</span> <span class="title class_">LocalBroadcastReceiver</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 IntentFilter，并设置要监听的 Action</span></span><br><span class="line">    <span class="type">IntentFilter</span> <span class="variable">intentFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntentFilter</span>();</span><br><span class="line">    intentFilter.addAction(<span class="string">&quot;com.example.helloworld.LOCAL_BROADCAST&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注册本地广播接收器</span></span><br><span class="line">    localBroadcastManager = LocalBroadcastManager.getInstance(<span class="built_in">this</span>);</span><br><span class="line">    localBroadcastManager.registerReceiver(localBroadcastReceiver,intentFilter);</span><br><span class="line"></span><br><span class="line">    <span class="type">Button</span> <span class="variable">send_button</span> <span class="operator">=</span> findViewById(R.id.send_broadcast);</span><br><span class="line">    send_button.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">            <span class="type">Intent</span> <span class="variable">intent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Intent</span>(<span class="string">&quot;com.example.helloworld.LOCAL_BROADCAST&quot;</span>);</span><br><span class="line">            intent.putExtra(<span class="string">&quot;message&quot;</span>,<span class="string">&quot;This is a Broadcast message!&quot;</span>);</span><br><span class="line">            localBroadcastManager.sendBroadcast(intent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onDestroy();</span><br><span class="line">    <span class="comment">// 注销广播接收器，防止内存泄漏</span></span><br><span class="line">    unregisterReceiver(localBroadcastReceiver);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>点击按钮，发送广播。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/06/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/06/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/" class="post-title-link" itemprop="url">编码与加解密</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-06 00:20:54" itemprop="dateCreated datePublished" datetime="2025-01-06T00:20:54+08:00">2025-01-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-05 17:20:57" itemprop="dateModified" datetime="2025-02-05T17:20:57+08:00">2025-02-05</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/" itemprop="url" rel="index"><span itemprop="name">编码与加解密</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h1><h2 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h2><h2 id="Hex"><a href="#Hex" class="headerlink" title="Hex"></a>Hex</h2><h3 id="JS实现toHex"><a href="#JS实现toHex" class="headerlink" title="JS实现toHex"></a>JS实现toHex</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">toHex</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> hexdata = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; data.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        hexdata += data.<span class="title function_">charCodeAt</span>(i).<span class="title function_">toString</span>(<span class="number">16</span>).<span class="title function_">padStart</span>(<span class="number">2</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hexdata;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">toHex</span>(<span class="string">&quot;Bileton&quot;</span>)) <span class="comment">// 42696c65746f6e</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>charCodeAt(i)</code> 获取字符串中每个字符的 Unicode 编码。</p>
</li>
<li><p><code>toString(16)</code> 将数字转换为 16 进制字符串。</p>
</li>
<li><p><code>padStart(2, &#39;0&#39;)</code> 确保每个字符的 Hex 码都是两位数（即不足两位时会在前面补充 0）。</p>
</li>
</ul>
<p><strong>frida常用</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">ByteString</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.android.okhttp.okio.ByteString&quot;</span>);</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toHex</span>(<span class="params">tag, data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(tag + <span class="string">&quot; Hex: &quot;</span> + <span class="title class_">ByteString</span>.<span class="title function_">of</span>(data).<span class="title function_">hex</span>());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Python实现toHex与fromHex"><a href="#Python实现toHex与fromHex" class="headerlink" title="Python实现toHex与fromHex"></a>Python实现toHex与fromHex</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">&quot;Bileton&quot;</span></span><br><span class="line">data_toHex = data.encode(<span class="string">&quot;utf-8&quot;</span>).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;toHex: &quot;</span>,data_toHex)</span><br><span class="line">data_toHex_fromHex = <span class="built_in">bytes</span>.fromhex(data_toHex).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;fromHex: &quot;</span>,data_toHex_fromHex)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">toHex:  42696c65746f6e</span><br><span class="line">fromHex:  Bileton</span><br></pre></td></tr></table></figure>



<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;Bileton&quot;</span></span><br><span class="line">data_toHex = binascii.hexlify(data.encode(<span class="string">&quot;utf-8&quot;</span>)).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;toHex: &quot;</span>, data_toHex)</span><br><span class="line">data_toHex_fromHex = binascii.unhexlify(data_toHex.encode(<span class="string">&quot;utf-8&quot;</span>)).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;fromHex: &quot;</span>, data_toHex_fromHex)</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">toHex:  42696c65746f6e</span><br><span class="line">fromHex:  Bileton</span><br></pre></td></tr></table></figure>





<h2 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h2><h3 id="Python实现Base64的编码与解码"><a href="#Python实现Base64的编码与解码" class="headerlink" title="Python实现Base64的编码与解码"></a>Python实现Base64的编码与解码</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = <span class="string">&quot;Bielton&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;data:&quot;</span>,data)</span><br><span class="line">data_b64encode = base64.b64encode(data.encode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b64编码：&quot;</span>,data_b64encode.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">data_b64decode = base64.b64decode(data_b64encode)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b64解码&quot;</span>,data_b64decode.decode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">data: Bielton</span><br><span class="line">b64编码： QmllbHRvbg==</span><br><span class="line">b64解码 Bielton</span><br></pre></td></tr></table></figure>

<h3 id="Java实现Base64的编码与解码"><a href="#Java实现Base64的编码与解码" class="headerlink" title="Java实现Base64的编码与解码"></a>Java实现Base64的编码与解码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">      <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;Bielton&quot;</span>;</span><br><span class="line">      Base64.Encoder  encoder=  Base64.getEncoder();</span><br><span class="line">      <span class="type">byte</span>[] encoded = encoder.encode(data.getBytes());</span><br><span class="line">      <span class="type">String</span> <span class="variable">encodedToString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(encoded);</span><br><span class="line">      System.out.println(encodedToString); <span class="comment">// QmllbHRvbg==</span></span><br><span class="line"></span><br><span class="line"><span class="type">byte</span>[] decoded = Base64.getDecoder().decode(encodedToString);</span><br><span class="line">      <span class="type">String</span> <span class="variable">decodedToString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(decoded);</span><br><span class="line">      System.out.println(decodedToString);  <span class="comment">// Bielton</span></span><br></pre></td></tr></table></figure>

<h3 id="Android-Studio"><a href="#Android-Studio" class="headerlink" title="Android Studio"></a>Android Studio</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Button</span> <span class="variable">B64_en</span> <span class="operator">=</span> findViewById(R.id.b64encode);</span><br><span class="line">B64_en.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;Bileton&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data_encode</span> <span class="operator">=</span> Base64.encodeToString(data.getBytes(), Base64.DEFAULT);</span><br><span class="line">        Toast.makeText(MainActivity.<span class="built_in">this</span>,data_encode,Toast.LENGTH_SHORT).show();  <span class="comment">// QmllbHRvbg==</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="type">Button</span> <span class="variable">B64_de</span> <span class="operator">=</span> findViewById(R.id.b64decode);</span><br><span class="line">B64_de.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;Bileton&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">data_encode</span> <span class="operator">=</span> Base64.encodeToString(data.getBytes(), Base64.DEFAULT);</span><br><span class="line">        <span class="type">byte</span>[] data_decode = Base64.decode(data_encode,Base64.DEFAULT);</span><br><span class="line">        <span class="type">String</span> <span class="variable">decodeString</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(data_decode);</span><br><span class="line">        Toast.makeText(MainActivity.<span class="built_in">this</span>,decodeString,Toast.LENGTH_SHORT).show();  <span class="comment">// Bielton</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h1 id="哈希算法"><a href="#哈希算法" class="headerlink" title="哈希算法"></a>哈希算法</h1><h2 id="CRC32"><a href="#CRC32" class="headerlink" title="CRC32"></a>CRC32</h2><p>最终生成32位（4字节）的哈希值。</p>
<h2 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h2><p><strong>消息处理</strong></p>
<p>对输入消息进行分块，每个分块的长度为512位（32字节），不足512位的进行填充，先填充一个1，然后补0，直到长度为448位，然后在最后的64位中添加原始消息的长度。</p>
<p><strong>初始化常量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A = 0x67452301</span><br><span class="line">B = 0xEFCDAB89</span><br><span class="line">C = 0x98BADCFE</span><br><span class="line">D = 0x10325476</span><br></pre></td></tr></table></figure>

<p><strong>生成结果</strong></p>
<p>最终生成128位（16字节）长度的哈希值。</p>
<h3 id="Python实现MD5"><a href="#Python实现MD5" class="headerlink" title="Python实现MD5"></a>Python实现MD5</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5_call</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="comment"># 创建md5对象</span></span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    <span class="comment"># 更新要加密的数据，参数要是字节类型</span></span><br><span class="line">    md5.update(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    <span class="comment"># 获取加密后的数据，以16进制表示</span></span><br><span class="line">    md5_hex = md5.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> md5_hex</span><br><span class="line">	<span class="comment"># 获取加密后的数据，以字节码表示</span></span><br><span class="line">    <span class="comment"># md5_byte = md5.digest()</span></span><br><span class="line">    <span class="comment"># return md5_byte</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要加密的字符串</span></span><br><span class="line">md5_str = <span class="string">&quot;Bileton&quot;</span></span><br><span class="line"><span class="built_in">print</span>(md5_str,<span class="string">&quot;的哈希值为：&quot;</span>,md5call(md5_str))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span></span><br><span class="line">Bileton 的哈希值为： 1483ab1f77ea828faa5f78514d2765c1</span><br></pre></td></tr></table></figure>



<h2 id="SHA1"><a href="#SHA1" class="headerlink" title="SHA1"></a>SHA1</h2><p><strong>消息处理</strong></p>
<p>SHA1的消息处理方式与MD5基本相同，区别是最后的消息长度使用的是大端字节序。</p>
<p><strong>初始化常量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">H0 = 0x67452301</span><br><span class="line">H1 = 0xEFCDAB89</span><br><span class="line">H2 = 0x98BADCFE</span><br><span class="line">H3 = 0x10325476</span><br><span class="line">H4 = 0xC3D2E1F0</span><br></pre></td></tr></table></figure>

<p><strong>生成结果</strong></p>
<p>最终生成160位（20字节）长度的哈希值。(这里的结果使用的是大端字节序。)</p>
<h3 id="Python实现SHA1"><a href="#Python实现SHA1" class="headerlink" title="Python实现SHA1"></a>Python实现SHA1</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SHA1_call</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="comment"># 创建sha1对象</span></span><br><span class="line">    sha1 = hashlib.sha1()</span><br><span class="line">    sha1.update(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    <span class="comment"># 获取加密后的数据，以16进制表示</span></span><br><span class="line">    sha1_hex = sha1.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> sha1_hex</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取加密后的数据，以字节码表示</span></span><br><span class="line">    <span class="comment"># sha1_bytes = sha1.digest()</span></span><br><span class="line">    <span class="comment"># return sha1_bytes</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(SHA1_call(<span class="string">&quot;Bileton&quot;</span>))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">ab345d2ef3e3a48433207b746c9cb3a49b473e3a</span><br></pre></td></tr></table></figure>



<h2 id="SHA256"><a href="#SHA256" class="headerlink" title="SHA256"></a>SHA256</h2><p><strong>消息处理</strong></p>
<p>与SHA1相同。</p>
<p><strong>初始化常量</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">H0 = 0x6a09e667</span><br><span class="line">H1 = 0xbb67ae85</span><br><span class="line">H2 = 0x3c6ef372</span><br><span class="line">H3 = 0xa54ff53a</span><br><span class="line">H4 = 0x510e527f</span><br><span class="line">H5 = 0x9b05688c</span><br><span class="line">H6 = 0x1f83d9ab</span><br><span class="line">H7 = 0x5be0cd19</span><br></pre></td></tr></table></figure>



<p><strong>生成结果</strong></p>
<p>最终生成256位（32字节）长度的哈希值。(这里的结果使用的是大端字节序。)</p>
<h3 id="Python实现SHA256"><a href="#Python实现SHA256" class="headerlink" title="Python实现SHA256"></a>Python实现SHA256</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SHA256_call</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="comment"># 创建sha256对象</span></span><br><span class="line">    sha256 = hashlib.sha256()</span><br><span class="line">    sha256.update(data.encode(<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    <span class="comment"># 获取加密后的数据，以16进制表示</span></span><br><span class="line">    sha256_hex = sha256.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> sha256_hex</span><br><span class="line">    <span class="comment"># 获取加密后的数据，以字节码表示</span></span><br><span class="line">    <span class="comment"># sha256_byte = sha256.digest()</span></span><br><span class="line">    <span class="comment"># return sha256_byte</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 要加密的字符串</span></span><br><span class="line">sha256_data = <span class="string">&quot;Bileton&quot;</span></span><br><span class="line"><span class="built_in">print</span>(SHA256_call(sha256_data))</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">b54bc358a78fb7bbfcb6bdcd79ba65436534c222ce67ebbc838e8a29df5b2b28</span><br></pre></td></tr></table></figure>





<h2 id="MAC算法"><a href="#MAC算法" class="headerlink" title="MAC算法"></a>MAC算法</h2><p><strong>MAC公式</strong></p>
<p><img src="/2025/01/06/%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E8%A7%A3%E5%AF%86/1.jpg"></p>
<p><code>message</code>是消息m<br><code>key</code>是密钥<br><code>||</code>是级联，其实就是拼接操作<br><code>ipad</code>值为0x36<br><code>opad</code>值为0x5c<br><code>⊕</code>代表异或</p>
<p><strong>密钥扩展</strong></p>
<ul>
<li>若密钥长度小于Hash的分组长度<br>在密钥末尾填充0，直到长度达到Hash的分组长度</li>
<li>若密钥长度大于Hash的分组长度<br>将密钥进行哈希运算，然后补充0，直到长度达到Hash的分组长度</li>
</ul>
<h3 id="HmacMD5"><a href="#HmacMD5" class="headerlink" title="HmacMD5"></a>HmacMD5</h3><p>与MD5不同的是，HmacMD5结合了密钥。</p>
<p>生成128位（16字节）长度的哈希值。</p>
<h3 id="HmacSHA1"><a href="#HmacSHA1" class="headerlink" title="HmacSHA1"></a>HmacSHA1</h3><p>与HmacSHA1不同的是，HmacSHA1结合了密钥。</p>
<p>生成256位（32字节）长度的哈希值。</p>
<h3 id="HmacSHA256"><a href="#HmacSHA256" class="headerlink" title="HmacSHA256"></a>HmacSHA256</h3><p>与HmacSHA256不同的是，HmacSHA256结合了密钥。</p>
<h1 id="对称加密算法"><a href="#对称加密算法" class="headerlink" title="对称加密算法"></a>对称加密算法</h1><h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><h2 id="DES"><a href="#DES" class="headerlink" title="DES"></a>DES</h2><h2 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h2><h2 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h2><h2 id="SM4"><a href="#SM4" class="headerlink" title="SM4"></a>SM4</h2><h1 id="非对称加密算法"><a href="#非对称加密算法" class="headerlink" title="非对称加密算法"></a>非对称加密算法</h1><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h2><h2 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h2><h1 id="压缩算法"><a href="#压缩算法" class="headerlink" title="压缩算法"></a>压缩算法</h1><h2 id="gzip"><a href="#gzip" class="headerlink" title="gzip"></a>gzip</h2><h2 id="zlib"><a href="#zlib" class="headerlink" title="zlib"></a>zlib</h2><h2 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h2><h2 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h2><h2 id="7z"><a href="#7z" class="headerlink" title="7z"></a>7z</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/01/05/Android%E9%87%8C%E7%9A%84Java%E7%B1%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/android.svg">
      <meta itemprop="name" content="Bileton">
      <meta itemprop="description" content="路漫漫其修远夕！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="白乐天">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/01/05/Android%E9%87%8C%E7%9A%84Java%E7%B1%BB/" class="post-title-link" itemprop="url">Android里的Java类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-05 00:27:18" itemprop="dateCreated datePublished" datetime="2025-01-05T00:27:18+08:00">2025-01-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-02-02 20:01:35" itemprop="dateModified" datetime="2025-02-02T20:01:35+08:00">2025-02-02</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.9k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DexClassLoader"><a href="#DexClassLoader" class="headerlink" title="DexClassLoader"></a>DexClassLoader</h1><p>Android 提供的用于动态加载 <code>.dex</code> 文件、<code>.apk</code> 文件或 <code>.jar</code> 文件的核心工具。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="title function_">DexClassLoader</span><span class="params">(</span></span><br><span class="line"><span class="params">    String dexPath,      // .dex/.apk/.jar 文件的路径</span></span><br><span class="line"><span class="params">    String optimizedDirectory, // 解压和优化后的 .odex 文件存放路径</span></span><br><span class="line"><span class="params">    String librarySearchPath,  // 关联的本地库(.so)</span>文件的路径，可为 <span class="literal">null</span></span><br><span class="line">    ClassLoader parent         <span class="comment">// 父类加载器（委托机制使用）</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// dexPath：必填，一个完整的文件路径</span></span><br><span class="line"><span class="comment">// optimizedDirectory：必填，存放优化后的文件，，一个可写的目录路径。</span></span><br><span class="line"><span class="comment">// librarySearchPath：可选</span></span><br><span class="line"><span class="comment">// parent：必填：父类加载器（ClassLoader），用于实现 Java 的类加载委托机制。</span></span><br></pre></td></tr></table></figure>

<h2 id="findClass"><a href="#findClass" class="headerlink" title="findClass"></a>findClass</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException</span><br></pre></td></tr></table></figure>



<h1 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h1><p><code>android.util.Log</code>是Android中的日志工具类，这个类中提供了5个方法。</p>
<ul>
<li><code>Log.v()</code>：用于打印那些最为繁琐、意义最小的日志信息。对应级别verbose。</li>
<li><code>Log.d()</code>：用于打印一些调试信息，这些信息对调试程序和分析问题应该是有帮助的。对应级别是debug。</li>
<li><code>Log.i()</code>：用于打印一些比较重要的数据，这些数据应该是可以帮助分析用户行为的数据。对应级别info。</li>
<li><code>Log.w()</code>：用于打印一些警告信息，提示程序在这个地方可能会有潜在风险，最好去修复一下出现警告的地方。对应级别warn。</li>
<li><code>Log.e()</code>：用于打印程序中的错误信息当有错误信息打印出来的时候，一般都代表程序出现问题了，要尽快修复。对用级别error。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Log.v(String tag, String msg);</span><br></pre></td></tr></table></figure>

<h1 id="Toast"><a href="#Toast" class="headerlink" title="Toast"></a>Toast</h1><p><code>Toast</code> 是一种非常简单的界面元素，用于在屏幕上显示短暂的消息，通常用于向用户显示提示信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Toast.makeText(Context context, CharSequence text, <span class="type">int</span> duration).show();</span><br><span class="line"></span><br><span class="line"><span class="comment">// context：一个 Context 对象，通常传入当前的 Activity 或 Application。</span></span><br><span class="line"><span class="comment">// text：要显示的文本内容，可以是字符串或者字符串资源。</span></span><br><span class="line"><span class="comment">// duration：显示的时间，可以选择两种常用的持续时间：</span></span><br><span class="line">	<span class="comment">// Toast.LENGTH_SHORT：短暂显示，通常显示 2 秒钟左右。</span></span><br><span class="line">	<span class="comment">// Toast.LENGTH_LONG：长时间显示，通常显示 3.5 秒钟左右。</span></span><br></pre></td></tr></table></figure>

<p>使用示例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Toast.makeText(<span class="built_in">this</span>, <span class="string">&quot;Hello, World!&quot;</span>, Toast.LENGTH_SHORT).show();</span><br></pre></td></tr></table></figure>

<h1 id="Pair"><a href="#Pair" class="headerlink" title="Pair"></a>Pair</h1><p><code>android.util.Pair</code> 是 Android 提供的一个简单的数据结构类，用于存储两个相关联的对象。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pair</span>&lt;F, S&gt; &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> F first;  <span class="comment">// 第一个对象</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> S second; <span class="comment">// 第二个对象</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Pair</span><span class="params">(F first, S second)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.first = first;</span><br><span class="line">        <span class="built_in">this</span>.second = second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><code>first</code></strong>: 存储第一个对象。</li>
<li><strong><code>second</code></strong>: 存储第二个对象。</li>
</ul>
<p>这两个字段都是 <code>final</code>，一旦赋值后就无法修改。</p>
<h1 id="SharedPreferences"><a href="#SharedPreferences" class="headerlink" title="SharedPreferences"></a>SharedPreferences</h1><p><code>android.content.SharedPreferences</code>是 Android 中用于存储应用程序的偏好设置和简单数据（如配置选项、用户设置、应用状态等）的一个接口。它提供了一种轻量级的键值对存储方式，适用于存储简单的原始数据类型（如 <code>int</code>、<code>boolean</code>、<code>String</code> 等）。</p>
<h2 id="getString"><a href="#getString" class="headerlink" title="getString()"></a>getString()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">String <span class="title function_">getString</span><span class="params">(String key, String defValue)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// key：想要获取的值的键（String 类型）。这个 key 用于标识存储的 String 数据。</span></span><br><span class="line"><span class="comment">// defValue：当 key 对应的值不存在时，返回的默认值（String 类型）。这是一个可以自定义的备用值。</span></span><br><span class="line"><span class="comment">// return：如果 key 存在于 SharedPreferences 中，返回与该 key 相关联的 String 值；如果不存在，返回提供的 defValue。</span></span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/default-index/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/default-index/">1</a><a class="page-number" href="/default-index/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/default-index/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/default-index/page/7/">7</a><a class="extend next" rel="next" href="/default-index/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Bileton"
      src="/images/android.svg">
  <p class="site-author-name" itemprop="name">Bileton</p>
  <div class="site-description" itemprop="description">路漫漫其修远夕！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">29</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">63</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Bileton</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">510k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">7:44</span>
</div>


<span id="timeDate">载入天数...</span>
<span id="times">载入时分秒...</span>
<script>
    var now = new Date();
    function createtime() {
        var grt= new Date("01/01/2024 00:00:00"); //修改为你的网站开始运行的时间
        now.setTime(now.getTime()+250);
        days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
        hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
        if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
        mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
        seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
        snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
        document.getElementById("timeDate").innerHTML = "本站已安全运行 "+dnum+" 天 ";
        document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒.";
    }
setInterval("createtime()",250);
</script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
